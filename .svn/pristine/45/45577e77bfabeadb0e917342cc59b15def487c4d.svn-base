#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\MATR111.CH"
#line 2 "d:\totvs 11\microsiga\protheus\my projects\materiais\matr111.prx"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Dialog.ch"
#line 28 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Font.ch"
#line 29 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\PTMenu.ch"
#line 31 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Print.ch"
#line 33 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Colors.ch"
#line 35 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Folder.ch"
#line 37 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\msobject.ch"
#line 38 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\VKey.ch"
#line 42 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\WinApi.ch"
#line 44 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\FWCommand.ch"
#line 47 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\FWCSS.CH"
#line 50 "PROTHEUS.CH"
#line 18 "d:\totvs 11\microsiga\protheus\my projects\materiais\matr111.prx"
Function Matr111( cAlias, nReg, nOpcx )

If FindFunction("TRepInUse") .And.  TRepInUse()



    MATR110( cAlias, nReg, nOpcx )
Else
	MATR111R3( cAlias, nReg, nOpcx )
EndIf

Return




















Function MATR111R3(cAlias,nReg,nOpcx)

LOCAL wnrel		:= "MATR111"
LOCAL cDesc1	:= If( cPaisLoc $ "ANG|PTG", "Emissão dos pedidos de compras ou autorizações de entrega", "Emissao dos pedidos de compras ou autorizacoes de entrega" )
LOCAL cDesc2	:= If( cPaisLoc $ "ANG|PTG", "Registados e que ainda não foram impressos", "cadastrados e que ainda nao foram impressos" )
LOCAL cDesc3	:= " "
LOCAL cString	:= "SC7"

PRIVATE lAuto		:= (nReg<>Nil)
PRIVATE Tamanho		:= "G"
PRIVATE titulo	 	:=If( cPaisLoc $ "ANG|PTG", "Emissão Dos Pedidos De Compras Ou Autorizações De Entrega", "Emissao dos Pedidos de Compras ou Autorizacoes de Entrega" )
PRIVATE aReturn 	:= {If( cPaisLoc $ "ANG|PTG", "Código de barras", "Zebrado" ), 1,If( cPaisLoc $ "ANG|PTG", "Administração", "Administracao" ), 1, 2, 1, "",0 }
PRIVATE nomeprog	:="MATR111"
PRIVATE nLastKey	:= 0
PRIVATE nBegin		:= 0
PRIVATE nDifColCC   := 0
PRIVATE aLinha		:= {}
PRIVATE aSenhas		:= {}
PRIVATE aUsuarios	:= {}
PRIVATE M_PAG	:= 1
PRIVATE cObs01 := " ", cObs02 := " ", cObs03 := " ",  cObs04 := " ", cObs05 := " ",	cObs06 := " "
If Type("lPedido") <> "L"
	lPedido := .F. 
Endif



















AjustaSX1()
Pergunte("MTR111", .F. )







dbSelectArea("SX3")
dbSetOrder(2)
If dbSeek("C7_CC")
   If SX3->X3_TAMANHO == 9
      nDifColCC := 11
      Tamanho   := "M"
   Endif
Endif

wnrel:=SetPrint(cString,wnrel,If(lAuto,Nil,"MTR111"),@Titulo,cDesc1,cDesc2,cDesc3, .F. ,,,Tamanho,,!lAuto)

If nLastKey == 27
	dbClearFilter()
	Return
Endif

SetDefault(aReturn,cString)

If nLastKey == 27
	dbClearFilter()
	Return
Endif

If lAuto
	mv_par08 := SC7->C7_TIPO
EndIf

If lPedido
	mv_par12 := SC7->C7_MOEDA
Endif

If mv_par08 == 1 .OR.  mv_par08 == 3
	RptStatus({|lEnd| C111PC(@lEnd,wnRel,cString,nReg)},titulo)
Else
	RptStatus({|lEnd| C111AE(@lEnd,wnRel,cString,nReg)},titulo)
EndIf

lPedido := .F. 

Return .T. 














Static Function C111PC(lEnd,WnRel,cString,nReg)
Local nReem
Local nOrder
Local cCondBus
Local nSavRec
Local aSavRec := {}
Local nLinObs := 0
Local ncw := 0
Local i := 0

Private cCGCPict, cCepPict



cCepPict:=PesqPict("SA2","A2_CEP")
cCGCPict:=PesqPict("SA2","A2_CGC")

If nDifColCC >0
   limite   := 130
Else
   limite   := 141
Endif

li       := 80
nDescProd:= 0
nTotal   := 0
nTotMerc := 0
NumPed   := Space(6)

If lAuto
	dbSelectArea("SC7")
	dbGoto(nReg)
	SetRegua(1)
	mv_par01 := C7_NUM
	mv_par02 := C7_NUM
	mv_par03 := C7_EMISSAO
	mv_par04 := C7_EMISSAO
	mv_par05 := 2
	mv_par08 := C7_TIPO
	mv_par09 := 1
	mv_par10 := 3
	mv_par11 := 3
EndIf

If ( cPaisLoc$"ARG|POR|EUA" )
	cCondBus	:=	"1"+strzero(val(mv_par01),6)
	nOrder	:=	10
	nTipo		:= 1
Else
	cCondBus	:=mv_par01
	nOrder	:=	1
EndIf

dbSelectArea("SC7")
dbSetOrder(nOrder)
SetRegua(RecCount())
dbSeek(xFilial("SC7")+cCondBus, .T. )




PrintOut(0,0,AvalImp(Iif(nDifColCC>0,132,220)),,)


While !Eof() .And.  C7_FILIAL = xFilial("SC7") .And.  C7_NUM >= mv_par01 .And.  C7_NUM <= mv_par02




	nOrdem   := 1
	nReem    := 0

	If C7_EMITIDO == "S" .And.  mv_par05 == 1
		dbSkip()
		Loop
	Endif

	If (C7_CONAPRO == "B" .And.  mv_par10 == 1) .Or.  (C7_CONAPRO <> "B" .And.  mv_par10 == 2)
		dbSkip()
		Loop
	Endif
	If (C7_EMISSAO < mv_par03) .Or.  (C7_EMISSAO > mv_par04)
		dbSkip()
		Loop
	Endif
	If C7_TIPO == 2
		dbSkip()
		Loop
	EndIf




	If !MtrAValOP(mv_par11, "SC7")
		dbSkip()
		Loop
	EndIf

	If mv_par15 == 2 .And.  IIf(C7_MOEDA <> 0, C7_MOEDA <> Val(Str(mv_par12, 1)), .F. )
		dbSkip()
		Loop
	EndIf

	MaFisEnd()
	R111FIniPC(SC7->C7_NUM)

	For ncw := 1 To mv_par09

		ImpCabec(ncw)

		nTotal   := 0
		nTotMerc	:= 0
		nDescProd:= 0
		nReem    := SC7->C7_QTDREEM + 1
		nSavRec  := SC7->(Recno())
		NumPed   := SC7->C7_NUM
        nLinObs  := 0
        cObs01	 := " "
        cObs02	 := " "
        cObs03	 := " "
        cObs04	 := " "
        cObs05	 := " "
        cObs06	 := " "

		While !Eof() .And.  C7_FILIAL = xFilial("SC7") .And.  C7_NUM == NumPed

			If Ascan(aSavRec,Recno()) == 0
				AADD(aSavRec,Recno())
			Endif
			If lEnd
				PrintOut(_PROW()+1,001,If(cPaisLoc$"ANG|PTG","Cancelado Pelo Operador","CANCELADO PELO OPERADOR"),,)
				dbGoBottom()
				Exit
			Endif

			IncRegua()




			If li > 56
				nOrdem++
				ImpRodape()
				ImpCabec(ncw)
			Endif

			li++

			PrintOut(li,001,"|",,)
			PrintOut(li,002,C7_ITEM,PesqPict("SC7","c7_item"),)
			PrintOut(li,006,"|",,)
			PrintOut(li,007,C7_PRODUTO,PesqPict("SC7","c7_produto"),)



			ImpProd()

			If SC7->C7_DESC1 <> 0 .or.  SC7->C7_DESC2 <> 0 .or.  SC7->C7_DESC3 <> 0
				nDescProd+= CalcDesc(SC7->C7_TOTAL,SC7->C7_DESC1,SC7->C7_DESC2,SC7->C7_DESC3)
			Else
				nDescProd+=SC7->C7_VLDESC
			Endif



			If !EMPTY(SC7->C7_OBS) .And.  nLinObs < 7
                nLinObs++
				cVar:="cObs"+StrZero(nLinObs,2)
				Eval(MemVarBlock(cVar),SC7->C7_OBS)
			Endif

			dbSkip()
		EndDo

		dbGoto(nSavRec)

		If li>38
			nOrdem++
			ImpRodape()
			ImpCabec(ncw)
		Endif

		FinalPed(nDescProd)

	Next

	MaFisEnd()

	If Len(aSavRec)>0
		For i:=1 to Len(aSavRec)
			dbGoto(aSavRec[i])
			RecLock("SC7", .F. )
			_FIELD->C7_QTDREEM := (C7_QTDREEM+1)
			_FIELD->C7_EMITIDO := "S"
			MsUnLock()
		Next
		dbGoto(aSavRec[Len(aSavRec)])
	Endif

	aSavRec := {}

	dbSkip()
EndDo

dbSelectArea("SC7")
dbClearFilter()
dbSetOrder(1)

dbSelectArea("SX3")
dbSetOrder(1)




If aReturn[5] == 1
	Set( 24, "" )
	dbCommitAll()
	ourspool(wnrel)
Endif

MS_FLUSH()

Return .T. 














Static Function C111AE(lEnd,WnRel,cString,nReg)
Local nReem
Local nSavRec
Local aSavRec := {}
Local nLinObs := 0
Local ncw := 0
Local i := 0

Private cCGCPict, cCepPict



cCepPict:=PesqPict("SA2","A2_CEP")
cCGCPict:=PesqPict("SA2","A2_CGC")

If nDifColCC >0
   limite   := 130
Else
   limite   := 141
Endif

li       := 80
nDescProd:= 0
nTotal   := 0
nTotMerc := 0
NumPed   := Space(6)

If !lAuto
	dbSelectArea("SC7")
	dbSetOrder(10)
	dbSeek(xFilial("SC7")+"2"+mv_par01, .T. )
Else
	dbSelectArea("SC7")
	dbGoto(nReg)
	mv_par01 := C7_NUM
	mv_par02 := C7_NUM
	mv_par03 := C7_EMISSAO
	mv_par04 := C7_EMISSAO
	mv_par05 := 2
	mv_par08 := C7_TIPO
	mv_par09 := 1
	mv_par10 := 3
	mv_par11 := 3
	dbSelectArea("SC7")
	dbSetOrder(10)
	dbSeek(xFilial("SC7")+"2"+mv_par01, .T. )
EndIf

SetRegua(Reccount())



PrintOut(0,0,AvalImp(Iif(nDifColCC>0,132,220)),,)
While !Eof() .And. C7_FILIAL = xFilial("SC7") .And.  C7_NUM >= mv_par01 .And.  C7_NUM <= mv_par02



	nOrdem   := 1
	nReem    := 0

	If C7_EMITIDO == "S" .And.  mv_par05 == 1
    	dbSelectArea("SC7")
		dbSkip()
		Loop
	Endif

	If (C7_CONAPRO == "B" .And.  mv_par10 == 1) .Or.  (C7_CONAPRO <> "B" .And.  mv_par10 == 2)
    	dbSelectArea("SC7")
		dbSkip()
		Loop
	Endif
	If (SC7->C7_EMISSAO < mv_par03) .Or.  (SC7->C7_EMISSAO > mv_par04)
    	dbSelectArea("SC7")
		dbSkip()
		Loop
	Endif
	If SC7->C7_TIPO <> 2
    	dbSelectArea("SC7")
		dbSkip()
		Loop
	EndIf




	If !MtrAValOP(mv_par11, "SC7")
    	dbSelectArea("SC7")
		dbSkip()
		Loop
	EndIf

	If mv_par15 == 2 .And.  IIf(C7_MOEDA <> 0, C7_MOEDA <> Val(Str(mv_par12, 1)), .F. )
		dbSkip()
		Loop
	EndIf

	MaFisEnd()
	R111FIniPC(SC7->C7_NUM)

	For ncw := 1 To mv_par09

		ImpCabec(ncw)

		nTotal   := 0
		nTotMerc	:= 0

		nDescProd:= 0
		nReem    := SC7->C7_QTDREEM + 1
		nSavRec  := SC7->(Recno())
		NumPed   := SC7->C7_NUM
        nLinObs := 0
        cObs01	 := " "
        cObs02	 := " "
        cObs03	 := " "
        cObs04	 := " "
        cObs05	 := " "
        cObs06	 := " "

		While !Eof() .And.  C7_FILIAL = xFilial("SC7") .And.  C7_NUM == NumPed

			If Ascan(aSavRec,Recno()) == 0
				AADD(aSavRec,Recno())
			Endif

			If lEnd
				PrintOut(_PROW()+1,001,If(cPaisLoc$"ANG|PTG","Cancelado Pelo Operador","CANCELADO PELO OPERADOR"),,)
				dbGoBottom()
				Exit
			Endif

			IncRegua()




			If li > 56
				nOrdem++
				ImpRodape()
				ImpCabec(ncw)
			Endif
			li++
			PrintOut(li,001,"|",,)
			PrintOut(li,002,SC7->C7_ITEM,PesqPict("SC7","C7_ITEM"),)
			PrintOut(li,006,"|",,)
			PrintOut(li,007,SC7->C7_PRODUTO,PesqPict("SC7","C7_PRODUTO"),)



			ImpProd()

			If SC7->C7_DESC1 <> 0 .or.  SC7->C7_DESC2 <> 0 .or.  SC7->C7_DESC3 <> 0
				nDescProd+= CalcDesc(SC7->C7_TOTAL,SC7->C7_DESC1,SC7->C7_DESC2,SC7->C7_DESC3)
			Else
			   nDescProd+=SC7->C7_VLDESC
			Endif



			If !EMPTY(SC7->C7_OBS) .And.  nLinObs < 7
                nLinObs++
				cVar:="cObs"+StrZero(nLinObs,2)
				Eval(MemVarBlock(cVar),SC7->C7_OBS)
			Endif

         	dbSelectArea("SC7")
			dbSkip()
		EndDo

		dbGoto(nSavRec)
		If li>38
			nOrdem++
			ImpRodape()
			ImpCabec(ncw)
		Endif

		FinalAE(nDescProd)
	Next

	MaFisEnd()

	If Len(aSavRec)>0
		dbGoto(aSavRec[Len(aSavRec)])
		For i:=1 to Len(aSavRec)
			dbGoto(aSavRec[i])
			RecLock("SC7", .F. )
			_FIELD->C7_EMITIDO := "S"
			_FIELD->C7_QTDREEM := (C7_QTDREEM+1)
			MsUnLock()
		Next
	Endif
	aSavRec := {}
    dbSelectArea("SC7")
	dbSkip()
End

dbSelectArea("SC7")
dbClearFilter()
dbSetOrder(1)

dbSelectArea("SX3")
dbSetOrder(1)




If aReturn[5] == 1
	Set( 24, "" )
	dbCommitAll()
	ourspool(wnrel)
Endif

MS_FLUSH()

Return .T. 
















Static Function ImpProd()

LOCAL nBegin := 0, cDescri := "", nLinha:=0, nTamDesc := 28, aColuna := Array(8)

If Empty(mv_par06)
	mv_par06 := "B1_DESC"
EndIf




If AllTrim(mv_par06) == "B1_DESC"
	dbSelectArea("SB1")
	dbSetOrder(1)
	dbSeek( xFilial()+SC7->C7_PRODUTO )
	cDescri := Alltrim(SB1->B1_DESC)
	dbSelectArea("SC7")
EndIf



If AllTrim(mv_par06) == "B5_CEME"
	dbSelectArea("SB5")
	dbSetOrder(1)
	If dbSeek( xFilial()+SC7->C7_PRODUTO )
		cDescri := Alltrim(B5_CEME)
	EndIf
	dbSelectArea("SC7")
EndIf

dbSelectArea("SC7")
If AllTrim(mv_par06) == "C7_DESCRI"
	cDescri := Alltrim(SC7->C7_DESCRI)
EndIf

If Empty(cDescri)
	dbSelectArea("SB1")
	dbSetOrder(1)
	MsSeek( xFilial()+SC7->C7_PRODUTO )
	cDescri := Alltrim(SB1->B1_DESC)
	dbSelectArea("SC7")
EndIf

dbSelectArea("SA5")
dbSetOrder(1)
If dbSeek(xFilial()+SC7->C7_FORNECE+SC7->C7_LOJA+SC7->C7_PRODUTO) .And.  !Empty(SA5->A5_CODPRF)
	cDescri := cDescri + " ("+Alltrim(A5_CODPRF)+")"
EndIf
dbSelectArea("SC7")
aColuna[1] :=  51
aColuna[2] :=  54
aColuna[3] :=  67
aColuna[4] :=  82
aColuna[5] :=  88
aColuna[6] := 105
aColuna[7] := 116
acoluna[8] := 144 - nDifColCC

nLinha:= MLCount(cDescri,nTamDesc)

PrintOut(li,022,"|",,)
PrintOut(li,023,MemoLine(cDescri,nTamDesc,1),,)

ImpCampos()
For nBegin := 2 To nLinha
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,006,"|",,)
	PrintOut(li,022,"|",,)
	PrintOut(li,023,Memoline(cDescri,nTamDesc,nBegin),,)
	PrintOut(li,aColuna[1],"|",,)
	PrintOut(li,acoluna[2],"|",,)
	PrintOut(li,acoluna[3],"|",,)
    PrintOut(li,aColuna[4],"|",,)

	If mv_par08 == 1 .OR.  mv_par08 == 3
	   	PrintOut(li,aColuna[5]," ",,)
		PrintOut(li,aColuna[6],"|",,)
		PrintOut(li,116,"|",,)
		PrintOut(li,137-nDIfColCC,"|",,)
		PrintOut(li,aColuna[8],"|",,)
	Else
		PrintOut(li,099,"|",,)
		PrintOut(li,110,"|",,)
		PrintOut(li,144-nDifColCC,"|",,)
	EndIf
next

Return NIL















Static Function ImpCampos()

LOCAL aColuna[6]
Local nTxMoeda := IIF(SC7->C7_TXMOEDA > 0,SC7->C7_TXMOEDA,Nil)
dbSelectArea("SC7")

	aColuna[1] :=  51
	aColuna[2] :=  54
	aColuna[3] :=  67
	aColuna[4] :=  82
	aColuna[5] :=  88
	aColuna[6] := 105

PrintOut(li,aColuna[1],"|",,)
If MV_PAR07 == 2 .And.  !Empty(SC7->C7_SEGUM)
   PrintOut(li,_PCOL(),SC7->C7_SEGUM,PesqPict("SC7","C7_UM"),)
Else
   PrintOut(li,_PCOL(),SC7->C7_UM,PesqPict("SC7","C7_UM"),)
EndIf
PrintOut(li,aColuna[2],"|",,)
If MV_PAR07 == 2 .And.  !Empty(SC7->C7_QTSEGUM)
   PrintOut(li,_PCOL(),SC7->C7_QTSEGUM,PesqPictQt("C7_QUANT",13),)
Else
   PrintOut(li,_PCOL(),SC7->C7_QUANT,PesqPictQt("C7_QUANT",13),)
EndIf
PrintOut(li,aColuna[3],"|",,)
If MV_PAR07 == 2 .And.  !Empty(SC7->C7_QTSEGUM)
	PrintOut(li,_PCOL(),xMoeda((SC7->C7_TOTAL/SC7->C7_QTSEGUM),SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),PesqPict("SC7","C7_PRECO",14),)
Else
	PrintOut(li,_PCOL(),xMoeda(SC7->C7_PRECO,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),PesqPict("SC7","C7_PRECO",14),)
EndIf
PrintOut(li,aColuna[4],"|",,)

If mv_par08 == 1 .OR.  mv_par08 == 3
	PrintOut(li,_PCOL(),"  ",,)
	PrintOut(li,aColuna[5]-2," ",,)
	PrintOut(li,_PCOL()," ",,)
	PrintOut(li,_PCOL(),xMoeda(SC7->C7_TOTAL,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),PesqPict("SC7","C7_TOTAL",16,MV_PAR12),)
	PrintOut(li,aColuna[6],"|",,)
	PrintOut(li,_PCOL(),SC7->C7_DATPRF,PesqPict("SC7","C7_DATPRF"),)
	PrintOut(li,116,"|",,)
	PrintOut(li,_PCOL(),SC7->C7_CC,PesqPict("SC7","C7_CC",20),)
	PrintOut(li,137-nDifColCC,"|",,)
	PrintOut(li,_PCOL(),SC7->C7_NUMSC,,)
	PrintOut(li,144-nDifColCC,"|",,)
Else
	PrintOut(li,_PCOL(),xMoeda(SC7->C7_TOTAL,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),PesqPict("SC7","C7_TOTAL",16,MV_PAR12),)
	PrintOut(li,098,"|",,)
	PrintOut(li,_PCOL(),SC7->C7_DATPRF,PesqPict("SC7","C7_DATPRF"),)
	PrintOut(li,109,"|",,)
	PrintOut(li,_PCOL(),SC7->C7_OP,,)
	PrintOut(li,143-nDifColCC,"|",,)
EndIf

nTotal  :=nTotal+SC7->C7_TOTAL
nTotMerc:=MaFisRet(,"NF_TOTAL")
Return .T. 















Static Function FinalPed(nDescProd)

Local nk 		:= 1
Local nG        := 1
Local nZ        := 1
Local nQuebra	:= 0
Local nTotDesc	:= nDescProd
Local lNewAlc	:= .F. 
Local lLiber 	:= .F. 
Local lImpLeg	:= .T. 
Local cComprador:=""
LOcal cAlter	:=""
Local cAprov	:=""
Local nTotDesp	:= MaFisRet(,"NF_DESPESA")
Local nTotFrete	:= MaFisRet(,"NF_FRETE")
Local nTotalNF	:= MaFisRet(,"NF_TOTAL")
Local nTotSeguro:= MaFisRet(,"NF_SEGURO")
Local nValIVA   :=0
Local aColuna   := Array(8), nTotLinhas
Local nTxMoeda  := IIF(SC7->C7_TXMOEDA > 0,SC7->C7_TXMOEDA,Nil)
Local nX        :=1
Local aImpostos := MaFisRet(,"NF_VALIMP")
Local aImp      := {}
Local aImpGer   := {}

If !Empty(aImpostos)
	For nG:=1 to Len(aImpostos)
       nValIVA+=aImpostos[nG]
	Next

	aImp:=MafisRet(,"NF_IMPOSTOS")
	For nZ:=1  To Len (aImp)
		If aImp[nZ,1] <> "..."



		   	aadd(aImpGer,{aImp[nZ,1],aImp[nZ,4],aImp[nZ][5]})
		EndIf
	Next
Endif

cMensagem:= Formula(C7_MSG)

If !Empty(cMensagem)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,002,Padc(cMensagem,129),,)
	PrintOut(li,144-nDifColCC,"|",,)
Endif
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)
li++

aColuna[1] :=  51
aColuna[2] :=  54
aColuna[3] :=  67
aColuna[4] :=  82
aColuna[5] :=  88
aColuna[6] := 105
acoluna[7] := 116
aColuna[8] := 144 - nDifColCC
nTotLinhas :=  39

While li<nTotLinhas
	PrintOut(li,001,"|",,)
	PrintOut(li,006,"|",,)
	PrintOut(li,022,"|",,)
	PrintOut(li,022+nk,"*",,)
	nk := IIf( nk == 42 , 1 , nk + 1 )
	PrintOut(li,aColuna[1],"|",,)
	PrintOut(li,aColuna[2],"|",,)
	PrintOut(li,aColuna[3],"|",,)
	PrintOut(li,aColuna[4],"|",,)
	PrintOut(li,aColuna[6],"|",,)
	PrintOut(li,116,"|",,)
	PrintOut(li,137-nDifColCC,"|",,)
	PrintOut(li,aColuna[8],"|",,)
	li++
EndDo
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,015,If(cPaisLoc$"ANG|PTG","D e s c o n t o s -->","D E S C O N T O S -->"),,)
PrintOut(li,037,C7_DESC1,"999.99",)
PrintOut(li,046,C7_DESC2,"999.99",)
PrintOut(li,055,C7_DESC3,"999.99",)

PrintOut(li,068,xMoeda(nTotDesc,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),PesqPict("SC7","C7_VLDESC",14,MV_PAR12),)

PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)



cAlias := Alias()
dbSelectArea("SM0")
dbSetOrder(1)
nRegistro := Recno()
dbSeek(SUBS(cNumEmp,1,2)+SC7->C7_FILENT)




If Empty(MV_PAR13)
	PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Local de entrega  : ","Local de Entrega  : ")+SM0->M0_ENDENT,,)
	PrintOut(li,084,"-",,)
	PrintOut(li,086,SM0->M0_CIDENT,,)
	PrintOut(li,107,"-",,)
	PrintOut(li,109,SM0->M0_ESTENT,,)
	PrintOut(li,112,"-",,)
	PrintOut(li,114,If(cPaisLoc$"ANG|PTG","Código postal :","CEP :"),,)
	PrintOut(li,119,Trans(Alltrim(SM0->M0_CEPENT),cCepPict),,)
Else
	PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Local de entrega  : ","Local de Entrega  : ")+MV_PAR13,,)
Endif

PrintOut(li,144-nDifColCC,"|",,)
dbGoto(nRegistro)
dbSelectArea( cAlias )

li++
PrintOut(li,001,"|",,)
PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Local de cobrança : ","Local de Cobranca : ")+" "+SM0->M0_ENDCOB,,)
PrintOut(li,084,"-",,)
PrintOut(li,086,SM0->M0_CIDCOB,,)
PrintOut(li,107,"-",,)
PrintOut(li,109,SM0->M0_ESTCOB,,)
PrintOut(li,112,"-",,)
PrintOut(li,114,If(cPaisLoc$"ANG|PTG","Código postal :","CEP :"),,)
PrintOut(li,119,Trans(Alltrim(SM0->M0_CEPCOB),cCepPict),,)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)

dbSelectArea("SE4")
dbSetOrder(1)
dbSeek(xFilial()+SC7->C7_COND)
dbSelectArea("SC7")
li++
PrintOut(li,001,"|",,)
PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Condição de pagt ","Condicao de Pagto ")+SubStr(SE4->E4_COND,1,12),,)
PrintOut(li,034,If(cPaisLoc$"ANG|PTG","|data De Emissão","|Data de Emissao"),,)
PrintOut(li,065,"|",,)
PrintOut(li,067,If(cPaisLoc$"ANG|PTG","Total das mercadorias : ","Total das Mercadorias : "),,)
PrintOut(li,094,xMoeda(nTotal,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotal,14,MsDecimais(MV_PAR12)),)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,003,SubStr(SE4->E4_DESCRI,1,34),,)
PrintOut(li,034,"|",,)
PrintOut(li,036,SC7->C7_EMISSAO,,)
PrintOut(li,065,"|",,)
PrintOut(li,067,OemtoAnsi(If(cPaisLoc$"ANG|PTG","Total dos impostos:    ","Total dos Impostos:    ")),,)
PrintOut(li,094,xMoeda(nValIVA,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",63),,)
PrintOut(li,065,"|",,)
PrintOut(li,066,Replicate("-",77-nDifColCC),,)
PrintOut(li,144-nDifColCC,"|",,)
li++




If Empty(cObs02)
	If Len(cObs01) > 30
		cObs := cObs01
		cObs01 := Substr(cObs,1,30)
		For nX := 2 To 6
			cVar  := "cObs"+StrZero(nX,2)
			&cVar := Substr(cObs,(30*(nX-1))+1,30)
		Next
	EndIf
Else
	cObs01:= Substr(cObs01,1,IIf(Len(cObs01)<30,Len(cObs01),30))
	cObs02:= Substr(cObs02,1,IIf(Len(cObs02)<30,Len(cObs01),30))
	cObs03:= Substr(cObs03,1,IIf(Len(cObs03)<30,Len(cObs01),30))
	cObs04:= Substr(cObs04,1,IIf(Len(cObs04)<30,Len(cObs01),30))
	cObs05:= Substr(cObs05,1,IIf(Len(cObs05)<30,Len(cObs01),30))
	cObs06:= Substr(cObs06,1,IIf(Len(cObs06)<30,Len(cObs01),30))
EndIf

PrintOut(li,001,If(cPaisLoc$"ANG|PTG","| Observações:","| Observacoes:"),,)
If mv_par14 == 1
	PrintOut(li,065,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs01,,)
	PrintOut(li,065,(If(cPaisLoc$"ANG|PTG","| frete :","| Frete :")),,)
	PrintOut(li,075,xMoeda(nTotFrete,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotFrete,14,MsDecimais(MV_PAR12)),)
	PrintOut(li,099,(If(cPaisLoc$"ANG|PTG","| despesas :","| Despesas :")),,)
	PrintOut(li,111,xMoeda(nTotDesp,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotDesp,14,MsDecimais(MV_PAR12)),)
	PrintOut(li,144-nDifColCC,"|",,)

	dbSelectArea("SC7")
	If !Empty(C7_APROV)
		lNewAlc := .T. 
		cComprador := UsrFullName(SC7->C7_USER)
		If C7_CONAPRO <> "B"
			lLiber := .T. 
		EndIf
		dbSelectArea("SCR")
		dbSetOrder(1)
		dbSeek(xFilial()+"PC"+SC7->C7_NUM)
		While !Eof() .And.  SCR->CR_FILIAL+Alltrim(SCR->CR_NUM)==xFilial("SCR")+SC7->C7_NUM .And.  SCR->CR_TIPO == "PC"

		  cAprov += AllTrim(UsrFullName(SCR->CR_USER))+" ["+ IF(SCR->CR_STATUS=="03","Ok",IF(SCR->CR_STATUS=="04","BLQ","??"))+"] - "
		  dbSelectArea("SCR")
		  dbSkip()
		EndDo
		If !Empty(SC7->C7_GRUPCOM)
			dbSelectArea("SAJ")
			dbSetOrder(1)
			dbSeek(xFilial()+SC7->C7_GRUPCOM)
			While !Eof() .And.  SAJ->AJ_FILIAL+SAJ->AJ_GRCOM == xFilial("SAJ")+SC7->C7_GRUPCOM
				If SAJ->AJ_USER <> SC7->C7_USER
					cAlter += AllTrim(UsrFullName(SAJ->AJ_USER))+"/"
				EndIf
				dbSelectArea("SAJ")
				dbSkip()
			EndDo
		EndIf
	EndIf

	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs02,,)
	PrintOut(li,065,If(cPaisLoc$"ANG|PTG","| grupo :","| Grupo :"),,)
	PrintOut(li,099,If(cPaisLoc$"ANG|PTG","| seguro :","| SEGURO :"),,)
	PrintOut(li,111,xMoeda(nTotSeguro,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotSeguro,14,MsDecimais(MV_PAR12)),)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs03,,)
	PrintOut(li,065,"|"+Replicate("-",77-nDifColCC),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs04,,)
	PrintOut(li,065,If(cPaisLoc$"ANG|PTG","| total crial : ","| Total Geral : "),,)

	If !lNewAlc
		PrintOut(li,082,xMoeda(nTotalNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotalNF,14,MsDecimais(MV_PAR12)),)
	Else
		If lLiber
			PrintOut(li,082,xMoeda(nTotalNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotalNF,14,MsDecimais(MV_PAR12)),)
		Else
			PrintOut(li,091,(If(cPaisLoc$"ANG|PTG","     p e d i d o   b l o q u e a d o ","     P E D I D O   B L O Q U E A D O ")),,)
		EndIf
	EndIf

	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs05,,)
	PrintOut(li,065,"|"+Replicate("-",77-nDifColCC),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
Else
	PrintOut(li,034,"|",,)
	PrintOut(li,037,OemtoAnsi(If(cPaisLoc$"ANG|PTG","Imp.  Aliq.     Vlr.imposto","Imp.  Aliq.     Vlr.Imposto")),,)
	PrintOut(li,065,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs01,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   nX++
	EndIf
	PrintOut(li,065,(If(cPaisLoc$"ANG|PTG","| frete :","| Frete :")),,)
	PrintOut(li,075,xMoeda(nTotFrete,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotFrete,14,MsDecimais(MV_PAR12)),)
	PrintOut(li,099,(If(cPaisLoc$"ANG|PTG","| despesas :","| Despesas :")),,)
	PrintOut(li,111,xMoeda(nTotDesp,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotDesp,14,MsDecimais(MV_PAR12)),)

	PrintOut(li,144-nDifColCC,"|",,)

	dbSelectArea("SC7")
	If !Empty(C7_APROV)
		lNewAlc := .T. 
		cComprador := UsrFullName(SC7->C7_USER)
		If C7_CONAPRO <> "B"
			lLiber := .T. 
		EndIf
		dbSelectArea("SCR")
		dbSetOrder(1)
		dbSeek(xFilial()+"PC"+SC7->C7_NUM)
		While !Eof() .And.  SCR->CR_FILIAL+Alltrim(SCR->CR_NUM)==xFilial("SCR")+SC7->C7_NUM .And.  SCR->CR_TIPO == "PC"

		  cAprov += AllTrim(UsrFullName(SCR->CR_USER))+" ["+ IF(SCR->CR_STATUS=="03","Ok",IF(SCR->CR_STATUS=="04","BLQ","??"))+"] - "
		  dbSelectArea("SCR")
		  dbSkip()
		Enddo
		If !Empty(SC7->C7_GRUPCOM)
			dbSelectArea("SAJ")
			dbSetOrder(1)
			dbSeek(xFilial()+SC7->C7_GRUPCOM)
			While !Eof() .And.  SAJ->AJ_FILIAL+SAJ->AJ_GRCOM == xFilial("SAJ")+SC7->C7_GRUPCOM
				If SAJ->AJ_USER <> SC7->C7_USER
					cAlter += AllTrim(UsrFullName(SAJ->AJ_USER))+"/"
				EndIf
				dbSelectArea("SAJ")
				dbSkip()
			EndDo
		EndIf
	EndIf

	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs02,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
		nX++
	EndIf

	PrintOut(li,065,If(cPaisLoc$"ANG|PTG","| grupo :","| Grupo :"),,)
	PrintOut(li,099,If(cPaisLoc$"ANG|PTG","| seguro :","| SEGURO :"),,)
	PrintOut(li,111,xMoeda(nTotSeguro,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotSeguro,14,MsDecimais(MV_PAR12)),)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs03,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   nX++
	EndIf
	PrintOut(li,065,"|"+Replicate("-",77-nDifColCC),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs04,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   nX++
	EndIf
	PrintOut(li,065,If(cPaisLoc$"ANG|PTG","| total crial : ","| Total Geral : "),,)

	If !lNewAlc
		PrintOut(li,082,xMoeda(nTotalNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotalNF,14,MsDecimais(MV_PAR12)),)
	Else
		If lLiber
			PrintOut(li,082,xMoeda(nTotalNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotalNF,14,MsDecimais(MV_PAR12)),)
		Else
			PrintOut(li,091,(If(cPaisLoc$"ANG|PTG","     p e d i d o   b l o q u e a d o ","     P E D I D O   B L O Q U E A D O ")),,)
		EndIf
	EndIf

	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs05,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   nX++
	EndIf
	PrintOut(li,065,"|"+Replicate("-",77-nDifColCC),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
EndIf


If !lNewAlc
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs06,,)
	If mv_par14 <> 1
		PrintOut(li,034,"|",,)
		If nX <= Len(aImpGer)
			PrintOut(li,037,aImpGer[nX,1],,)
			PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
			PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   		nX++
	   	EndIf
	EndIf
   	PrintOut(li,065,"|",,)
	PrintOut(li,075,If(cPaisLoc$"ANG|PTG","Autorização Do Pedido","Liberacao do Pedido"),,)
	PrintOut(li,102,"|",,)
	PrintOut(li,104,If(cPaisLoc$"ANG|PTG","Obs. do frete: ","Obs. do Frete: "),,)
	PrintOut(li,119,IF(SC7->C7_TPFRETE$"F","FOB",IF(SC7->C7_TPFRETE$"C","CIF"," ")),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|"+Replicate("-",63),,)
	PrintOut(li,065,"|",,)
	PrintOut(li,102,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)

	li++
	cLiberador := ""
	nPosicao := 0
	PrintOut(li,001,"|",,)
	PrintOut(li,003,"Comprador",,)
	PrintOut(li,017,"|",,)
	PrintOut(li,022,If(cPaisLoc$"ANG|PTG","Gerência","Gerencia"),,)
	PrintOut(li,034,"|",,)
	PrintOut(li,046,If(cPaisLoc$"ANG|PTG","Directoria","Diretoria"),,)
	PrintOut(li,065,"|       --------------------------",,)
	PrintOut(li,102,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,017,"|",,)
	PrintOut(li,034,"|",,)
	PrintOut(li,065,"|     "+R111Center(cLiberador),,)
	PrintOut(li,102,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,002,Replicate("-",limite),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,If(cPaisLoc$"ANG|PTG","|   Factura: Só Aceitaremos A Mercadoria Se Na Sua Factura Constar O Número Do Nosso Pedido De Compras.","|   NOTA: So aceitaremos a mercadoria se na sua Nota Fiscal constar o numero do nosso Pedido de Compras."),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,002,Replicate("-",limite),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001," ",,)
Else
	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs06,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   nX++
	EndIf
   	PrintOut(li,065,"|",,)
	PrintOut(li,067,IF(lLiber,If(cPaisLoc$"ANG|PTG","      P E D I D O   A P R O V A D O","      P E D I D O   L I B E R A D O"),If(cPaisLoc$"ANG|PTG","     p e d i d o   b l o q u e a d o ","     P E D I D O   B L O Q U E A D O ")),,)
   	PrintOut(li,102,"|",,)
	PrintOut(li,113,If(cPaisLoc$"ANG|PTG","Obs. do frete: ","Obs. do Frete: "),,)
	PrintOut(li,130,IF(SC7->C7_TPFRETE$"F","FOB",IF(SC7->C7_TPFRETE$"C","CIF"," ")),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|"+Replicate("-",99),,)
	PrintOut(li,102,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Comprador responsável :","Comprador Responsavel :"),,)
	PrintOut(li,027,Substr(cComprador,1,60),,)
	PrintOut(li,088,"|",,)
	PrintOut(li,089,If(cPaisLoc$"ANG|PTG","Blq:bloqueado","BLQ:Bloqueado"),,)
	PrintOut(li,102,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	nAuxLin := Len(cAlter)
	PrintOut(li,001,"|",,)
	PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Compradores alternativos :","Compradores Alternativos :"),,)
	While nAuxLin > 0 .oR.  lImpLeg
		PrintOut(li,029,Substr(cAlter,Len(cAlter)-nAuxLin+1,60),,)
		PrintOut(li,088,"|",,)
		If lImpLeg
			PrintOut(li,089,If(cPaisLoc$"ANG|PTG","Ok:autorizado","Ok:Liberado"),,)
			lImpLeg := .F. 
		EndIf
		PrintOut(li,102,"|",,)
		PrintOut(li,144-nDifColCC,"|",,)
		nAuxLin -= 60
		li++
	EndDo
	nAuxLin := Len(cAprov)
	lImpLeg := .T. 
	PrintOut(li,001,"|",,)
	PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Quem autoriza :","Aprovador(es) :"),,)
	While nAuxLin > 0 .Or.  lImpLeg
		PrintOut(li,019,Substr(cAprov,Len(cAprov)-nAuxLin+1,70),,)
		PrintOut(li,088,"|",,)
		If lImpLeg
			PrintOut(li,089,If(cPaisLoc$"ANG|PTG","??:aguar.aprov","??:Aguar.Lib"),,)
			lImpLeg := .F. 
		EndIf
		PrintOut(li,102,"|",,)
		PrintOut(li,144-nDifColCC,"|",,)
		nAUxLin -=70
		li++
	EndDo
	If nAuxLin == 0
		li++
	EndIf
	PrintOut(li,001,"|",,)
	PrintOut(li,002,Replicate("-",limite),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,If(cPaisLoc$"ANG|PTG","|   Factura: Só Aceitaremos A Mercadoria Se Na Sua Factura Constar O Número Do Nosso Pedido De Compras.","|   NOTA: So aceitaremos a mercadoria se na sua Nota Fiscal constar o numero do nosso Pedido de Compras."),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,002,Replicate("-",limite),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
	PrintOut(li,001," ",,)
EndIf

Return .T. 















Static Function FinalAE(nDescProd)
Local nk		:= 1
Local nG        := 1
Local nZ        := 1
Local nTotDesc	:= nDescProd
Local nTotNF	:= MaFisRet(,"NF_TOTAL")
Local nTxMoeda	:= IIF(SC7->C7_TXMOEDA > 0,SC7->C7_TXMOEDA,Nil)
Local nX        :=1
Local aImpostos := MaFisRet(,"NF_VALIMP")
Local aImp      := {}
Local aImpGer   := {}
Local nValIVA   :=0

If !Empty(aImpostos)
	For nG:=1 to Len(aImpostos)
       nValIVA+=aImpostos[nG]
	Next

	aImp:=MafisRet(,"NF_IMPOSTOS")
	For nZ:=1  To Len (aImp)
		If aImp[nZ,1] <> "..."



		   	aadd(aImpGer,{aImp[nZ,1],aImp[nZ,4],aImp[nZ][5]})
		EndIf
	Next
Endif
cMensagem:= Formula(C7_MSG)

If !Empty(cMensagem)
	li++
	PrintOut(li,001,"|",,)
	PrintOut(li,002,Padc(cMensagem,129),,)
	PrintOut(li,144-nDifColCC,"|",,)
Endif
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)
li++
While li<39
	PrintOut(li,001,"|",,)
	PrintOut(li,006,"|",,)
	PrintOut(li,022,"|",,)
	PrintOut(li,022+nk,"*",,)
	nk := IIf( nk == 32 , 1 , nk + 1 )
	PrintOut(li,051,"|",,)
	PrintOut(li,054,"|",,)
	PrintOut(li,067,"|",,)
	PrintOut(li,082,"|",,)
	PrintOut(li,099,"|",,)
	PrintOut(li,110,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
EndDo
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)




cAlias := Alias()
dbSelectArea("SM0")
dbSetOrder(1)
nRegistro := Recno()
dbSeek(SUBS(cNumEmp,1,2)+SC7->C7_FILENT)



If Empty(MV_PAR13)
	PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Local de entrega  : ","Local de Entrega  : ")+SM0->M0_ENDENT,,)
	PrintOut(li,084,"-",,)
	PrintOut(li,086,SM0->M0_CIDENT,,)
	PrintOut(li,107,"-",,)
	PrintOut(li,109,SM0->M0_ESTENT,,)
	PrintOut(li,112,"-",,)
	PrintOut(li,114,If(cPaisLoc$"ANG|PTG","Código postal :","CEP :"),,)
	PrintOut(li,119,Trans(Alltrim(SM0->M0_CEPENT),cCepPict),,)
Else
	PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Local de entrega  : ","Local de Entrega  : ")+MV_PAR13,,)
Endif

PrintOut(li,144-nDifColCC,"|",,)
dbGoto(nRegistro)
dbSelectArea(cAlias)

li++
PrintOut(li,001,"|",,)
PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Local de cobrança : ","Local de Cobranca : ")+" "+SM0->M0_ENDCOB,,)
PrintOut(li,084,"-",,)
PrintOut(li,086,SM0->M0_CIDCOB,,)
PrintOut(li,107,"-",,)
PrintOut(li,109,SM0->M0_ESTCOB,,)
PrintOut(li,112,"-",,)
PrintOut(li,114,If(cPaisLoc$"ANG|PTG","Código postal :","CEP :"),,)
PrintOut(li,119,Trans(Alltrim(SM0->M0_CEPCOB),cCepPict),,)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)

dbSelectArea("SE4")
dbSetOrder(1)
dbSeek(xFilial()+SC7->C7_COND)
dbSelectArea("SC7")
li++
PrintOut(li,001,"|",,)
PrintOut(li,003,If(cPaisLoc$"ANG|PTG","Condição de pagt ","Condicao de Pagto ")+SubStr(SE4->E4_COND,1,12),,)
PrintOut(li,034,If(cPaisLoc$"ANG|PTG","|data De Emissão","|Data de Emissao"),,)
PrintOut(li,065,"|",,)
PrintOut(li,067,If(cPaisLoc$"ANG|PTG","Total das mercadorias : ","Total das Mercadorias : "),,)
PrintOut(li,094,xMoeda(nTotal,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotal,14,MsDecimais(MV_PAR12)),)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,003,SubStr(SE4->E4_DESCRI,1,34),,)
PrintOut(li,034,"|",,)
PrintOut(li,036,SC7->C7_EMISSAO,,)
PrintOut(li,065,"|",,)
PrintOut(li,067,If(cPaisLoc$"ANG|PTG","Total com impostos:    ","Total com Impostos:    "),,)
PrintOut(li,094,xMoeda(nTotMerc,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotMerc,14,MsDecimais(MV_PAR12)),)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",63),,)
PrintOut(li,065,"|",,)
PrintOut(li,066,Replicate("-",77-nDifColCC),,)
PrintOut(li,144-nDifColCC,"|",,)
li++




If Empty(cObs02)
	If Len(cObs01) > 30
		cObs := cObs01
		cObs01 := Substr(cObs,1,30)
		For nX := 2 To 6
			cVar  := "cObs"+StrZero(nX,2)
			&cVar := Substr(cObs,(30*(nX-1))+1,30)
		Next
	EndIf
Else
	cObs01:= Substr(cObs01,1,IIf(Len(cObs01)<30,Len(cObs01),30))
	cObs02:= Substr(cObs02,1,IIf(Len(cObs02)<30,Len(cObs01),30))
	cObs03:= Substr(cObs03,1,IIf(Len(cObs03)<30,Len(cObs01),30))
	cObs04:= Substr(cObs04,1,IIf(Len(cObs04)<30,Len(cObs01),30))
	cObs05:= Substr(cObs05,1,IIf(Len(cObs05)<30,Len(cObs01),30))
	cObs06:= Substr(cObs06,1,IIf(Len(cObs06)<30,Len(cObs01),30))
EndIf

PrintOut(li,001,If(cPaisLoc$"ANG|PTG","| Observações:","| Observacoes:"),,)
If mv_par14 == 1
	PrintOut(li,065,If(cPaisLoc$"ANG|PTG","| total crial : ","| Total Geral : "),,)
    PrintOut(li,094,xMoeda(nTotNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotNF,14,MsDecimais(MV_PAR12)),)
    PrintOut(li,144-nDifColCC,"|",,)
    li++
   	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs01,,)
	PrintOut(li,065,"|",,)
	PrintOut(li,066,Replicate("-",77-nDifColCC),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

   	PrintOut(li,001,"|",,)
   	PrintOut(li,003,cObs02,,)
	PrintOut(li,065,If(cPaisLoc$"ANG|PTG","| comprador    ","| Comprador    "),,)
	PrintOut(li,082,If(cPaisLoc$"ANG|PTG","| gerência     ","| Gerencia     "),,)
	PrintOut(li,097,If(cPaisLoc$"ANG|PTG","| directoria    ","| Diretoria    "),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs03,,)
	PrintOut(li,065,"|",,)
	PrintOut(li,082,"|",,)
	PrintOut(li,097,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs04,,)
	PrintOut(li,065,"|",,)
	PrintOut(li,082,"|",,)
	PrintOut(li,097,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs05,,)
	PrintOut(li,065,"|",,)
	PrintOut(li,082,"|",,)
	PrintOut(li,097,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs06,,)
	PrintOut(li,065,"|",,)
	PrintOut(li,082,"|",,)
	PrintOut(li,097,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,002,Replicate("-",limite),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
Else
	PrintOut(li,034,"|",,)
	PrintOut(li,037,OemtoAnsi(If(cPaisLoc$"ANG|PTG","Imp.  Aliq.     Vlr.imposto","Imp.  Aliq.     Vlr.Imposto")),,)
	PrintOut(li,065,If(cPaisLoc$"ANG|PTG","| total crial : ","| Total Geral : "),,)
    PrintOut(li,094,xMoeda(nTotNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nTotNF,14,MsDecimais(MV_PAR12)),)
    PrintOut(li,144-nDifColCC,"|",,)
    li++
   	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs01,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   nX++
	EndIf
	PrintOut(li,065,"|",,)
	PrintOut(li,066,Replicate("-",77-nDifColCC),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

   	PrintOut(li,001,"|",,)
   	PrintOut(li,003,cObs02,,)
   	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
		nX++
	EndIf
	PrintOut(li,065,If(cPaisLoc$"ANG|PTG","| comprador    ","| Comprador    "),,)
	PrintOut(li,082,If(cPaisLoc$"ANG|PTG","| gerência     ","| Gerencia     "),,)
	PrintOut(li,097,If(cPaisLoc$"ANG|PTG","| directoria    ","| Diretoria    "),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs03,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   nX++
	EndIf
	PrintOut(li,065,"|",,)
	PrintOut(li,082,"|",,)
	PrintOut(li,097,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs04,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   nX++
	EndIf
	PrintOut(li,065,"|",,)
	PrintOut(li,082,"|",,)
	PrintOut(li,097,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs05,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
	   nX++
	EndIf
	PrintOut(li,065,"|",,)
	PrintOut(li,082,"|",,)
	PrintOut(li,097,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,003,cObs06,,)
	PrintOut(li,034,"|",,)
	If nX <= Len(aImpGer)
		PrintOut(li,037,aImpGer[nX,1],,)
		PrintOut(li,043,aImpGer[nX,2],tm(aImpGer[nX,2],5,2),)
		PrintOut(li,050,xMoeda(aImpGer[nX,3],SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda),tm(nValIVA,14,MsDecimais(MV_PAR12)),)
		nX++
	EndIf
	PrintOut(li,065,"|",,)
	PrintOut(li,082,"|",,)
	PrintOut(li,097,"|",,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++

	PrintOut(li,001,"|",,)
	PrintOut(li,002,Replicate("-",limite),,)
	PrintOut(li,144-nDifColCC,"|",,)
	li++
EndIf
PrintOut(li,001,If(cPaisLoc$"ANG|PTG","|   Factura: Só Aceitaremos A Mercadoria Se Na Sua Factura Constar O Número Da Autorização De Entrega.","|   NOTA: So aceitaremos a mercadoria se na sua Nota Fiscal constar o numero da Autorizacao de Entrega."),,)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)
li++

PrintOut(li,001," ",,)
Return .T. 

















Static Function ImpRodape()
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,070,"Continua ...",,)
PrintOut(li,144-nDifColCC,"|",,)
li++
PrintOut(li,001,"|",,)
PrintOut(li,002,Replicate("-",limite),,)
PrintOut(li,144-nDifColCC,"|",,)
li:=0
Return .T. 















Static Function ImpCabec(ncw)
Local nOrden, cCGC
LOCAL cMoeda

cMoeda := Iif(mv_par12<10,Str(mv_par12,1),Str(mv_par12,2))

PrintOut(01,001,"|",,)
PrintOut(01,002,Replicate("-",limite),,)
PrintOut(01,144-nDifColCC,"|",,)
PrintOut(02,001,"|",,)
PrintOut(02,029,IIf(nOrdem>1,(If(cPaisLoc$"ANG|PTG"," - continuação"," - continuacao"))," "),,)

If mv_par08 == 1 .OR.  mv_par08 == 3
	PrintOut(02,045,("| P E D I D O  D E  C O M P R A S")+" - "+GetMV("MV_MOEDA"+cMoeda),,)
Else
	PrintOut(02,045,(If(cPaisLoc$"ANG|PTG","| a u t.   d e   e n t r e g a   ","| A U T.   D E   E N T R E G A   "))+" - "+GetMV("MV_MOEDA"+cMoeda),,)
EndIf

If ( Mv_PAR08==2 )
	PrintOut(02,090,"|",,)
	PrintOut(02,093,SC7->C7_NUMSC+"/"+SC7->C7_NUM,,)
Else
	PrintOut(02,096,"|",,)
	PrintOut(02,101,SC7->C7_NUM,PesqPict("SC7","c7_num"),)
EndIf

PrintOut(02,107,"/"+Str(nOrdem,1),,)
PrintOut(02,112,IIf(SC7->C7_QTDREEM>0,Str(SC7->C7_QTDREEM+1,2)+If(cPaisLoc$"ANG|PTG","A.emissão ","a.Emissao ")+Str(ncw,2)+If(cPaisLoc$"ANG|PTG","A.via","a.VIA")," "),,)
PrintOut(02,144-nDifColCC,"|",,)
PrintOut(03,001,"|",,)
PrintOut(03,003,SM0->M0_NOMECOM,,)
PrintOut(03,045,"|"+Replicate("-",97-nDifColCC),,)
PrintOut(03,144-nDifColCC,"|",,)
PrintOut(04,001,"|",,)
PrintOut(04,003,Substr(SM0->M0_ENDENT,1,42),,)
dbSelectArea("SA2")
dbSetOrder(1)
dbSeek(xFilial()+SC7->C7_FORNECE+SC7->C7_LOJA)
PrintOut(04,045,"|",,)
If ( cPaisLoc$"ARG|POR|EUA" )
	PrintOut(04,047,Substr(SA2->A2_NOME,1,35)+"-"+SA2->A2_COD+"-"+SA2->A2_LOJA,,)
Else
	PrintOut(04,047,Substr(SA2->A2_NOME,1,35)+"-"+SA2->A2_COD+"-"+SA2->A2_LOJA+(If(cPaisLoc$"ANG|PTG"," i.e.: "," I.E.: "))+" "+SA2->A2_INSCR,,)
EndIf
PrintOut(04,144-nDifColCC,"|",,)
PrintOut(05,001,"|",,)
PrintOut(05,003,(If(cPaisLoc$"ANG|PTG","Código postal :","CEP :"))+Trans(SM0->M0_CEPENT,cCepPict)+" - "+Trim(SM0->M0_CIDENT)+" - "+SM0->M0_ESTENT,,)
PrintOut(05,045,"|",,)
PrintOut(05,047,SA2->A2_END,PesqPict("SA2","A2_END"),)
PrintOut(05,089,"-  "+Trim(SA2->A2_BAIRRO),"@!",)
PrintOut(05,144-nDifColCC,"|",,)
PrintOut(06,001,"|",,)
PrintOut(06,003,If(cPaisLoc$"ANG|PTG","Tel: ","TEL: ")+SM0->M0_TEL,,)
PrintOut(06,023,If(cPaisLoc$"ANG|PTG","Fax: ","FAX: ")+SM0->M0_FAX,,)
PrintOut(06,045,"|",,)
PrintOut(06,047,Trim(SA2->A2_MUN),"@!",)
PrintOut(06,069,SA2->A2_EST,PesqPict("SA2","A2_EST"),)
PrintOut(06,074,If(cPaisLoc$"ANG|PTG","Código postal :","CEP :"),,)
PrintOut(06,081,SA2->A2_CEP,PesqPict("SA2","A2_CEP"),)

dbSelectArea("SX3")
nOrden = IndexOrd()
dbSetOrder(2)
dbSeek("A2_CGC")
cCGC := Alltrim(X3TITULO())
PrintOut(06,093,cCGC,,)
dbSetOrder(nOrden)

dbSelectArea("SA2")
PrintOut(06,103,SA2->A2_CGC,PesqPict("SA2","A2_CGC"),)
PrintOut(06,144-nDifColCC,"|",,)
PrintOut(07,001,"|",,)
PrintOut(07,002,(cCGC)+" "+Transform(SM0->M0_CGC,cCgcPict),,)
PrintOut(07,045,"|",,)
PrintOut(07,047,SC7->C7_CONTATO,PesqPict("SC7","C7_CONTATO"),)
PrintOut(07,069,If(cPaisLoc$"ANG|PTG","Telefone: ","FONE: "),,)
PrintOut(07,075,"("+Substr(SA2->A2_DDD,1,3)+") "+Substr(SA2->A2_TEL,1,15),,)
PrintOut(07,100,(If(cPaisLoc$"ANG|PTG","Fax: ","FAX: ")),,)
PrintOut(07,106,"("+Substr(SA2->A2_DDD,1,3)+") "+SA2->A2_FAX,PesqPict("SA2","A2_FAX"),)
PrintOut(07,144-nDifColCC,"|",,)
PrintOut(08,001,"|",,)
PrintOut(08,002,Replicate("-",limite),,)
PrintOut(08,144-nDifColCC,"|",,)

If mv_par08 == 1 .OR.  mv_par08 == 3
	PrintOut(09,001,"|",,)
	PrintOut(09,002,"Item|",,)
	PrintOut(09,009,If(cPaisLoc$"ANG|PTG","Código      ","Codigo      "),,)
	PrintOut(09,022,If(cPaisLoc$"ANG|PTG","|descrição Do Material","|Descricao do Material"),,)
	PrintOut(09,051,If(cPaisLoc$"ANG|PTG","|um|  Quant.","|UM|  Quant."),,)
	PrintOut(09,067,IIF(nDifColcc==0,If(cPaisLoc$"ANG|PTG","|valor unitário|      valor total     | entrega  |  c.c.              | s.c. |","|Valor Unitario|      Valor Total     | Entrega  |  C.C.              | S.C. |"),If(cPaisLoc$"ANG|PTG","|valor unitário|      valor total     | entrega  |  c.c.   | s.c. |","|Valor Unitario|      Valor Total     | Entrega  |  C.C.   | S.C. |")),,)
	PrintOut(10,001,"|",,)
	PrintOut(10,002,Replicate("-",limite),,)
	PrintOut(10,144-nDifColCC,"|",,)
Else
	PrintOut(09,001,"|",,)
	PrintOut(09,002,"Item|",,)
	PrintOut(09,009,If(cPaisLoc$"ANG|PTG","Código      ","Codigo      "),,)
	PrintOut(09,022,If(cPaisLoc$"ANG|PTG","|descrição Do Material","|Descricao do Material"),,)
	PrintOut(09,051,If(cPaisLoc$"ANG|PTG","|um|  Quant.","|UM|  Quant."),,)
	PrintOut(09,067,If(cPaisLoc$"ANG|PTG","|valor unitário|  valor total   | entrega  | número da op  ","|Valor Unitario|  Valor Total   | Entrega  | Numero da OP  "),,)
	PrintOut(09,144-nDifColCC,"|",,)
	PrintOut(10,001,"|",,)
	PrintOut(10,002,Replicate("-",limite),,)
	PrintOut(10,144-nDifColCC,"|",,)
EndIf
dbSelectArea("SC7")
li := 10
Return .T. 


















Static Function R111Center(cLiberador)
Return( Space((30-Len(AllTrim(cLiberador)))/2)+AllTrim(cLiberador) )











Static Function AjustaSX1()

Local aHelpP15	:= {}
Local aHelpE15	:= {}
Local aHelpS15	:= {}

Aadd( aHelpP15, "Indicar se os pedidos de compras em     " )
Aadd( aHelpP15, "outras moedas devem ser convertidos para" )
Aadd( aHelpP15, " a moeda seleciona no parametro Qual Moe" )
Aadd( aHelpP15, "da, ou se nao devem ser impressos.      " )

Aadd( aHelpE15, "Determine if the purchase orders in othe" )
Aadd( aHelpE15, "r currencies must be converted into the " )
Aadd( aHelpE15, "selected currency found in paramet Qhich" )
Aadd( aHelpE15, "Currency?,or if they must not be printed" )

Aadd( aHelpS15, "Indicar si los pedidos de compras en    " )
Aadd( aHelpS15, "otras monedas deben convertirse a la    " )
Aadd( aHelpS15, "moneda seleccionada en el parametro     " )
Aadd( aHelpS15, "Cual Moneda? o si no deben imprimirse.  " )

PutSX1Help("P.MTR11115.",aHelpP15,aHelpE15,aHelpS15)

Return Nil



















Static Function R111FIniPC(cPedido,cItem,cSequen,cFiltro)
Local aArea		:= GetArea()
Local aAreaSC7	:= SC7->(GetArea())
Local cValid	:= ""
Local nPosRef	:= 0
Local nItem		:= 0
Local cItemDe	:= IIf(cItem==Nil,"",cItem)
Local cItemAte	:= IIf(cItem==Nil,Repl("Z",Len(SC7->C7_ITEM)),cItem)
Local cRefCols	:= ""
cSequen := If( cSequen == nil, "", cSequen ) ;
cFiltro := If( cFiltro == nil, "", cFiltro ) ;

dbSelectArea("SC7")
dbSetOrder(1)
If dbSeek(xFilial("SC7")+cPedido+cItemDe+Alltrim(cSequen))
	MaFisEnd()
	MaFisIni(SC7->C7_FORNECE,SC7->C7_LOJA,"F","N","R",{})

	While !Eof() .AND.  SC7->C7_FILIAL+SC7->C7_NUM == xFilial("SC7")+cPedido .AND.  SC7->C7_ITEM <= cItemAte .AND.  (Empty(cSequen) .OR.  cSequen == SC7->C7_SEQUEN)


		If &cFiltro
			dbSelectArea("SC7")
			dbSkip()
			Loop
		EndIf


		nItem++
		MaFisIniLoad(nItem)
		dbSelectArea("SX3")
		dbSetOrder(1)
		dbSeek("SC7")
		While !EOF() .AND.  (X3_ARQUIVO == "SC7")
			cValid	:= StrTran(UPPER(SX3->X3_VALID)," ","")
			cValid	:= StrTran(cValid,"'",'"')
			If "MAFISREF" $ cValid
				nPosRef  := AT('MAFISREF("',cValid) + 10
				cRefCols := Substr(cValid,nPosRef,AT('","MT120",',cValid)-nPosRef )

				MaFisLoad(cRefCols,&("SC7->"+ SX3->X3_CAMPO),nItem)
			EndIf
			dbSkip()
		End
		MaFisEndLoad(nItem,2)
		dbSelectArea("SC7")
		dbSkip()
	End
EndIf

RestArea(aAreaSC7)
RestArea(aArea)

Return .T. 