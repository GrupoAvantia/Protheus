#INCLUDE "matr972.ch"
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³MATR972   ºAutor  ³Andreia dos Santos  º Data ³  25/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Relatorio de conferencia da Nova GIA                        º±±
±±º          ³Portaria CAT 46/2000                                        º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ SIGAFIS                                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Function MATR972

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define Variaveis ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
LOCAL aSv:=	GetArea()
Local cVValid 
Local cVLayOut 
wnRel		:=	"MATR972"
Titulo 		:=	STR0001 //"Nova GIA"
cDesc1 		:=	STR0002 //"Emiss„o de listagem para auxiliar o preenchimento da GIA."
cDesc2 		:=	""
cDesc3 		:=	STR0003 //"Ir  imprimir os lan‡amentos fiscais conforme os parƒmetros informados."
aReturn		:=	{ STR0004, 1,STR0005, 2, 2, 1, "",1 } //"Zebrado"###"Administra‡„o"
nomeprog	:=	"MATR972"
cPerg		:=	"MTR972"
cString		:=	"SF3"
Tamanho		:=	'G'
Limite 		:=	220
nTipo		:=	18
cabec1 		:=	SM0->M0_FILIAL
cabec2 		:=	""
cabec3 		:=	"" 
m_pag		:=	1
cbtxt		:=	SPACE(10)
cbcont 		:=	0

AjustaSx1 (cPerg)
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Envia controle para a funcao SETPRINT ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
nLastKey	:=	0
wnrel		:=	SetPrint(cString,wnrel,cPerg,Titulo,cDesc1,cDesc2,cDesc3,.F.,"",.F.,Tamanho,,.F.)
If nLastKey==27
  	dbClearFilter()
  	Return
Endif
SetDefault(aReturn,cString)
If nLastKey==27
  	dbClearFilter()
  	Return
Endif

Pergunte(cPerg,.F.)
cVValid     :=  mv_par14
cVLayOut    :=  mv_par15
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Executa relatorio                                            ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If !((cVValid == "0700" .and. cVLayOut == "0200") .or. (cVValid == "0710" .and. cVLayOut == "0201") .or.;
	 (cVValid == "0720" .and. cVLayOut == "0202") .or. (cVValid == "0730" .and. cVLayOut == "0203") .or.;
	 (cVValid == "0740" .and. cVLayOut == "0204") .or. (cVValid == "0750" .and. cVLayOut == "0205") .or.;
	 (cVValid == "0760" .and. cVLayOut == "0206") .or. (cVValid == "0770" .and. cVLayOut == "0207") .or.;
	 (cVValid == "0780" .and. cVLayOut == "0208") .or. (cVValid == "0790" .and. cVLayOut == "0209") .or.;
	 (cVValid == "0800" .and. cVLayOut == "0210"))      
	Aviso( STR0296 , STR0297+cVValid+" "+ cVLayOut +". "+ STR0298 , {"Ok" } )  
	Return
Else
	RptStatus({|lEnd| R972Imp(@lEnd,wnRel,cString,Tamanho)},titulo)
	If aReturn[5]==1
	  	Set Printer To 	
	   ourspool(wnrel)
	Endif
EndIf
MS_FLUSH()

RestArea(aSv)
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFuncao    ³R972Imp   ºAutor  ³Andreia dos Santos  º Data ³  25/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Inicializa o processo de impressao.                         º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ MATR972                                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function R972Imp(lEnd,wnRel,cString,Tamanho)
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define variaveis              ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
PRIVATE nPagina		:=	1
PRIVATE	nLin	    :=	80
PRIVATE	lAbortPrint	:=	.F.
PRIVATE	aApuracao
Private	cArqCabec   := ""
Private cArqCFO     := ""          
Private cArqInt     := ""          
Private cArqZFM     := ""          
Private cArqOcor    := ""          
Private cArqIE      := ""          
Private	cArqDIPAM   := ""
Private cArqIeSt    := ""
Private cArqIeSd    := ""            
Private cArqExpt    := ""
Private cIndSF3	    := ""

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Parametros																³
³mv_par01 - Data Inicial       ?     									³
³mv_par02 - Data Final         ?   										³   	
³mv_par03 - Tipo de GIA        ?	(01-Normal/02-Substitutiva)         ³
³mv_par04 - GIA com Movimento  ?      									³
³mv_par05 - GIA ja transmitida ?	(Nao/Sim)							³
³mv_par06 - Saldo Credor - ST  ?    									³
³mv_par07 - Regime Tributario  ? (01-RPA/02-RES/03-RPA-DISPENSADO)     	³
³mv_par08 - Mes de Referencia  ?      									³
³mv_par09 - Ano de Referencia  ?      									³
³mv_par10 - Mes Ref. Inicial   ?      									³
³mv_par11 - Ano Ref. Inicial   ?      									³
³mv_par12 - Livro Selecionado  ?      									³
³mv_par13 - ICMS Fixado para o periodo?									³
³mv_par14 - Versao do Validador?	    								³
³mv_par15 - Versao do LayOut?       									³
³mv_par16 - Filial De                                                   ³
³mv_par17 - Filial Ate                                                  ³
³mv_par18 - NF Transf. Filiais                                          ³
³mv_par19 - Seleciona Filiais?                                          ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
*/

pergunte(cPerg,.F.)
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Recebe valores dos Parametros ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
PRIVATE	dDtIni		:=	mv_par01
PRIVATE	dDtFim		:=	mv_par02
PRIVATE	nTipoGia	:=	mv_par03
PRIVATE	nMoviment	:=	mv_par04	
PRIVATE	nTransmit	:=	mv_par05
PRIVATE	nSaldoST	:=	mv_par06
PRIVATE	nRegime		:=	mv_par07
PRIVATE	nMes		:=	mv_par08
PRIVATE	nAno		:=	mv_par09
PRIVATE	nMesIni		:=	mv_par10
PRIVATE	nAnoIni		:=	mv_par11
PRIVATE	cNrLivro	:=	mv_par12
PRIVATE nICMSFIX	:=	mv_par13
Private cVValid     :=  mv_par14
Private cVLayOut    :=  mv_par15
PRIVATE nTotDeb		:= 0
PRIVATE	nTotCred	:= 0
PRIVATE nSaldPer	:= 0
PRIVATE	nTDebST		:= 0     
PRIVATE nTCredST	:= 0
PRIVATE	AL			:=	{}
PRIVATE	cPictVal	:=	"@E) 999,999,999.99"
Private	cFilDe		:=	Iif (Empty (mv_par16+mv_par17), cFilAnt, mv_par16)
Private	cFilAte		:=	Iif (Empty (mv_par17), cFilAnt, mv_par17)
Private nGeraTransp :=  mv_par18
Private nSelFil     :=  mv_par19

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Grava valores das Apuracoes .IC?                             ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
aApuracao := A970ArqIC(.T.)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Cria arquivos temporarios       ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
a972CriaTemp()
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Monta arquivo de Trabalho                                    ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
a972MontTrab(aApuracao,.F.,dDtIni,dDtFim,cNrLivro,nRegime,cFilDe,cFilAte,cVLayOut,nSelFil)      
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Imprime Detalhamento de CFOP - ENTRADAS³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
(cArqCFO)->(dbSeek("1",.T.))
If !lAbortPrint .and. (cArqCFO)->(!eof())
	R972CFOEnt()
EndIf
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Imprime Detalhamento de CFOP - SAIDAS  ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
(cArqCFO)->(dbSeek("5",.T.))

If !lAbortPrint .and. (cArqCFO)->(!eof())
	R972CFOSai()
Endif
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Imprime Operacoes Interestaduais - ENTRADAS ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
(cArqInt)->(dbSeek("1",.t.))

If !lAbortPrint .and. (cArqInt)->(!eof()) 
	R972UFEnt()
EndIf	
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Imprime Operacoes Interestaduais - SAIDAS ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
(cArqInt)->(dbSeek("5",.t.))
If !lAbortPrint .and. (cArqInt)->(!eof()) 
	R972UFSai()
EndIf	
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Imprime Operacoes de saida para ZFM/ALC     ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If !lAbortPrint .And. (cArqZFM)->(LastRec()) > 0
	R972ZFM()
EndIf	
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Imprime Apuracao do ICMS - Operacoes Proprias  ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If !lAbortPrint
	R972Apur(1)
EndIf	
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Imprime Apuracao do ICMS - Substituicao Tributaria³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If !lAbortPrint
	R972Apur(2)
EndIf
roda(cbcont,cbtxt,Tamanho)
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Apaga arquivos temporarios               ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

If File(cArqCabec+GetDBExtension())
	dbSelectArea(cArqCabec)
	dbCloseArea()
	Ferase(cArqCabec+GetDBExtension())
	Ferase(cArqCabec+OrdBagExt())
Endif

If File(cArqCFO+GetDBExtension())
	dbSelectArea(cArqCFO)
	dbCloseArea()
	Ferase(cArqCFO+GetDBExtension())
	Ferase(cArqCFO+OrdBagExt())
Endif

If File(cArqInt+GetDBExtension())
	dbSelectArea(cArqInt)
	dbCloseArea()
	Ferase(cArqInt+GetDBExtension())
	Ferase(cArqInt+OrdBagExt())
Endif
If File(cArqZFM+GetDBExtension())
	dbSelectArea(cArqZFM)
	dbCloseArea()
	Ferase(cArqZFM+GetDBExtension())
	Ferase(cArqZFM+OrdBagExt())
Endif

If File(cArqOcor+GetDBExtension())
	dbSelectArea(cArqOcor)
	dbCloseArea()
	Ferase(cArqOcor+GetDBExtension())
	Ferase(cArqOcor+OrdBagExt())
Endif         

If File(cArqIE+GetDBExtension())
	dbSelectArea(cArqIE)
	dbCloseArea()
	Ferase(cArqIE+GetDBExtension())
	Ferase(cArqIE+OrdBagExt())
Endif

If (cVValid == "0700" .and. cVLayOut == "0200") .or.;
	(cVValid == "0710" .and. cVLayOut == "0201") .or.;
	(cVValid == "0720" .and. cVLayOut == "0202") .or.;
	(cVValid == "0730" .and. cVLayOut == "0203") .or.;
	(cVValid == "0740" .and. cVLayOut == "0204") .or.;
	(cVValid == "0750" .and. cVLayOut == "0205") .or.;
	(cVValid == "0760" .and. cVLayOut == "0206") .or.;
	(cVValid == "0770" .and. cVLayOut == "0207") .or.;
	(cVValid == "0780" .and. cVLayOut == "0208") .or.;
	(cVValid == "0790" .and. cVLayOut == "0209") .or.;
	(cVValid == "0800" .and. cVLayOut == "0210")	

	If File(cArqIeSt+GetDBExtension())
		dbSelectArea(cArqIeSt)
		dbCloseArea()
		Ferase(cArqIeSt+GetDBExtension())
		Ferase(cArqIeSt+OrdBagExt())
	Endif         

	If File(cArqIeSd+GetDBExtension())
		dbSelectArea(cArqIeSd)
		dbCloseArea()
		Ferase(cArqIeSd+GetDBExtension())
		Ferase(cArqIeSd+OrdBagExt())
	Endif         
   	If File(cArqExpt+GetDBExtension())
		dbSelectArea(cArqExpt)
		dbCloseArea()
		Ferase(cArqExpt+GetDBExtension())
		Ferase(cArqExpt+OrdBagExt())
	Endif         
EndIf	
If File(cArqDIPAM+GetDBExtension())
	dbSelectArea(cArqDIPAM)
	dbCloseArea()
	Ferase(cArqDIPAM+GetDBExtension())
	Ferase(cArqDIPAM+OrdBagExt())
Endif
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFunction  ³R972LayoutºAutor  ³Andreia dos Santos  º Data ³  25/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Layout do relatorio                                         º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ MATR972                                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function R972LayOut(nLayOut)

Do Case
	Case nLayOut==1
		aL			:=	Array(07)
		aL[01]	:=	Padc(STR0006,144) //"CONTRIBUINTE"
		aL[02]	:=	Padc("============",144)
		aL[03]	:=	STR0007 //"|==========================================================================================================================================|"
		aL[04]	:=	STR0008 //"| Inscr. Estadual  |    C.N.P.J.        | CNAE      |Tipo da GIA      |Regime Tributario  |Referencia|Ref.Inicial|Com Movimento|Transmitida|"
		aL[05]	:=	STR0009 //"|==================|====================|===========|=================|===================|==========|===========|=============|===========|"
		aL[06]	:=	STR0010 //"| ###############  | ################## | ######### | ############### | ##################|  ####### |  #######  |   ###       |   ###     |"
		aL[07]	:=	STR0007 //"|==========================================================================================================================================|"
	Case nLayOut==2
		aL			:=	Array(50)
		aL[01]	:=	" "
		aL[02]	:=	Padc(STR0011,132) //"RESUMO POR CFOPs - Entradas( Grupos 1, 2 e 3)"
		aL[03]	:=	Padc(STR0012,132) //"============================================="
        aL[04]	:=	" "
		aL[05]	:=STR0013 //"|=====================================================================================================================================================================|"
		aL[06]	:=STR0014 //"|       CODIGOS                  |    VALORES       |                          ICMS VALORES FISCAIS                             | IMPOSTO RETIDO   |OUTROS IMPOSTOS   |"
		aL[07]	:=STR0015 //"|                                |                  |---------------------------------------------------------------------------|                  |                  |"
		aL[08]	:=STR0016 //"|       FISCAIS                  |   CONTABEIS      |  OPERACOES COM CREDITO DO IMPOSTO   |   OPERACOES SEM CREDITO DO IMPOSTO  |                  |                  |"
		aL[09]	:=STR0017 //"|                                |                  |-------------------------------------|-------------------------------------|                  |                  |"
		aL[10]	:=STR0018 //"|                                |                  |BASE DE CALCULO   |IMPOSTO CREDITADO |ISENTAS/N.TRIBUT. | OUTRAS           |                  |                  |"
		aL[11]	:=STR0019 //"|================================|==================|==================|==================|==================|==================|==================|==================|"
		aL[12]	:=STR0020 //"| NO ESTADO                      |                  |                  |                  |                  |                  |                  |                  |"
		aL[13]	:=STR0021 //"| Compras         1.11/1.14      |                  |                  |                  |                  |                  |                  |                  |"
		aL[14]	:=STR0022 //"| Transferencia   1.21/1.24      |                  |                  |                  |                  |                  |                  |                  |"
		aL[15]	:=STR0023 //"| Devolucao       1.31/1.34      |                  |                  |                  |                  |                  |                  |                  |"
		aL[16]	:=STR0024 //"| Comp.En.Eletr.  1.41/1.44      |                  |                  |                  |                  |                  |                  |                  |"
		aL[17]	:=STR0025 //"| Aq.Serv.Comun.  1.51/1.55      |                  |                  |                  |                  |                  |                  |                  |"
		aL[18]	:=STR0026 //"| Aq.Serv.Transp. 1.61/1.65      |                  |                  |                  |                  |                  |                  |                  |"
		aL[19]	:=STR0027 //"| Subst.Trib.     1.71/1.79      |                  |                  |                  |                  |                  |                  |                  |"
		aL[20]	:=STR0028 //"| Outras               1.91      |                  |                  |                  |                  |                  |                  |                  |"
		aL[21]	:=STR0029 //"| Outras          1.92/1.99      |                  |                  |                  |                  |                  |                  |                  |"
		aL[22]	:=STR0030 //"| Outras             1.99.1      |                  |                  |                  |                  |                  |                  |                  |"
		aL[23]	:=STR0031 //"| Outras             1.99.9      |                  |                  |                  |                  |                  |                  |                  |"
		aL[24]	:=STR0032 //"| DE OUTROS ESTADOS              |                  |                  |                  |                  |                  |                  |                  |"
		aL[25]	:=STR0033 //"| Compras         2.11/2.14      |                  |                  |                  |                  |                  |                  |                  |"
		aL[26]	:=STR0034 //"| Transferencia   2.21/2.24      |                  |                  |                  |                  |                  |                  |                  |"
		aL[27]	:=STR0035 //"| Devolucao       2.31/2.34      |                  |                  |                  |                  |                  |                  |                  |"
		aL[28]	:=STR0036 //"| Comp.En.Eletr.  2.41/2.44      |                  |                  |                  |                  |                  |                  |                  |"
		aL[29]	:=STR0037 //"| Aq.Serv.Comun.  2.51/2.55      |                  |                  |                  |                  |                  |                  |                  |"
		aL[30]	:=STR0038 //"| Aq.Serv.Transp. 2.61/2.65      |                  |                  |                  |                  |                  |                  |                  |"
		aL[31]	:=STR0039 //"| Subst.Trib.     2.71/2.79      |                  |                  |                  |                  |                  |                  |                  |"
		aL[32]	:=STR0040 //"| Outras               2.91      |                  |                  |                  |                  |                  |                  |                  |"
		aL[33]	:=STR0041 //"| Outras          2.92/2.99      |                  |                  |                  |                  |                  |                  |                  |"
		aL[34]	:=STR0042 //"| Outras             2.99.1      |                  |                  |                  |                  |                  |                  |                  |"
		aL[35]	:=STR0043 //"| Outras             2.99.9      |                  |                  |                  |                  |                  |                  |                  |"
		aL[36]	:=STR0044 //"| DO EXTERIOR                    |                  |                  |                  |                  |                  |                  |                  |"
		aL[37]	:=STR0045 //"| Compras         3.11/3.13      |                  |                  |                  |                  |                  |                  |                  |"
		aL[38]	:=STR0046 //"| Devolucao       3.21/3.24      |                  |                  |                  |                  |                  |                  |                  |"
		aL[39]	:=STR0047 //"| Comp.En.Eletrica     3.31      |                  |                  |                  |                  |                  |                  |                  |"
		aL[40]	:=STR0048 //"| Aq.Serv.Comunicacao  3.41      |                  |                  |                  |                  |                  |                  |                  |"
		aL[41]	:=STR0049 //"| Aq.Serv.Transp. 3.51/3.54      |                  |                  |                  |                  |                  |                  |                  |"
		aL[42]	:=STR0050 //"| Outras               3.91      |                  |                  |                  |                  |                  |                  |                  |"
		aL[43]	:=STR0051 //"| Outras               3.94      |                  |                  |                  |                  |                  |                  |                  |"
		aL[44]	:=STR0052 //"| Outras          3.97/3.99      |                  |                  |                  |                  |                  |                  |                  |"
		aL[45]	:=STR0053 //"| Outras             3.99.1      |                  |                  |                  |                  |                  |                  |                  |"
		aL[46]	:=STR0054 //"| Outras             3.99.9      |                  |                  |                  |                  |                  |                  |                  |"
		aL[47]	:=STR0055 //"|                           #####|##################|##################|##################|##################|##################|##################|##################|"
		aL[48]	:=STR0056 //"|--------------------------------|------------------|------------------|------------------|------------------|------------------|------------------|------------------|"
		aL[49]	:=STR0057 //"| TOTAIS                         |##################|##################|##################|##################|##################|##################|##################|"
		aL[50]	:=STR0058 //"| Nao aceito na GIA         #####|                  |                  |                  |                  |                  |                  |                  |"

	Case nLayOut==3
		aL			:=	Array(52)
		aL[01]	:=	" "
		aL[02]	:=	Padc(STR0059,132) //"RESUMO POR CFOPs - SAIDAS( Grupos 5, 6 e 7)"
		aL[03]	:=	Padc(STR0060,132) //"==========================================="
        aL[04]	:=	" "
		aL[05]	:=STR0013 //"|=====================================================================================================================================================================|"
		aL[06]	:=STR0014 //"|       CODIGOS                  |    VALORES       |                          ICMS VALORES FISCAIS                             | IMPOSTO RETIDO   |OUTROS IMPOSTOS   |"
		aL[07]	:=STR0015 //"|                                |                  |---------------------------------------------------------------------------|                  |                  |"
		aL[08]	:=STR0061 //"|       FISCAIS                  |   CONTABEIS      |  OPERACOES COM DEBITO DO IMPOSTO    |   OPERACOES SEM DEBITO DO IMPOSTO   |                  |                  |"
		aL[09]	:=STR0017 //"|                                |                  |-------------------------------------|-------------------------------------|                  |                  |"
		aL[10]	:=STR0018 //"|                                |                  |BASE DE CALCULO   |IMPOSTO CREDITADO |ISENTAS/N.TRIBUT. | OUTRAS           |                  |                  |"
		aL[11]	:=STR0019 //"|================================|==================|==================|==================|==================|==================|==================|==================|"
		aL[12]	:=STR0020 //"| NO ESTADO                      |                  |                  |                  |                  |                  |                  |                  |"
		aL[13]	:=STR0062 //"| Vendas          5.11/5.17      |                  |                  |                  |                  |                  |                  |                  |"
		aL[14]	:=STR0063 //"| Transferencia   5.21/5.26      |                  |                  |                  |                  |                  |                  |                  |"
		aL[15]	:=STR0064 //"| Devolucao       5.31/5.34      |                  |                  |                  |                  |                  |                  |                  |"
		aL[16]	:=STR0065 //"| Venda En.Eletr. 5.41/5.45      |                  |                  |                  |                  |                  |                  |                  |"
		aL[17]	:=STR0066 //"| Prest.Serv.Com. 5.51/5.53      |                  |                  |                  |                  |                  |                  |                  |"
		aL[18]	:=STR0067 //"| Prest.Serv.Tran.5.61/5.63      |                  |                  |                  |                  |                  |                  |                  |"
		aL[19]	:=STR0068 //"| Subst.Trib.     5.71/5.79      |                  |                  |                  |                  |                  |                  |                  |"
		aL[20]	:=STR0069 //"| Outras          5.91/5.94      |                  |                  |                  |                  |                  |                  |                  |"
		aL[21]	:=STR0070 //"| Outras               5.95      |                  |                  |                  |                  |                  |                  |                  |"
		aL[22]	:=STR0071 //"| Outras          5.96/5.99      |                  |                  |                  |                  |                  |                  |                  |"
		aL[23]	:=STR0072 //"| Outras             5.99.1      |                  |                  |                  |                  |                  |                  |                  |"
		aL[24]	:=STR0073 //"| Outras             5.99.9      |                  |                  |                  |                  |                  |                  |                  |"
		aL[25]	:=STR0032 //"| DE OUTROS ESTADOS              |                  |                  |                  |                  |                  |                  |                  |"
		aL[26]	:=STR0074 //"| Vendas          6.11/6.19      |                  |                  |                  |                  |                  |                  |                  |"
		aL[27]	:=STR0075 //"| Transferencia   6.21/6.26      |                  |                  |                  |                  |                  |                  |                  |"
		aL[28]	:=STR0076 //"| Devolucao       6.31/6.34      |                  |                  |                  |                  |                  |                  |                  |"
		aL[29]	:=STR0077 //"| Venda En.Eletr. 6.41/6.45      |                  |                  |                  |                  |                  |                  |                  |"
		aL[30]	:=STR0078 //"| Prest.Serv.Com. 6.51/6.53      |                  |                  |                  |                  |                  |                  |                  |"
		aL[31]	:=STR0079 //"| Prest.Serv.Tran.6.61/6.63      |                  |                  |                  |                  |                  |                  |                  |"
		aL[32]	:=STR0080 //"| Subst.Trib.     6.71/6.79      |                  |                  |                  |                  |                  |                  |                  |"
		aL[33]	:=STR0173 //"| Remessa de Producao  6.86      |                  |                  |                  |                  |                  |                  |                  |"
		aL[34]	:=STR0081 //"| Outras          6.91/6.94      |                  |                  |                  |                  |                  |                  |                  |"
		aL[35]	:=STR0082 //"| Outras          6.96/6.99      |                  |                  |                  |                  |                  |                  |                  |"
		aL[36]	:=STR0083 //"| Outras               6.95      |                  |                  |                  |                  |                  |                  |                  |"
		aL[37]	:=STR0084 //"| Outras             6.99.1      |                  |                  |                  |                  |                  |                  |                  |"
		aL[38]	:=STR0085 //"| Outras             6.99.9      |                  |                  |                  |                  |                  |                  |                  |"
		aL[39]	:=STR0044 //"| DO EXTERIOR                    |                  |                  |                  |                  |                  |                  |                  |"
		aL[40]	:=STR0086 //"| Vendas          7.11/7.17      |                  |                  |                  |                  |                  |                  |                  |"
		aL[41]	:=STR0087 //"| Devolucao       7.31/7.34      |                  |                  |                  |                  |                  |                  |                  |"
		aL[42]	:=STR0088 //"| Venda En.Eletrica    7.41      |                  |                  |                  |                  |                  |                  |                  |"
		aL[43]	:=STR0089 //"| Prest.Serv.Com.      7.51      |                  |                  |                  |                  |                  |                  |                  |"
		aL[44]	:=STR0090 //"| Prest.Serv.Tran.     7.61      |                  |                  |                  |                  |                  |                  |                  |"
		aL[45]	:=STR0091 //"| Outras               7.99      |                  |                  |                  |                  |                  |                  |                  |"
		aL[46]	:=STR0092 //"| Outras             7.99.1      |                  |                  |                  |                  |                  |                  |                  |"
		aL[47]	:=STR0093 //"| Outras             7.99.9      |                  |                  |                  |                  |                  |                  |                  |"
		aL[48]	:=STR0055 //"|                           #####|##################|##################|##################|##################|##################|##################|##################|"
		aL[49]	:=STR0056 //"|--------------------------------|------------------|------------------|------------------|------------------|------------------|------------------|------------------|"
		aL[50]	:=STR0057 //"| TOTAIS                         |##################|##################|##################|##################|##################|##################|##################|"
		aL[51]	:=STR0058 //"| Nao aceito na GIA         #####|                  |                  |                  |                  |                  |                  |                  |"
		aL[52]	:=STR0286 //"| Vendas           (7.251, 7.551)|                  |                  |                  |                  |                  |                  |                  |"
	Case nLayOut==4
		aL			:=	Array(15)
		aL[01]	:=	" "
		aL[02]	:=	Padc(STR0094,132) //"INFORMACAO DAS OPERACOES E PRESTACOES INTERESTADUAIS - ICMS"
		aL[03]	:=	Padc(STR0095,132) //"==========================================================="
		aL[04]	:=	" "
		aL[05]	:=	Padc(STR0096,132) //"ENTRADAS DE MERCADORIAS, BENS E/OU AQUISICOES DE SERVICOS"
		aL[06]	:=	Padc(STR0097,132) //"========================================================="
        aL[07]	:=	" "
		aL[08]	:=STR0098 //"|==============================================================================================================================|"
		aL[09]	:=STR0099 //"| CFOP |  CODIGO E UNIDADE DE  |    VALORES    |   BASE DE     |    IMPOSTO    |   OUTRAS      |ICMS COBRADO P/SUBST.TRIBUTARIA|"
		aL[10]	:=STR0100 //"|      |                       |               |               |               |               |-------------------------------|"
		aL[11]	:=STR0101 //"|      |  FEDERACAO DE ORIGEM  |   CONTABEIS   |   CALCULO     |               |               |PETROLEO/ENERG.|OUTROS PRODUTOS|"
		aL[12]	:=STR0102 //"|======|=======================|===============|===============|===============|===============|===============|===============|"
		aL[13]	:=STR0103 //"|------|-----------------------|---------------|---------------|---------------|---------------|---------------|---------------|"
		aL[14]	:=STR0104 //"|######| ######################|###############|###############|###############|###############|###############|###############|"
		aL[15]	:=STR0105 //"|      | TOTAIS                |###############|###############|###############|###############|###############|###############|"
	Case nLayOut==5
		aL			:=	Array(15)
		aL[01]	:=	" "
		aL[02]	:=	Padc(STR0094,132) //"INFORMACAO DAS OPERACOES E PRESTACOES INTERESTADUAIS - ICMS"
		aL[03]	:=	Padc(STR0095,132) //"==========================================================="
		aL[04]	:=	" "
		aL[05]	:=	Padc(STR0106,132) //"SAIDAS DE MERCADORIAS, BENS E/OU PRESTACOES DE SERVICOS"
		aL[06]	:=	Padc(STR0107,132) //"======================================================="
      aL[07]	:=	" "
		aL[08]	:=STR0108 //"|===================================================================================================================================================================|"
		aL[09]	:=STR0109 //"| CFOP |  CODIGO E UNIDADE DE  |          VALORE CONTABEIS           |            BASE DE CALCULO          |    ISENTAS OU    |     OUTRAS       | ICMS COBRADO POR |"
		aL[10]	:=STR0110 //"|      |                       |-------------------------------------|-------------------------------------|      NAO         |                  |   SUBSTITUICAO   |"
		aL[11]	:=STR0111 //"|      |  FEDERACAO DE DESTINO |NAO CONTRIBUINTE  | CONTRIBUINTE     |NAO CONTRIBUINTE  | CONTRIBUINTE     |    TRIBUTADAS    |                  |    TRIBUTARIA    |"
		aL[12]	:=STR0112 //"|======|=======================|==================|==================|==================|==================|==================|==================|==================|"
		aL[13]	:=STR0113 //"|------|-----------------------|------------------|------------------|------------------|------------------|------------------|------------------|------------------|"
		aL[14]	:=STR0114 //"|######| ######################|##################|##################|##################|##################|##################|##################|##################|"
		aL[15]	:=STR0115 //"|      | TOTAIS                |##################|##################|##################|##################|##################|##################|##################|"
	Case nLayOut==6
		aL:=Array(12)
		aL[01]	:=	STR0116 //"                   RELACAO DE NOTAS FISCAIS DE SAIDA PARA ZFM/ALC"
		aL[02]	:=	STR0117 //"                   =============================================="
		aL[03]	:=	" "
		aL[04]	:=STR0118 //"|=======================================================================================|"
		aL[05]	:=STR0119 //"|CFOP  |  EMISSAO   |NUMERO | VALOR            |CNPJ DO DESTINATARIO | MUNICIPIO DESTINO|"
		aL[06]	:=STR0120 //"|======|============|=======|==================|=====================|==================|"
		aL[07]	:=STR0121 //"|######| ########## |###### |##################| ##################  |             #####|"
		aL[08]	:=STR0122 //"|SUB-TOTAL                   ##################|"
		aL[09]	:=STR0123 //"|TOTAL GERAL                 ##################|"
		aL[10]	:=STR0124 //"|==============================================|"
		aL[11]	:=STR0125 //"|----------------------------------------------|----------------------------------------|"
		aL[12]	:=STR0126 //"|----------------------------------------------|"
	Case nLayOut==7
		aL:=Array(41)
		aL[01]	:=" "
		aL[02]	:=STR0127 //"                    APURACAO DO ICMS - OPERACOES PROPRIAS"
		aL[03]	:=STR0128 //"                    ====================================="
		aL[04]	:=	" "
		aL[05]	:=STR0129 //"                  APURACAO DO ICMS - SUBSTITUICAO TRIBUTARIA"
		aL[06]	:=STR0130 //"                  =========================================="
      aL[07]	:=" "
		aL[08]	:=STR0131 //"|============================================================================"
		aL[09]	:=STR0132 //"|     | DEBITO DO IMPOSTO                          |     |                  |"
		aL[10]	:=STR0133 //"|-----|--------------------------------------------|-----|------------------|"
		aL[11]	:=STR0134 //"| 001 | Por saidas com debito do imposto           | 051 |##################|"
		aL[12]	:=STR0135 //"| 002 | Outros debitos                             |     |                  |"
		aL[13]	:=STR0136 //"|     |                                            | 052 |##################|"
		aL[14]	:=STR0137 //"| 003 | Estorno de creditos                        |     |                  |"
		aL[15]	:=STR0138 //"|     |                                            | 053 |##################|"
		aL[16]	:=STR0133 //"|-----|--------------------------------------------|-----|------------------|"
		aL[17]	:=STR0139 //"| 005 | SUBTOTAL-DEBITO( 051+052+053)              | 055 |##################|"
		aL[18]	:=STR0133 //"|-----|--------------------------------------------|-----|------------------|"
		aL[19]	:=STR0140 //"|     | CREDITO DO IMPOSTO                         |     |                  |"
		aL[20]	:=STR0133 //"|-----|--------------------------------------------|-----|------------------|"
		aL[21]	:=STR0141 //"| 006 | Por entradas com credito do imposto        | 056 |##################|"
		aL[22]	:=STR0142 //"| 007 | Outros Creditos                            |     |                  |"
		aL[23]	:=STR0143 //"|     |                                            | 057 |##################|"
		aL[24]	:=STR0144 //"| 008 | Estorno de debitos                         |     |                  |"
		aL[25]	:=STR0145 //"|     |                                            | 058 |##################|"
		aL[26]	:=STR0146 //"| 010 | SUBTOTAL( 056+057+058)                     | 060 |##################|"
		aL[27]	:=STR0147 //"| 011 | Saldo Credor do periodo anterior           | 061 |##################|"
		aL[28]	:=STR0133 //"|-----|--------------------------------------------|-----|------------------|"
		aL[29]	:=STR0148 //"| 012 | TOTAL-CREDITO( 060+061)                    | 062 |##################|"
		aL[30]	:=STR0133 //"|-----|--------------------------------------------|-----|------------------|"
		aL[31]	:=STR0149 //"|     | APURACAO DOS SALDOS                        |     |                  |"
		aL[32]	:=STR0133 //"|-----|--------------------------------------------|-----|------------------|"
		aL[33]	:=STR0150 //"| 013 | Saldo devedor(055-062)                     | 063 |##################|"
		aL[34]	:=STR0151 //"| 014 | Deducoes                                   | 064 |##################|"
		aL[35]	:=STR0152 //"| 015 | Imposto a recolher(063-064)                | 065 |##################|"
		aL[36]	:=STR0153 //"| 016 | Saldo Credor a transportar(062-055)        | 060 |##################|"
		aL[37]	:=STR0154 //"|===========================================================================|"
		aL[38]	:=STR0155 //"| 014 | Deducoes                                   |     |                  |"
		aL[39]	:=STR0156 //"|     |  ICMS Fixado p/o periodo ##################|     |                  |"
		aL[40]	:=STR0157 //"|     |  Outras                  ##################| 064 |##################|"
		aL[41]	:=STR0158 //"|     | Fixado a maior(064-063)                    | 067 |##################|"
	Case nLayOut==8
		aL:=Array(9)
		aL[01]:=" "
		aL[02]:=Padc(STR0159,132) //"DETALHAMENTO DE OUTROS CREDITOS( ITENS 007.04 A 007.07)"
		aL[03]:=Padc(STR0107,132) //"======================================================="
		aL[04]:=" "
		aL[08]:=STR0160 //"|=====================================================|"
		aL[05]:=STR0161 //"| COD.SUBITEM | I.E.Remetente   |Valor da Nota Fiscal |"
		aL[06]:=STR0162 //"|=============|=================|=====================|"
		aL[07]:=STR0163 //"|   ######    | ############### |  ################## |"
		aL[06]:=STR0160 //"|=====================================================|"
		aL[09]:=STR0164 //"| VALOR TOTAL DO SUBITEM           ################## |"
		aL[06]:=STR0160 //"|=====================================================|"
    Case nLayOut==9
		aL			:=	Array(15)
		aL[01]	:=	" "
		aL[02]	:=	Padc(STR0094,132) //"INFORMACAO DAS OPERACOES E PRESTACOES INTERESTADUAIS - ICMS"
		aL[03]	:=	Padc(STR0095,132) //"==========================================================="
		aL[04]	:=	" "
		aL[05]	:=	Padc(STR0096,132) //"ENTRADAS DE MERCADORIAS, BENS E/OU AQUISICOES DE SERVICOS"
		aL[06]	:=	Padc(STR0097,132) //"========================================================="
        aL[07]	:=	" "
	    aL[08]	:=	STR0176 //"|=============================================================================================================================|"
	    aL[09]	:=	STR0177 //"| CFOP |  CODIGO E UNIDADE DE  |    VALORES       |   BASE DE        |    OUTRAS        | ICMS COBRADO P/ SUBST. TRIBUTARIA   |"
        aL[10]	:=	STR0178 //"|      |                       |                  |                  |                  |-------------------------------------|"
        aL[11]	:=	STR0179 //"|      |  FEDERACAO DE ORIGEM  |   CONTABEIS      |   CALCULO        |                  |PETROLEO/ENERGIA  | OUTROS PRODUTOS  |"
        aL[12]	:=	STR0180 //"|======|=======================|==================|==================|==================|==================|==================|"
        aL[13]	:=	STR0181 //"|------|-----------------------|------------------|------------------|------------------|------------------|------------------|"
        aL[14]	:=	STR0182 //"|######| ######################|##################|##################|##################|##################|##################|"
        aL[15]	:=	STR0183 //"|      | TOTAIS                |##################|##################|##################|##################|##################|"
    Case nLayOut==10        
        aL			:=	Array(15)
		aL[01]	:=	" "
		aL[02]	:=	Padc(STR0094,132) //"INFORMACAO DAS OPERACOES E PRESTACOES INTERESTADUAIS - ICMS"
		aL[03]	:=	Padc(STR0095,132) //"==========================================================="
		aL[04]	:=	" "
		aL[05]	:=	Padc(STR0106,132) //"SAIDAS DE MERCADORIAS, BENS E/OU PRESTACOES DE SERVICOS"
		aL[06]	:=	Padc(STR0107,132) //"======================================================="
        aL[07]	:=	" "
		aL[08]	:=STR0184 //"|===============================================================================================================================================================|"
		aL[09]	:=STR0185 //"| CFOP |  CODIGO E UNIDADE DE  |          VALORE CONTABEIS     |        BASE DE CALCULO        |    ISENTAS OU |   IMPOSTO     |     OUTRAS    |ICMS COBRADO POR|"
		aL[10]	:=STR0186 //"|      |                       |-------------------------------|-------------------------------|      NAO      |               |               |  SUBSTITUICAO  |"
		aL[11]	:=STR0187 //"|      |  FEDERACAO DE DESTINO |NAO CONTRIBNT. | CONTRIBUINTE  |NAO CONTRIBNT. | CONTRIBUINTE  |    TRIBUTADAS |               |               |   TRIBUTARIA   |"
		aL[12]	:=STR0188 //"|======|=======================|===============|===============|===============|===============|===============|===============|===============|================|"
		aL[13]	:=STR0189 //"|------|-----------------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|----------------|"
		aL[14]	:=STR0190 //"|######| ######################|###############|###############|###############|###############|###############|###############|###############|################|"
		aL[15]	:=STR0191 //"|      | TOTAIS                |###############|###############|###############|###############|###############|###############|###############|################|"
	Case nLayOut==11
		aL			:=	Array(52)
		aL[01]	:=	" "
		aL[02]	:=	Padc(STR0011,132) //"RESUMO POR CFOPs - Entradas( Grupos 1, 2 e 3)"
		aL[03]	:=	Padc(STR0012,132) //"============================================="
        aL[04]	:=	" "
		aL[05]	:= STR0192 //"|================================================================================================================================================================================|"
		aL[06]	:= STR0193 //"|       CODIGOS                  |    VALORES    |                          ICMS VALORES FISCAIS                 | IMPOSTO RETIDO|  SUBSTITUTO   |  SUBSTITUIDO  |OUTROS IMPOSTOS|"
		aL[07]	:= STR0194 //"|                                |               |---------------------------------------------------------------|               |               |               |               |"
		aL[08]	:= STR0195 //"|       FISCAIS                  |   CONTABEIS   |OPERACOES C/CREDITO DO IMPOSTO |OPERACOES SEM CREDT.DO IMPOSTO |               |               |               |               |"
		aL[09]	:= STR0196 //"|                                |               |-------------------------------|-------------------------------|               |               |               |               |"
		aL[10]	:= STR0197 //"|                                |               |BASE DE CALCULO|IMPOSTO CREDIT.|ISENT./N.TRIBT.| OUTRAS        |               |               |               |               |"
		aL[11]	:= STR0198 //"|================================|===============|===============|===============|===============|===============|===============|===============|===============|===============|"
		aL[12]	:= STR0199 //"| NO ESTADO                      |               |               |               |               |               |               |               |               |               |"
		aL[13]	:= STR0200 //"| Compras         1.11/1.14      |               |               |               |               |               |               |               |               |               |"
		aL[14]	:= STR0201 //"| Transferencia   1.21/1.24      |               |               |               |               |               |               |               |               |               |"
		aL[15]	:= STR0202 //"| Devolucao       1.31/1.34      |               |               |               |               |               |               |               |               |               |"
        aL[16]  := STR0203 //"| Comp.En.Eletr.  1.41/1.46      |               |               |               |               |               |               |               |               |               |"
		aL[17]	:= STR0204 //"| Aq.Serv.Comun.  1.51/1.55      |               |               |               |               |               |               |               |               |               |"
		aL[18]	:= STR0205 //"| Aq.Serv.Transp. 1.61/1.65      |               |               |               |               |               |               |               |               |               |"
		aL[19]	:= STR0206 //"| Subst.Trib.     1.71/1.79      |               |               |               |               |               |               |               |               |               |"
		aL[20]	:= STR0207 //"| Outras               1.91      |               |               |               |               |               |               |               |               |               |"
		aL[21]	:= STR0208 //"| Outras          1.92/1.99      |               |               |               |               |               |               |               |               |               |"
		aL[22]	:= STR0209 //"| Outras             1.99.1      |               |               |               |               |               |               |               |               |               |"
		aL[23]	:= STR0210 //"| Outras             1.99.9      |               |               |               |               |               |               |               |               |               |"
		aL[24]	:= STR0211 //"| DE OUTROS ESTADOS              |               |               |               |               |               |               |               |               |               |"
		aL[25]	:= STR0212 //"| Compras         2.11/2.14      |               |               |               |               |               |               |               |               |               |"
		aL[26]	:= STR0213 //"| Transferencia   2.21/2.24      |               |               |               |               |               |               |               |               |               |"
		aL[27]	:= STR0214 //"| Devolucao       2.31/2.34      |               |               |               |               |               |               |               |               |               |"
        aL[28]  := STR0215 //"| Comp.En.Eletr.  2.41/2.46      |               |               |               |               |               |               |               |               |               |"
		aL[29]	:= STR0216 //"| Aq.Serv.Comun.  2.51/2.55      |               |               |               |               |               |               |               |               |               |"
		aL[30]	:= STR0217 //"| Aq.Serv.Transp. 2.61/2.65      |               |               |               |               |               |               |               |               |               |"
		aL[31]	:= STR0218 //"| Subst.Trib.     2.71/2.79      |               |               |               |               |               |               |               |               |               |"
		aL[32]	:= STR0229 //"| Outras               2.91      |               |               |               |               |               |               |               |               |               |"
		aL[33]	:= STR0220 //"| Outras          2.92/2.99      |               |               |               |               |               |               |               |               |               |"
		aL[34]	:= STR0221 //"| Outras             2.99.1      |               |               |               |               |               |               |               |               |               |"
		aL[35]	:= STR0222 //"| Outras             2.99.9      |               |               |               |               |               |               |               |               |               |"
		aL[36]	:= STR0223 //"| DO EXTERIOR                    |               |               |               |               |               |               |               |               |               |"
		aL[37]	:= STR0224 //"| Compras         3.11/3.13      |               |               |               |               |               |               |               |               |               |"
		aL[38]	:= STR0225 //"| Devolucao       3.21/3.24      |               |               |               |               |               |               |               |               |               |"
		aL[39]	:= STR0226 //"| Comp.En.Eletrica     3.31      |               |               |               |               |               |               |               |               |               |"
		aL[40]	:= STR0227 //"| Aq.Serv.Comunicacao  3.41      |               |               |               |               |               |               |               |               |               |"
		aL[41]	:= STR0228 //"| Aq.Serv.Transp. 3.51/3.54      |               |               |               |               |               |               |               |               |               |"
		aL[42]	:= STR0229 //"| Outras               3.91      |               |               |               |               |               |               |               |               |               |"
		aL[43]	:= STR0230 //"| Outras               3.94      |               |               |               |               |               |               |               |               |               |"
		aL[44]	:= STR0231 //"| Outras          3.97/3.99      |               |               |               |               |               |               |               |               |               |"
		aL[45]	:= STR0232 //"| Outras             3.99.1      |               |               |               |               |               |               |               |               |               |"
		aL[46]	:= STR0233 //"| Outras             3.99.9      |               |               |               |               |               |               |               |               |               |"
		aL[47]	:= STR0234 //"|                           #####|###############|###############|###############|###############|###############|###############|###############|###############|###############|"
		aL[48]	:= STR0235 //"|--------------------------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|"
		aL[49]	:= STR0236 //"| TOTAIS                         |###############|###############|###############|###############|###############|###############|###############|###############|###############|"
		aL[50]	:= STR0237 //"| Nao aceito na GIA         #####|               |               |               |               |               |               |               |               |               |"
		aL[51]	:= STR0287 //"| Entr. Combus. Lubrificantes (1.651/1.699)      |               |               |               |               |               |               |               |               |               |"
		aL[52]	:= STR0288 //"| Entr. Combus. Lubrificantes (2.651/2.699)      |               |               |               |               |               |               |               |               |               |"
	Case nLayOut==12
		aL			:=	Array(54)
		aL[01]	:=	" "
    	aL[02]	:=	Padc(STR0059,132) //"RESUMO POR CFOPs - SAIDAS( Grupos 5, 6 e 7)"
		aL[03]	:=	Padc(STR0060,132) //"==========================================="
        aL[04]	:=	" "
		aL[05]	:= STR0238 //"|================================================================================================================================================================================|"
		aL[06]	:= STR0239 //"|       CODIGOS                  |    VALORES    |                          ICMS VALORES FISCAIS                 | IMPOSTO RETIDO|  SUBSTITUTO   |  SUBSTITUIDO  |OUTROS IMPOSTOS|"
		aL[07]	:= STR0240 //"|                                |               |---------------------------------------------------------------|               |               |               |               |"
		aL[08]	:= STR0241 //"|       FISCAIS                  |   CONTABEIS   |OPERACOES C/CREDITO DO IMPOSTO |OPERACOES SEM CREDT.DO IMPOSTO |               |               |               |               |"
		aL[09]	:= STR0242 //"|                                |               |-------------------------------|-------------------------------|               |               |               |               |"
		aL[10]	:= STR0243 //"|                                |               |BASE DE CALCULO|    IMPOSTO    |ISENT./N.TRIBT.| OUTRAS        |               |               |               |               |"
		aL[11]	:= STR0244 //"|================================|===============|===============|===============|===============|===============|===============|===============|===============|===============|"
		aL[12]	:= STR0245 //"| NO ESTADO                      |               |               |               |               |               |               |               |               |               |"
		aL[13]	:= STR0246 //"| Vendas          5.11/5.17      |               |               |               |               |               |               |               |               |               |"
		aL[14]	:= STR0247 //"| Transferencia   5.21/5.26      |               |               |               |               |               |               |               |               |               |"
		aL[15]	:= STR0248 //"| Devolucao       5.31/5.34      |               |               |               |               |               |               |               |               |               |"
		aL[16]	:= STR0249 //"| Venda En.Eletr. 5.41/5.45      |               |               |               |               |               |               |               |               |               |"
		aL[17]	:= STR0250 //"| Prest.Serv.Com. 5.51/5.53      |               |               |               |               |               |               |               |               |               |"
		aL[18]	:= STR0251 //"| Prest.Serv.Tran.5.61/5.63      |               |               |               |               |               |               |               |               |               |"
		aL[19]	:= STR0252 //"| Subst.Trib.     5.71/5.79      |               |               |               |               |               |               |               |               |               |"
		aL[20]	:= STR0253 //"| Outras          5.91/5.94      |               |               |               |               |               |               |               |               |               |"
		aL[21]	:= STR0254 //"| Outras               5.95      |               |               |               |               |               |               |               |               |               |"
		aL[22]	:= STR0255 //"| Outras          5.96/5.99      |               |               |               |               |               |               |               |               |               |"
		aL[23]	:= STR0256 //"| Outras             5.99.1      |               |               |               |               |               |               |               |               |               |"
		aL[24]	:= STR0257 //"| Outras             5.99.9      |               |               |               |               |               |               |               |               |               |"
		aL[25]	:= STR0258 //"| DE OUTROS ESTADOS              |               |               |               |               |               |               |               |               |               |"
		aL[26]	:= STR0259 //"| Vendas          6.11/6.19      |               |               |               |               |               |               |               |               |               |"
		aL[27]	:= STR0260 //"| Transferencia   6.21/6.26      |               |               |               |               |               |               |               |               |               |"
		aL[28]	:= STR0261 //"| Devolucao       6.31/6.34      |               |               |               |               |               |               |               |               |               |"
		aL[29]	:= STR0262 //"| Venda En.Eletr. 6.41/6.45      |               |               |               |               |               |               |               |               |               |"
		aL[30]	:= STR0263 //"| Prest.Serv.Com. 6.51/6.53      |               |               |               |               |               |               |               |               |               |"
		aL[31]	:= STR0264 //"| Prest.Serv.Tran.6.61/6.63      |               |               |               |               |               |               |               |               |               |"
		aL[32]	:= STR0265 //"| Subst.Trib.     6.71/6.79      |               |               |               |               |               |               |               |               |               |"
		aL[33]	:= STR0266 //"| Remessa de Producao  6.86      |               |               |               |               |               |               |               |               |               |"
		aL[34]	:= STR0267 //"| Outras          6.91/6.94      |               |               |               |               |               |               |               |               |               |"
		aL[35]	:= STR0268 //"| Outras          6.96/6.99      |               |               |               |               |               |               |               |               |               |"
		aL[36]	:= STR0269 //"| Outras               6.95      |               |               |               |               |               |               |               |               |               |"
		aL[37]	:= STR0270 //"| Outras             6.99.1      |               |               |               |               |               |               |               |               |               |"
		aL[38]	:= STR0271 //"| Outras             6.99.9      |               |               |               |               |               |               |               |               |               |"
		aL[39]	:= STR0272 //"| DO EXTERIOR                    |               |               |               |               |               |               |               |               |               |"
		aL[40]	:= STR0273 //"| Vendas(7.101 a 7.127, 7.251 e 7.211)|               |               |               |               |               |               |               |               |               |"
		aL[41]	:= STR0274 //"| Devolucao (7.201 a 7.211, 7.553 e 7.556)|               |               |               |               |               |               |               |               |               |"
		aL[42]	:= STR0275 //"| Venda En.Eletrica    7.41      |               |               |               |               |               |               |               |               |               |"
		aL[43]	:= STR0276 //"| Prest.Serv.Com.      7.51      |               |               |               |               |               |               |               |               |               |"
		aL[44]	:= STR0277 //"| Prest.Serv.Tran.     7.61      |               |               |               |               |               |               |               |               |               |"
		aL[45]	:= STR0278 //"| Outras               7.99      |               |               |               |               |               |               |               |               |               |"
		aL[46]	:= STR0279 //"| Outras             7.99.1      |               |               |               |               |               |               |               |               |               |"
		aL[47]	:= STR0280 //"| Outras             7.99.9      |               |               |               |               |               |               |               |               |               |"
		aL[48]	:= STR0281 //"|                           #####|###############|###############|###############|###############|###############|###############|###############|###############|###############|"
		aL[49]	:= STR0282 //"|--------------------------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|"
		aL[50]	:= STR0283 //"| TOTAIS                         |###############|###############|###############|###############|###############|###############|###############|###############|###############|"
		aL[51]	:= STR0284 //"| Nao aceito na GIA         #####|               |               |               |               |               |               |               |               |               |"
		aL[52]	:= STR0285 //"| Vendas           (7.251, 7.551)|               |               |               |               |               |               |               |               |               |"
		aL[53]	:= STR0289 //"| Saidas Combust./Lubrif.     (5.651/5.699)      |               |               |               |               |               |               |               |               |               |"
		aL[54]	:= STR0290 //"| Saidas Combust./Lubrif.     (6.651/6.699)      |               |               |               |               |               |               |               |               |               |"	  
EndCase

Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFunction  ³R972Contr ºAutor  ³Andreia dos Santos  º Data ³  28/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Imprime os dados do contribuinte                           º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ MATR972                                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Function R972Contr()
Local cAlias	:= Alias()
nLin		:=	80

R972LayOut(1)

dbSelectArea(cArqCabec)
dbGoTop()
While !eof()

	If Interrupcao(@lAbortPrint)
		Exit
	Endif
        If nLin>55
		cabec(titulo,cabec1,cabec2,nomeprog,tamanho,nTipo)
		nLin:=PROW()+1
		FmtLin({Replic("*",Limite)},"#",,,@nLin)
		nLin:=nLin+1
		FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5]},,,@nLin)
	Endif 
	
	aDados:=Array(9)
	aDados[1]	:=	Transform((cArqCabec)->IE,"@R 999.999.999.999")			//Inscricao Estadual
	aDados[2]	:=	Transform((cArqCabec)->CNPJ,"@R 99.999.999/9999-99")		//CNPJ
	aDados[3]	:=	Transform((cArqCabec)->CNAE,"@R 9999-9/99")		//CNAE
	aDados[4]	:=	(cArqCabec)->TIPO+"-"+if((cArqCabec)->TIPO=="01",STR0165,if((cArqCabec)->TIPO=="02",STR0166,STR0167))		//Tipo da GIA //"Normal"###"Substitutiva"###"Coligida"
	aDados[5]	:=	(cArqCabec)->REGTRIB+"-"+if((cArqCabec)->REGTRIB	=="01",STR0168,if((cArqCabec)->REGTRIB	=="02",STR0169,STR0170))//Regime Tributario //"RPA"###"RES"###"RPA-DISPENSADO"
	aDados[6]	:=	substr((cArqCabec)->REF,5,2)+"/"+substr((cArqCabec)->REF,1,4)	//Referencia
	aDados[7]	:=	substr((cArqCabec)->REFINIC,5,2)+"/"+substr((cArqCabec)->REFINIC,1,4)	//Referencia Inicial
	aDados[8]	:=	if((cArqCabec)->MOVIMEN=="1",STR0171,STR0172)	//Com Movimento //"Sim"###"Nao"
	aDados[9]	:=	if((cArqCabec)->TRANSMI=="1",STR0171,STR0172)	//Transmitida //"Sim"###"Nao"
	nSaldPer		:=	(cArqCabec)->SALDO
	FmtLin(@aDados,aL[6],cPictVal,,@nLin)
	dbSkip()
End

FmtLin(,aL[7],,,@nLin)

dbSelectArea(cAlias)

return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFunction  ³R972CFOEntºAutor  ³Andreia dos Santos  º Data ³  28/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Imprime o resumo por CFO das Entradas                       º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ MATR972                                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Function R972CFOEnt
Local cAlias		:= Alias()
Local aCfo			:= array(4)
Local lFirstEst	:= .T.
Local lFirstINT	:= .T.
Local lFirstEXT	:= .T.
Local aTotais	:= {}
Local cTexto	:=""

aTotais	:= If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
			 (cVValid == "0710" .and. cVLayOut == "0201") .or.;
			 (cVValid == "0720" .and. cVLayOut == "0202") .or.;
			 (cVValid == "0730" .and. cVLayOut == "0203") .or.;
			 (cVValid == "0740" .and. cVLayOut == "0204") .or.;
			 (cVValid == "0750" .and. cVLayOut == "0205") .or.;
			 (cVValid == "0760" .and. cVLayOut == "0206") .or.;
			 (cVValid == "0770" .and. cVLayOut == "0207") .or.;
			 (cVValid == "0780" .and. cVLayOut == "0208") .or.;
			 (cVValid == "0790" .and. cVLayOut == "0209") .or.;
			 (cVValid == "0800" .and. cVLayOut == "0210"), array(9),array(7))

nLin		:=	80  
SX5->(dbSetOrder(1))

afill(aTotais,0)

R972LayOut(1)
R972Contr()

R972LayOut(If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
			 (cVValid == "0710" .and. cVLayOut == "0201") .or.;
			 (cVValid == "0720" .and. cVLayOut == "0202") .or.;
			 (cVValid == "0730" .and. cVLayOut == "0203") .or.;
			 (cVValid == "0740" .and. cVLayOut == "0204") .or.;
			 (cVValid == "0750" .and. cVLayOut == "0205") .or.;
			 (cVValid == "0760" .and. cVLayOut == "0206") .or.;
			 (cVValid == "0770" .and. cVLayOut == "0207") .or.;
			 (cVValid == "0780" .and. cVLayOut == "0208") .or.;
			 (cVValid == "0790" .and. cVLayOut == "0209") .or.;
			 (cVValid == "0800" .and. cVLayOut == "0210"),11,2))

nLin++
FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6],aL[7],aL[8],aL[9],aL[10],aL[11]},,,@nLin)

dbSelectArea(cArqCFO)
dbGoTop()
While !eof().and. substr((cArqCFO)->CFOP,1,1)<'5'

	If Interrupcao(@lAbortPrint)
		Exit
	Endif
        If nLin>55
		cabec(titulo,cabec1,cabec2,nomeprog,tamanho,nTipo)
		nLin:=PROW()+1
		FmtLin({Replic("*",Limite)},"#",,,@nLin)
		nLin:=nLin+1
		FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6],aL[7],aL[8],aL[9],aL[10],aL[11]},,,@nLin)
	Endif 
	
	if substr((cArqCFO)->CFOP,1,1) == "1" .and. lFirstEST	
		FmtLin(,aL[12],,,@nLin)
		FmtLin(,aL[48],,,@nLin)
	   lFirstEST	:= .F.
	ElseIf substr((cArqCFO)->CFOP,1,1) == "2" .and. lFirstINT	
		FmtLin(,aL[24],,,@nLin)
		FmtLin(,aL[48],,,@nLin)
	   lFirstINT	:= .F.
	ElseIf substr((cArqCFO)->CFOP,1,1) == "3" .and. lFirstEXT	
		FmtLin(,aL[36],,,@nLin)
		FmtLin(,aL[48],,,@nLin)
	   lFirstEXT	:= .F.
	Endif
   
	if (substr((cArqCFO)->CFOP,1,3) >= "111" .and. substr((cArqCFO)->CFOP,1,3) <= "114" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "1101" .and. substr((cArqCFO)->CFOP,1,4) <= "1126")
		FmtLin(,aL[13],,,@nLin)
		aCFO[1]	:=	"111"
		aCFO[2]	:=	"114"
		aCFO[3]	:=	"1101"
		aCFO[4]	:=	"1126"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "121" .and. substr((cArqCFO)->CFOP,1,3) <= "124" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "1151" .and. substr((cArqCFO)->CFOP,1,4) <= "1154")		
		FmtLin(,aL[14],,,@nLin)
		aCFO[1]	:=	"121"
		aCFO[2]	:=	"124"
		aCFO[3]	:=	"1151"
		aCFO[4]	:=	"1154"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "131" .and. substr((cArqCFO)->CFOP,1,3) <= "134" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "1201" .and. substr((cArqCFO)->CFOP,1,4) <= "1209")		
		FmtLin(,aL[15],,,@nLin)
		aCFO[1]	:=	"131"
		aCFO[2]	:=	"134"
		aCFO[3]	:=	"1201"
		aCFO[4]	:=	"1209"		
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "141" .and. substr((cArqCFO)->CFOP,1,3) <= "146" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "1251" .and. substr((cArqCFO)->CFOP,1,4) <= "1257")		
		FmtLin(,aL[16],,,@nLin)
		aCFO[1]	:=	"141"
		aCFO[2]	:=	"146"
		aCFO[3]	:=	"1251"
		aCFO[4]	:=	"1257"		
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "151" .and. substr((cArqCFO)->CFOP,1,3) <= "155" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "1301" .and. substr((cArqCFO)->CFOP,1,4) <= "1306")		
		FmtLin(,aL[17],,,@nLin)
		aCFO[1]	:=	"151"
		aCFO[2]	:=	"155"
		aCFO[3]	:=	"1301"
		aCFO[4]	:=	"1306"		
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "161" .and. substr((cArqCFO)->CFOP,1,3) <= "165" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "1351" .and. substr((cArqCFO)->CFOP,1,4) <= "1356")		
		FmtLin(,aL[18],,,@nLin)
		aCFO[1]	:=	"161"
		aCFO[2]	:=	"165"
		aCFO[3]	:=	"1351"
		aCFO[4]	:=	"1356"		
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "171" .and. substr((cArqCFO)->CFOP,1,3) <= "179" .and. nAno <= 2002).OR.;
		   (Val((cArqCFO)->CFOP) >= 1401 .and. Val((cArqCFO)->CFOP) <= 1449)		
		FmtLin(,aL[19],,,@nLin)
		aCFO[1]	:=	"171"
		aCFO[2]	:=	"179"
		aCFO[3]	:=	"1401"
		aCFO[4]	:=	"1449"		
	Elseif (substr((cArqCFO)->CFOP,1,3) == "191" .and. nAno <= 2002) .OR.;
		   (substr((cArqCFO)->CFOP,1,4) == "1551")		
		FmtLin(,aL[20],,,@nLin)
		aCFO[1]	:=	"191"
		aCFO[2]	:=	"191"
		aCFO[3]	:=	"1551"
		aCFO[4]	:=	"1551"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "192" .and. substr((cArqCFO)->CFOP,1,3) <= "199" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "1552" .and. substr((cArqCFO)->CFOP,1,4) <= "1557")		
		FmtLin(,aL[21],,,@nLin)
		aCFO[1]	:=	"192"
		aCFO[2]	:=	"199"
		aCFO[3]	:=	"1552"
		aCFO[4]	:=	"1557"
	Elseif (Val((cArqCFO)->CFOP) >= 1651 .And. Val((cArqCFO)->CFOP) <= 1699 .And. nAno >= 2004)
		FmtLin(,aL[51],,,@nLin)
		aCFO[3]	:=	"1651"
		aCFO[4]	:=	"1699"
    Elseif ALLTRIM((cArqCFO)->CFOP) == "1991"
		FmtLin(,aL[22],,,@nLin)
		aCFO[1]	:=	"1991"
		aCFO[2]	:=	"1991"
		aCFO[3]	:=	"1991"
		aCFO[4]	:=	"1991"
    Elseif (ALLTRIM((cArqCFO)->CFOP) == "1999").OR.;
		   (substr((cArqCFO)->CFOP,1,4) == "1949")
		FmtLin(,aL[23],,,@nLin)
		aCFO[1]	:=	"1999"
		aCFO[2]	:=	"1999"
		aCFO[3]	:=	"1949"
		aCFO[4]	:=	Alltrim((cArqCFO)->CFOP)
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "211" .and. substr((cArqCFO)->CFOP,1,3) <= "214" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "2101" .and. substr((cArqCFO)->CFOP,1,4) <= "2116")		
		FmtLin(,aL[25],,,@nLin)
		aCFO[1]	:=	"211"
		aCFO[2]	:=	"214"
		aCFO[3]	:=	"2101"
		aCFO[4]	:=	"2126"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "221" .and. substr((cArqCFO)->CFOP,1,3) <= "224" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "2151" .and. substr((cArqCFO)->CFOP,1,4) <= "2154")		
		FmtLin(,aL[26],,,@nLin)
		aCFO[1]	:=	"221"
		aCFO[2]	:=	"224"
		aCFO[3]	:=	"2151"
		aCFO[4]	:=	"2154"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "231" .and. substr((cArqCFO)->CFOP,1,3) <= "234" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "2201" .and. substr((cArqCFO)->CFOP,1,4) <= "2209")		
		FmtLin(,aL[27],,,@nLin)
		aCFO[1]	:=	"231"
		aCFO[2]	:=	"234"
		aCFO[3]	:=	"2201"
		aCFO[4]	:=	"2209"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "241" .and. substr((cArqCFO)->CFOP,1,3) <= "246" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "2251" .and. substr((cArqCFO)->CFOP,1,4) <= "2257")		
		FmtLin(,aL[28],,,@nLin)
		aCFO[1]	:=	"241"
		aCFO[2]	:=	"246"
		aCFO[3]	:=	"2251"
		aCFO[4]	:=	"2257"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "251" .and. substr((cArqCFO)->CFOP,1,3) <= "255" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "2301" .and. substr((cArqCFO)->CFOP,1,4) <= "2306")		
		FmtLin(,aL[29],,,@nLin)
		aCFO[1]	:=	"251"
		aCFO[2]	:=	"255"
		aCFO[3]	:=	"2301"
		aCFO[4]	:=	"2306"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "261" .and. substr((cArqCFO)->CFOP,1,3) <= "265" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "2351" .and. substr((cArqCFO)->CFOP,1,4) <= "2356")		
		FmtLin(,aL[30],,,@nLin)
		aCFO[1]	:=	"261"
		aCFO[2]	:=	"265"
		aCFO[3]	:=	"2351"
		aCFO[4]	:=	"2356"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "271" .and. substr((cArqCFO)->CFOP,1,3) <= "279" .and. nAno <= 2002).OR.;
		   (Val((cArqCFO)->CFOP) >= 2401 .and. Val((cArqCFO)->CFOP) <= 2449)		
		FmtLin(,aL[31],,,@nLin)
		aCFO[1]	:=	"271"
		aCFO[2]	:=	"279"
		aCFO[3]	:=	"2401"
		aCFO[4]	:=	"2449"
	Elseif (substr((cArqCFO)->CFOP,1,3) == "291" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) == "2551")
		FmtLin(,aL[32],,,@nLin)
		aCFO[1]	:=	"291"
		aCFO[2]	:=	"291"
		aCFO[3]	:=	"2551"
		aCFO[4]	:=	"2551"
	Elseif (Val((cArqCFO)->CFOP) >= 2651 .And. Val((cArqCFO)->CFOP) <= 2699 .And. nAno >= 2004)
		FmtLin(,aL[52],,,@nLin)
		aCFO[3]	:=	"2651"
		aCFO[4]	:=	"2699"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "292" .and. substr((cArqCFO)->CFOP,1,3) <= "299" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "2901" .and. substr((cArqCFO)->CFOP,1,4) <= "2925")		
		FmtLin(,aL[33],,,@nLin)
		aCFO[1]	:=	"292"
		aCFO[2]	:=	"299"
		aCFO[3]	:=	"2901"
		aCFO[4]	:=	"2925"
    Elseif ALLTRIM((cArqCFO)->CFOP) == "2991"
		FmtLin(,aL[34],,,@nLin)
		aCFO[1]	:=	"2991"
		aCFO[2]	:=	"2991"
		aCFO[3]	:=	"2991"
		aCFO[4]	:=	"2991"
    Elseif (ALLTRIM((cArqCFO)->CFOP) == "2999").OR.;
		   (substr((cArqCFO)->CFOP,1,4) == "2949")
        FmtLin(,aL[35],,,@nLin)
		aCFO[1]	:=	"2999"
		aCFO[2]	:=	"2999"
		aCFO[3]	:=	"2949"
		aCFO[4]	:=	"2949"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "311" .and. substr((cArqCFO)->CFOP,1,3) <= "313" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "3101" .and. substr((cArqCFO)->CFOP,1,4) <= "3127")		
		FmtLin(,aL[37],,,@nLin)
		aCFO[1]	:=	"311"
		aCFO[2]	:=	"313"
		aCFO[3]	:=	"3101"
		aCFO[4]	:=	"3127"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "321" .and. substr((cArqCFO)->CFOP,1,3) <= "324" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "3201" .and. substr((cArqCFO)->CFOP,1,4) <= "3211")		
		FmtLin(,aL[38],,,@nLin)
		aCFO[1]	:=	"321"
		aCFO[2]	:=	"324"
		aCFO[3]	:=	"3201"
		aCFO[4]	:=	"3211"
	Elseif (substr((cArqCFO)->CFOP,1,3) == "331" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) == "3251")
		FmtLin(,aL[39],,,@nLin)    
		aCFO[1]	:=	"331"
		aCFO[2]	:=	"331"
		aCFO[3]	:=	"3251"
		aCFO[4]	:=	"3251"
	Elseif (substr((cArqCFO)->CFOP,1,3) == "341" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) == "3301")
		FmtLin(,aL[40],,,@nLin)
		aCFO[1]	:=	"341"
		aCFO[2]	:=	"341"
		aCFO[3]	:=	"3301"
		aCFO[4]	:=	"3301"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "351" .and. substr((cArqCFO)->CFOP,1,3) <= "354" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) >= "3351" .and. substr((cArqCFO)->CFOP,1,4) <= "3356")		
		FmtLin(,aL[41],,,@nLin)
		aCFO[1]	:=	"351"
		aCFO[2]	:=	"354"
		aCFO[3]	:=	"3351"
		aCFO[4]	:=	"3356"
	Elseif (substr((cArqCFO)->CFOP,1,3) == "391" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) == "3551")
		FmtLin(,aL[42],,,@nLin)
		aCFO[1]	:=	"391"
		aCFO[2]	:=	"391"
		aCFO[3]	:=	"3551"
		aCFO[4]	:=	"3551"
	Elseif substr((cArqCFO)->CFOP,1,3) == "394" .and. nAno <= 2002 
		FmtLin(,aL[43],,,@nLin)
		aCFO[1]	:=	"394"
		aCFO[2]	:=	"394"
		aCFO[3]	:=	"394"
		aCFO[4]	:=	"394"
	Elseif (substr((cArqCFO)->CFOP,1,3) >= "397" .and. substr((cArqCFO)->CFOP,1,3) <= "399" .and. nAno <= 2002).OR.;
		   (substr((cArqCFO)->CFOP,1,4) == "3556")		
		FmtLin(,aL[44],,,@nLin)
		aCFO[1]	:=	"397"
		aCFO[2]	:=	"399"
		aCFO[3]	:=	"3556"
		aCFO[4]	:=	"3556"
    Elseif ALLTRIM((cArqCFO)->CFOP) == "3991"
		FmtLin(,aL[45],,,@nLin)
		aCFO[1]	:=	"3991"
		aCFO[2]	:=	"3991"
		aCFO[3]	:=	"3991"
		aCFO[4]	:=	"3991"
    Elseif (ALLTRIM((cArqCFO)->CFOP) == "3999").OR.;
		   (substr((cArqCFO)->CFOP,1,4) == "3949")
		FmtLin(,aL[46],,,@nLin)
		aCFO[1]	:=	"3999"
		aCFO[2]	:=	"3999"
		aCFO[3]	:=	"3949"
		aCFO[4]	:=	"3949"
	Else
		cTexto :=""
		If SX5->(DbSeek(xFilial("SX5")+"13"+(cArqCFO)->CFOP))
           cTexto := SUBS(SX5->X5_DESCRI,1,40)
        Endif   
        FmtLin({cTexto,(cArqCFO)->CFOP},aL[50],,,@nLin)
		aCFO[1]	:=	(cArqCFO)->CFOP
		aCFO[2]	:=	(cArqCFO)->CFOP
		aCFO[3]	:=	(cArqCFO)->CFOP
		aCFO[4]	:=	(cArqCFO)->CFOP
	Endif
	FmtLin(,aL[48],,,@nLin)

	while	!eof().and. (AllTrim((cArqCFO)->CFOP) >= AllTrim(aCFO[1]) .AND. AllTrim((cArqCFO)->CFOP) <= AllTrim(aCFO[2]) .And. nAno <= 2002) .Or. ;
						(AllTrim((cArqCFO)->CFOP) >= AllTrim(aCFO[3]) .AND. AllTrim((cArqCFO)->CFOP) <= AllTrim(aCFO[4]))	

		aDados   	:= If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
							(cVValid == "0710" .and. cVLayOut == "0201") .or.;
							(cVValid == "0720" .and. cVLayOut == "0202") .or.;
							(cVValid == "0730" .and. cVLayOut == "0203") .or.;
							(cVValid == "0740" .and. cVLayOut == "0204") .or.;
							(cVValid == "0750" .and. cVLayOut == "0205") .or.;
							(cVValid == "0760" .and. cVLayOut == "0206") .or.;
							(cVValid == "0770" .and. cVLayOut == "0207") .or.;
							(cVValid == "0780" .and. cVLayOut == "0208") .or.;
							(cVValid == "0790" .and. cVLayOut == "0209") .or.;
							(cVValid == "0800" .and. cVLayOut == "0210"),array(10),Array(8))

        aDados[1]   :=  Transform((cArqCFO)->CFOP,PesqPict("SF3","F3_CFO"))           //CFOP
		aDados[2]	:=	(cArqCFO)->VALCONT		//Valor Contabil    
		aDados[3]	:=	(cArqCFO)->BASEICM		//Base de Calculo
		aDados[4]	:=	(cArqCFO)->VALTRIB		//Imposto Creditado
		aDados[5]	:=	(cArqCFO)->ISENTA		//Isentas/Nao Tributadas
		aDados[6]	:=	(cArqCFO)->OUTRAS		//Outras           
		aDados[7]	:=	(cArqCFO)->RETIDO		//Imposto Retido

		If (cVValid == "0700" .and. cVLayOut == "0200") .or.;
			(cVValid == "0710" .and. cVLayOut == "0201") .or.;
			(cVValid == "0720" .and. cVLayOut == "0202") .or.;
			(cVValid == "0730" .and. cVLayOut == "0203") .or.;
			(cVValid == "0740" .and. cVLayOut == "0204") .or.;
			(cVValid == "0750" .and. cVLayOut == "0205") .or.;
			(cVValid == "0760" .and. cVLayOut == "0206") .or.;
			(cVValid == "0770" .and. cVLayOut == "0207") .or.;
			(cVValid == "0780" .and. cVLayOut == "0208") .or.;
			(cVValid == "0790" .and. cVLayOut == "0209") .or.;
			(cVValid == "0800" .and. cVLayOut == "0210")			
			
			aDados[8]	:=	(cArqCFO)->RtStSt
			aDados[9]	:=	(cArqCFO)->RtSbSt
			aDados[10]	:=	(cArqCFO)->IMPOSTO		//Outros Impostos     
			nTCredST	+=	(cArqCFO)->RtStSt
		Else			
			aDados[8]	:=	(cArqCFO)->IMPOSTO		//Outros Impostos
			nTCredST	+=	(cArqCFO)->RETIDO	
		Endif	
		nTotCred		+=	(cArqCFO)->VALTRIB

	   
	   atotais[1]	+=	(cArqCFO)->VALCONT
	   atotais[2]	+=	(cArqCFO)->BASEICM
	   atotais[3]	+=	(cArqCFO)->VALTRIB
	   atotais[4]	+=	(cArqCFO)->ISENTA 
	   atotais[5]	+=	(cArqCFO)->OUTRAS 
	   atotais[6]	+=	(cArqCFO)->RETIDO 

	   If (cVValid == "0700" .and. cVLayOut == "0200") .or.;
	   		(cVValid == "0710" .and. cVLayOut == "0201") .or.;
	   		(cVValid == "0720" .and. cVLayOut == "0202") .or.;
	   		(cVValid == "0730" .and. cVLayOut == "0203") .or.;
	   		(cVValid == "0740" .and. cVLayOut == "0204") .or.;
	   		(cVValid == "0750" .and. cVLayOut == "0205") .or.;
	   		(cVValid == "0750" .and. cVLayOut == "0205") .Or.;
	   		(cVValid == "0760" .and. cVLayOut == "0206") .or.;
	   		(cVValid == "0770" .and. cVLayOut == "0207") .or.;
	   		(cVValid == "0780" .and. cVLayOut == "0208") .or.;
	   		(cVValid == "0790" .and. cVLayOut == "0209") .or.;
	   		(cVValid == "0800" .and. cVLayOut == "0210")
	   		atotais[7]	+=	(cArqCFO)->RtStSt
			atotais[8]	+=	(cArqCFO)->RtSbSt
			atotais[9]	+=	(cArqCFO)->IMPOSTO		//Outros Impostos     
	   Else
	   		atotais[7]	+=	(cArqCFO)->IMPOSTO
	   EndIf
	   
		FmtLin(@aDados,aL[47],cPictVal,,@nLin)
		dbSkip()
	EndDo	
	FmtLin(,aL[48],,,@nLin)

End
FmtLin(@aTotais,aL[49],cPictVal,,@nLin)

FmtLin(,aL[5],,,@nLin)

dbSelectArea(cAlias)
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFunction  ³R972CFOSaiºAutor  ³Andreia dos Santos  º Data ³  28/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Imprime Resumo por CFO das Saidas                          º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP5                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Function R972CFOSai
Local cAlias	:= Alias()                      
Local	aCFO		:= array(4)
Local lFirstEst:= .T.
Local lFirstINT:= .T.
Local lFirstEXT:= .T.
Local aTotais	:= {}
Local cTexto	:=""

aTotais	:= If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
				(cVValid == "0710" .and. cVLayOut == "0201") .or.;
				(cVValid == "0720" .and. cVLayOut == "0202") .or.;
				(cVValid == "0730" .and. cVLayOut == "0203") .or.;
				(cVValid == "0740" .and. cVLayOut == "0204") .or.;
				(cVValid == "0750" .and. cVLayOut == "0205") .or.;
				(cVValid == "0760" .and. cVLayOut == "0206") .or.;
				(cVValid == "0770" .and. cVLayOut == "0207") .or.;
				(cVValid == "0780" .and. cVLayOut == "0208") .or.;
                (cVValid == "0790" .and. cVLayOut == "0209") .or.;
                (cVValid == "0800" .and. cVLayOut == "0210"),array(9),array(7))

nLin		:=	80  
SX5->(dbSetOrder(1))

R972LayOut(1)
R972Contr()
                           
afill(aTotais,0)
R972LayOut(If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
			 (cVValid == "0710" .and. cVLayOut == "0201") .or.;
			 (cVValid == "0720" .and. cVLayOut == "0202") .or.;
			 (cVValid == "0730" .and. cVLayOut == "0203") .or.;
			 (cVValid == "0740" .and. cVLayOut == "0204") .or.;
			 (cVValid == "0750" .and. cVLayOut == "0205") .or.;
			 (cVValid == "0760" .and. cVLayOut == "0206") .or.;
			 (cVValid == "0770" .and. cVLayOut == "0207") .or.;
			 (cVValid == "0780" .and. cVLayOut == "0208") .or.;
			 (cVValid == "0790" .and. cVLayOut == "0209") .or.;
			 (cVValid == "0800" .and. cVLayOut == "0210"),12,3))

nLin ++
FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6],aL[7],aL[8],aL[9],aL[10],aL[11]},,,@nLin)

dbSelectArea(cArqCFO)
dbSeek("5",.T.)

While !eof().and. substr((cArqCFO)->CFOP,1,1) >= "5"

	If Interrupcao(@lAbortPrint)
		Exit
	Endif
        If nLin>55
		cabec(titulo,cabec1,cabec2,nomeprog,tamanho,nTipo)
		nLin:=PROW()+1
		FmtLin({Replic("*",Limite)},"#",,,@nLin)
		nLin:=nLin+1
		FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6],aL[7],aL[8],aL[9],aL[10],aL[11]},,,@nLin)
	Endif 
	if substr((cArqCFO)->CFOP,1,1) == "5" .and. lFirstEST	
		FmtLin(,aL[12],,,@nLin)
		FmtLin(,aL[49],,,@nLin)
	   lFirstEST	:= .F.
	ElseIf substr((cArqCFO)->CFOP,1,1) == "6" .and. lFirstINT	
		FmtLin(,aL[25],,,@nLin)
		FmtLin(,aL[49],,,@nLin)
	   lFirstINT	:= .F.
	ElseIf substr((cArqCFO)->CFOP,1,1) == "7" .and. lFirstEXT	
		FmtLin(,aL[39],,,@nLin)
		FmtLin(,aL[49],,,@nLin)
	   lFirstEXT	:= .F.
	Endif
	
	if (substr((cArqCFO)->CFOP,1,3) >= "511" .and. substr((cArqCFO)->CFOP,1,3) <= "517" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "5101" .and. substr((cArqCFO)->CFOP,1,4) <= "5125")
		FmtLin(,aL[13],,,@nLin)
		aCFO[1]	:=	"511"
		aCFO[2]	:=	"517"
		aCFO[3]	:=	"5101"
		aCFO[4]	:=	"5125"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "521" .and. substr((cArqCFO)->CFOP,1,3) <= "526" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "5151" .and. substr((cArqCFO)->CFOP,1,4) <= "5156")
		FmtLin(,aL[14],,,@nLin)
		aCFO[1]	:=	"521"
		aCFO[2]	:=	"526"
		aCFO[3]	:=	"5151"
		aCFO[4]	:=	"5156"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "531" .and. substr((cArqCFO)->CFOP,1,3) <= "534" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "5201" .and. substr((cArqCFO)->CFOP,1,4) <= "5210")
		FmtLin(,aL[15],,,@nLin)
		aCFO[1]	:=	"531"
		aCFO[2]	:=	"534"
		aCFO[3]	:=	"5201"
		aCFO[4]	:=	"5210"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "541" .and. substr((cArqCFO)->CFOP,1,3) <= "545" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "5251" .and. substr((cArqCFO)->CFOP,1,4) <= "5258")
		FmtLin(,aL[16],,,@nLin)
		aCFO[1]	:=	"541"
		aCFO[2]	:=	"545"
		aCFO[3]	:=	"5251"
		aCFO[4]	:=	"5258"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "551" .and. substr((cArqCFO)->CFOP,1,3) <= "553" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "5301" .and. substr((cArqCFO)->CFOP,1,4) <= "5307")
		FmtLin(,aL[17],,,@nLin)
		aCFO[1]	:=	"551"
		aCFO[2]	:=	"553"
		aCFO[3]	:=	"5301"
		aCFO[4]	:=	"5307"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "561" .and. substr((cArqCFO)->CFOP,1,3) <= "563" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "5351" .and. substr((cArqCFO)->CFOP,1,4) <= "5359")
		FmtLin(,aL[18],,,@nLin)
		aCFO[1]	:=	"561"
		aCFO[2]	:=	"563"
		aCFO[3]	:=	"5351"
		aCFO[4]	:=	"5359"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "571" .and. substr((cArqCFO)->CFOP,1,3) <= "579" .and. nAno <= 2002).OR.;
	   (Val((cArqCFO)->CFOP) >= 5401 .and. Val((cArqCFO)->CFOP) <= 5449)
		FmtLin(,aL[19],,,@nLin)
		aCFO[1]	:=	"571"
		aCFO[2]	:=	"579"
		aCFO[3]	:=	"5401"
		aCFO[4]	:=	"5449"
	ElseIf (Val((cArqCFO)->CFOP) >= 5651 .And. Val((cArqCFO)->CFOP) <= 5699 .And. nAno >= 2004)
		FmtLin(,aL[53],,,@nLin)
		aCFO[3]	:=	"5651"
		aCFO[4]	:=	"5699"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "591" .and. substr((cArqCFO)->CFOP,1,3) <= "594" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "5901" .and. substr((cArqCFO)->CFOP,1,4) <= "5903")
		FmtLin(,aL[20],,,@nLin)
		aCFO[1]	:=	"591"
		aCFO[2]	:=	"594"
		aCFO[3]	:=	"5901"
		aCFO[4]	:=	"5903"
	ElseIf substr((cArqCFO)->CFOP,1,3) == "595" .and. nAno <= 2002
		FmtLin(,aL[21],,,@nLin)
		aCFO[1]	:=	"595"
		aCFO[2]	:=	"595"
		aCFO[3]	:=	"595"
		aCFO[4]	:=	"595"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "596" .and. substr((cArqCFO)->CFOP,1,3) <= "599" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "5904" .and. substr((cArqCFO)->CFOP,1,4) <= "5933")
		FmtLin(,aL[22],,,@nLin)
		aCFO[1]	:=	"596"
		aCFO[2]	:=	"599"
		aCFO[3]	:=	"5904"
		aCFO[4]	:=	"5933"
    ElseIf ALLTRIM((cArqCFO)->CFOP) == "5991"
		FmtLin(,aL[23],,,@nLin)
		aCFO[1]	:=	"5991"
		aCFO[2]	:=	"5991"
		aCFO[3]	:=	"5991"
		aCFO[4]	:=	"5991"
    ElseIf (ALLTRIM((cArqCFO)->CFOP) == "5999").OR.;
	   (substr((cArqCFO)->CFOP,1,4) == "5949" )
		FmtLin(,aL[24],,,@nLin)
		aCFO[1]	:=	"5999"
		aCFO[2]	:=	"5999"
		aCFO[3]	:=	"5949"
		aCFO[4]	:=	"5949"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "611" .and. substr((cArqCFO)->CFOP,1,3) <= "619" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "6101" .and. substr((cArqCFO)->CFOP,1,4) <= "6125")
		FmtLin(,aL[26],,,@nLin)
		aCFO[1]	:=	"611"
		aCFO[2]	:=	"619"
		aCFO[3]	:=	"6101"
		aCFO[4]	:=	"6125"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "621" .and. substr((cArqCFO)->CFOP,1,3) <= "626" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "6151" .and. substr((cArqCFO)->CFOP,1,4) <= "6156")
		FmtLin(,aL[27],,,@nLin)
		aCFO[1]	:=	"621"
		aCFO[2]	:=	"626"
		aCFO[3]	:=	"6151"
		aCFO[4]	:=	"6156"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "631" .and. substr((cArqCFO)->CFOP,1,3) <= "634" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "6201" .and. substr((cArqCFO)->CFOP,1,4) <= "6210")
		FmtLin(,aL[28],,,@nLin)
		aCFO[1]	:=	"631"
		aCFO[2]	:=	"634"
		aCFO[3]	:=	"6201"
		aCFO[4]	:=	"6210"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "641" .and. substr((cArqCFO)->CFOP,1,3) <= "645" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "6251" .and. substr((cArqCFO)->CFOP,1,4) <= "6258")
		FmtLin(,aL[29],,,@nLin)
		aCFO[1]	:=	"641"
		aCFO[2]	:=	"645"
		aCFO[3]	:=	"6251"
		aCFO[4]	:=	"6258"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "651" .and. substr((cArqCFO)->CFOP,1,3) <= "653" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "6301" .and. substr((cArqCFO)->CFOP,1,4) <= "6307")
		FmtLin(,aL[30],,,@nLin)
		aCFO[1]	:=	"651"
		aCFO[2]	:=	"653"
		aCFO[3]	:=	"6301"
		aCFO[4]	:=	"6307"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "661" .and. substr((cArqCFO)->CFOP,1,3) <= "663" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "6351" .and. substr((cArqCFO)->CFOP,1,4) <= "6359")
		FmtLin(,aL[31],,,@nLin)
		aCFO[1]	:=	"661"
		aCFO[2]	:=	"663"
		aCFO[3]	:=	"6351"
		aCFO[4]	:=	"6359"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "671" .and. substr((cArqCFO)->CFOP,1,3) <= "679" .and. nAno <= 2002).OR.;
	   (VAl((cArqCFO)->CFOP) >= 6401 .and. Val((cArqCFO)->CFOP) <= 6449)
		FmtLin(,aL[32],,,@nLin)
		aCFO[1]	:=	"671"
		aCFO[2]	:=	"679"
		aCFO[3]	:=	"6401"
		aCFO[4]	:=	"6449"
    ElseIf TRIM((cArqCFO)->CFOP) == "686" .and. nAno <= 2002.OR.;
	   (substr((cArqCFO)->CFOP,1,4) == "6501")
		FmtLin(,aL[33],,,@nLin)
		aCFO[1]	:=	"686"
		aCFO[2]	:=	"686"
		aCFO[3]	:=	"6501"
		aCFO[4]	:=	"6501"  
	ElseIf (Val((cArqCFO)->CFOP) >= 6651 .And. Val((cArqCFO)->CFOP) <= 6699 .And. nAno >= 2004)
		FmtLin(,aL[54],,,@nLin)
		aCFO[3]	:=	"6651"
		aCFO[4]	:=	"6699"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "691" .and. substr((cArqCFO)->CFOP,1,3) <= "694" .and. nAno <= 2002 .OR.;
	   (substr((cArqCFO)->CFOP,1,4)) >= "6901" .and. substr((cArqCFO)->CFOP,1,4) <= "6903")
		FmtLin(,aL[34],,,@nLin)
		aCFO[1]	:=	"691"
		aCFO[2]	:=	"694"
		aCFO[3]	:=	"6901"
		aCFO[4]	:=	"6903"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "696" .and. substr((cArqCFO)->CFOP,1,3) <= "699" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "6904" .and. substr((cArqCFO)->CFOP,1,4) <= "6933")
		FmtLin(,aL[35],,,@nLin)
		aCFO[1]	:=	"696"
		aCFO[2]	:=	"699"
		aCFO[3]	:=	"6904"
		aCFO[4]	:=	"6933"
	ElseIf (substr((cArqCFO)->CFOP,1,3) == "695" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) == "6553")
		FmtLin(,aL[36],,,@nLin)
		aCFO[1]	:=	"695"
		aCFO[2]	:=	"695"
		aCFO[3]	:=	"6553"
		aCFO[4]	:=	"6553"
    ElseIf TRIM((cArqCFO)->CFOP) == "6991"
		FmtLin(,aL[37],,,@nLin)
		aCFO[1]	:=	"6991"
		aCFO[2]	:=	"6991"
		aCFO[3]	:=	"6991"
		aCFO[4]	:=	"6991"
    ElseIf (TRIM((cArqCFO)->CFOP) == "6999").OR.;
	   (substr((cArqCFO)->CFOP,1,4) == "6949")
		FmtLin(,aL[38],,,@nLin)
		aCFO[1]	:=	"6999"
		aCFO[2]	:=	"6999"
		aCFO[3]	:=	"6949"
		aCFO[4]	:=	"6949"
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "711" .and. substr((cArqCFO)->CFOP,1,3) <= "717" .and. nAno <= 2002) .Or.;
	   (substr((cArqCFO)->CFOP,1,4) >= "7101" .and. substr((cArqCFO)->CFOP,1,4) <= "7127")
		FmtLin(,aL[40],,,@nLin)
		aCFO[1]	:=	"711"
		aCFO[2]	:=	"717"
		aCFO[3]	:=	"7101"
		aCFO[4]	:=	"7127"
	ElseIf (substr((cArqCFO)->CFOP,1,4)$"/7251/7551/")
		FmtLin(,aL[52],,,@nLin)
		aCFO[1]	:=	"7251"
		aCFO[2]	:=	"7251"
		aCFO[3]	:=	"7551"
		aCFO[4]	:=	"7551"	   
	ElseIf (substr((cArqCFO)->CFOP,1,3) >= "731" .and. substr((cArqCFO)->CFOP,1,3) <= "734" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) >= "7201" .and. substr((cArqCFO)->CFOP,1,4) <= "7211") 	  
		FmtLin(,aL[41],,,@nLin)
		aCFO[1]	:=	"731"
		aCFO[2]	:=	"734"
		aCFO[3]	:=	"7201"
		aCFO[4]	:=	"7211"
	ElseIf (substr((cArqCFO)->CFOP,1,4)$"7553")
		FmtLin(,aL[41],,,@nLin)
		//aCFO[1]	:=	"7553"
		//aCFO[2]	:=	"7553"
		aCFO[3]	:=	"7553"
		aCFO[4]	:=	"7553"
	ElseIf (substr((cArqCFO)->CFOP,1,4)$"7556")
		FmtLin(,aL[41],,,@nLin)
		//aCFO[1]	:=	"7553"
		//aCFO[2]	:=	"7553"
		aCFO[3]	:=	"7556"
		aCFO[4]	:=	"7556"
	ElseIf substr((cArqCFO)->CFOP,1,3) == "741" .and. nAno <= 2002
		FmtLin(,aL[42],,,@nLin)
		aCFO[1]	:=	"741"
		aCFO[2]	:=	"741"
		aCFO[3]	:=	"741"
		aCFO[4]	:=	"741"
	ElseIf (substr((cArqCFO)->CFOP,1,3) == "751" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) == "7301")
		FmtLin(,aL[43],,,@nLin)
		aCFO[1]	:=	"751"
		aCFO[2]	:=	"751"
		aCFO[3]	:=	"7301"
		aCFO[4]	:=	"7301"
	ElseIf (substr((cArqCFO)->CFOP,1,3) == "761" .and. nAno <= 2002).OR.;
	   (substr((cArqCFO)->CFOP,1,4) == "7358")
		FmtLin(,aL[44],,,@nLin)
		aCFO[1]	:=	"761"
		aCFO[2]	:=	"761"
		aCFO[3]	:=	"7358"
		aCFO[4]	:=	"7358"
	ElseIf substr((cArqCFO)->CFOP,1,3) == "799" .and. nAno <= 2002
		FmtLin(,aL[45],,,@nLin)
		aCFO[1]	:=	"799"
		aCFO[2]	:=	"799"
		aCFO[3]	:=	"799"
		aCFO[4]	:=	"799"
    ElseIf TRIM((cArqCFO)->CFOP) == "7991"
		FmtLin(,aL[46],,,@nLin)
		aCFO[1]	:=	"7991"
		aCFO[2]	:=	"7991"
		aCFO[3]	:=	"7991"
		aCFO[4]	:=	"7991"
    ElseIf TRIM((cArqCFO)->CFOP) == "7999"
		FmtLin(,aL[47],,,@nLin)
		aCFO[1]	:=	"7999"
		aCFO[2]	:=	"7999"
		aCFO[3]	:=	"7999"
		aCFO[4]	:=	"7999"
	Else
		cTexto :=""
		If SX5->(DbSeek(xFilial("SX5")+"13"+(cArqCFO)->CFOP))
           cTexto := SUBS(SX5->X5_DESCRI,1,40)
        Endif   
        FmtLin({cTexto,(cArqCFO)->CFOP},aL[51],,,@nLin)
		aCFO[1]	:=	(cArqCFO)->CFOP
		aCFO[2]	:=	(cArqCFO)->CFOP
		aCFO[3]	:=	(cArqCFO)->CFOP
		aCFO[4]	:=	(cArqCFO)->CFOP
	Endif
	FmtLin(,aL[49],,,@nLin)

	while	!eof().and. (AllTrim((cArqCFO)->CFOP) >= AllTrim(aCFO[1]) .AND. AllTrim((cArqCFO)->CFOP) <= AllTrim(aCFO[2]) .And. nAno <= 2002) .Or. ;
						(AllTrim((cArqCFO)->CFOP) >= AllTrim(aCFO[3]) .AND. AllTrim((cArqCFO)->CFOP) <= AllTrim(aCFO[4]))

		aDados   	:= If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
							(cVValid == "0710" .and. cVLayOut == "0201") .or.;
							(cVValid == "0720" .and. cVLayOut == "0202") .or.;
							(cVValid == "0730" .and. cVLayOut == "0203") .or.;
							(cVValid == "0740" .and. cVLayOut == "0204") .or.;
							(cVValid == "0750" .and. cVLayOut == "0205") .or.;
							(cVValid == "0760" .and. cVLayOut == "0206") .or.;
							(cVValid == "0770" .and. cVLayOut == "0207") .or.;
							(cVValid == "0780" .and. cVLayOut == "0208") .or.;
                            (cVValid == "0790" .and. cVLayOut == "0209") .or.;
                            (cVValid == "0800" .and. cVLayOut == "0210"),array(10),Array(8))
							
        aDados[1]   :=  Transform((cArqCFO)->CFOP,PESQPICT("SF3","F3_CFO"))           //CFOP
		aDados[2]	:=	(cArqCFO)->VALCONT		//Valor Contabil    
		aDados[3]	:=	(cArqCFO)->BASEICM		//Base de Calculo
		aDados[4]	:=	(cArqCFO)->VALTRIB		//Imposto Debitado
		aDados[5]	:=	(cArqCFO)->ISENTA		//Isentas/Nao Tributadas
		aDados[6]	:=	(cArqCFO)->OUTRAS		//Outras           
		aDados[7]	:=	(cArqCFO)->RETIDO		//Imposto Retido

		If (cVValid == "0700" .and. cVLayOut == "0200") .or.;
			(cVValid == "0710" .and. cVLayOut == "0201") .or.;
			(cVValid == "0720" .and. cVLayOut == "0202") .or.;
			(cVValid == "0730" .and. cVLayOut == "0203") .or.;
			(cVValid == "0740" .and. cVLayOut == "0204") .or.;
			(cVValid == "0750" .and. cVLayOut == "0205") .or.;
			(cVValid == "0760" .and. cVLayOut == "0206") .or.;
			(cVValid == "0770" .and. cVLayOut == "0207") .or.;
			(cVValid == "0780" .and. cVLayOut == "0208") .or.;               
			(cVValid == "0790" .and. cVLayOut == "0209") .or.;
			(cVValid == "0800" .and. cVLayOut == "0210")
			
			aDados[8]	:=	(cArqCFO)->RtStSt
			aDados[9]	:=	(cArqCFO)->RtSbSt
			aDados[10]	:=	(cArqCFO)->IMPOSTO		//Outros Impostos     
			nTDebSt		+=	(cArqCFO)->RtStSt
		Else			
			aDados[8]	:=	(cArqCFO)->IMPOSTO		//Outros Impostos     
			nTDebSt		+=	(cArqCFO)->RETIDO	
		Endif	
		nTotDeb		+=	(cArqCFO)->VALTRIB


	   atotais[1]	+=	(cArqCFO)->VALCONT
	   atotais[2]	+=	(cArqCFO)->BASEICM
	   atotais[3]	+=	(cArqCFO)->VALTRIB
	   atotais[4]	+=	(cArqCFO)->ISENTA 
	   atotais[5]	+=	(cArqCFO)->OUTRAS 
	   atotais[6]	+=	(cArqCFO)->RETIDO 

	   	If (cVValid == "0700" .and. cVLayOut == "0200") .or.;
	   		(cVValid == "0710" .and. cVLayOut == "0201") .or.;
	   		(cVValid == "0720" .and. cVLayOut == "0202") .or.;
	   		(cVValid == "0730" .and. cVLayOut == "0203") .or.;
	   		(cVValid == "0740" .and. cVLayOut == "0204") .or.;
	   		(cVValid == "0750" .and. cVLayOut == "0205") .or.;
	   		(cVValid == "0760" .and. cVLayOut == "0206") .or.;
	   		(cVValid == "0770" .and. cVLayOut == "0207") .or.;
	   		(cVValid == "0780" .and. cVLayOut == "0208") .or.;
	   		(cVValid == "0790" .and. cVLayOut == "0209") .or.;
	   		(cVValid == "0800" .and. cVLayOut == "0210")
	   		
			atotais[7]	+=	(cArqCFO)->RtStSt
			atotais[8]	+=	(cArqCFO)->RtSbSt
			atotais[9]	+=	(cArqCFO)->IMPOSTO		//Outros Impostos     
		Else
	   		atotais[7]	+=	(cArqCFO)->IMPOSTO
	   	EndIf
		FmtLin(@aDados,aL[48],cPictVal,,@nLin)
		dbSkip()
	EndDo	
	FmtLin(,aL[49],,,@nLin)
End

FmtLin(@aTotais,aL[50],cPictVal,,@nLin)

FmtLin(,aL[5],,,@nLin)

dbSelectArea(cAlias)
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFuncao    ³R972UFEnt ºAutor  ³Andreia dos Santos  º Data ³  28/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Imprime detalhamento das operacoes de entrada interestaduaisº±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ MATR972      CR=14                                         º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Function R972UFEnt                       
Local cAlias	:= Alias()
Local cEstado	:= ""
Local aTotais	:= {}
Local cUF		:= ""

aTotais	:= If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
				(cVValid == "0710" .and. cVLayOut == "0201") .or.;
				(cVValid == "0720" .and. cVLayOut == "0202") .or.;
				(cVValid == "0730" .and. cVLayOut == "0203") .or.;
				(cVValid == "0740" .and. cVLayOut == "0204") .or.;
				(cVValid == "0750" .and. cVLayOut == "0205") .or.;
				(cVValid == "0760" .and. cVLayOut == "0206") .or.;
				(cVValid == "0770" .and. cVLayOut == "0207") .or.;
				(cVValid == "0780" .and. cVLayOut == "0208") .or.;
				(cVValid == "0790" .and. cVLayOut == "0209") .or.;
				(cVValid == "0800" .and. cVLayOut == "0210"),array(6),array(5))

nLin	:=	80
cCfo	:=	""
lFirst:=	.T.
                           
afill(aTotais,0)

R972LayOut(1)
R972Contr()

R972LayOut(If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
			 (cVValid == "0710" .and. cVLayOut == "0201") .or.;
			 (cVValid == "0720" .and. cVLayOut == "0202") .or.;
			 (cVValid == "0730" .and. cVLayOut == "0203") .or.;
			 (cVValid == "0740" .and. cVLayOut == "0204") .or.;
			 (cVValid == "0750" .and. cVLayOut == "0205") .or.;
			 (cVValid == "0760" .and. cVLayOut == "0206") .or.;
			 (cVValid == "0770" .and. cVLayOut == "0207") .or.;
			 (cVValid == "0780" .and. cVLayOut == "0208") .or.;
			 (cVValid == "0790" .and. cVLayOut == "0209") .or.;
			 (cVValid == "0800" .and. cVLayOut == "0210"),4,9))
			 
nLin++
FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6],aL[7],aL[8],aL[9],aL[10],aL[11],aL[12]},,,@nLin)

dbSelectArea(cArqInt)
dbSeek("1",.t.)
While !eof() .and. substr((cArqInt)->CFOP,1,1) < '5'

	If Interrupcao(@lAbortPrint)
		Exit
	Endif
	// 
	cCFO	:=	alltrim((cArqInt)->CFOP)
	lFirst:= .T.
    While !eof() .and. alltrim((cArqInt)->CFOP) == cCFO
        If nLin>55
	        FmtLin(,aL[13],,,@nLin)
			cabec(titulo,cabec1,cabec2,nomeprog,tamanho,nTipo)
			nLin:=PROW()+1
			FmtLin({Replic("*",limite)},"#",,,@nLin)
			nLin:=nLin+1
			FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6],aL[7],aL[8],aL[9],aL[10],aL[11],aL[12]},,,@nLin)
		Endif
		cUF			:= R972Estado((cArqInt)->UF)
		cEstado		:= if( SX5->(dbSeek(xFilial("SX5")+"12"+cUF)),alltrim(SX5->X5_DESCRI),"")

		aDados		:=	If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
							(cVValid == "0710" .and. cVLayOut == "0201") .or.;
							(cVValid == "0720" .and. cVLayOut == "0202") .or.;
							(cVValid == "0730" .and. cVLayOut == "0203") .or.;
							(cVValid == "0740" .and. cVLayOut == "0204") .or.;
							(cVValid == "0750" .and. cVLayOut == "0205") .or.;
							(cVValid == "0760" .and. cVLayOut == "0206") .or.;
							(cVValid == "0770" .and. cVLayOut == "0207") .or.;
							(cVValid == "0780" .and. cVLayOut == "0208") .or.;
							(cVValid == "0790" .and. cVLayOut == "0209") .or.;
							(cVValid == "0800" .and. cVLayOut == "0210"),Array(8),Array(7))

        aDados[1]   :=  if(lFirst,Transform((cArqInt)->CFOP,PESQPICT("SF3","F3_CFO")),"") //CFOP
		aDados[2]	:=	(cArqInt)->UF+"."+cEstado								//UF
		aDados[3]	:=	(cArqInt)->VALCONT										//Valor Contabil
		aDados[4]	:=	(cArqInt)->BASECON										//Base de Calculo

		If (cVValid == "0700" .and. cVLayOut == "0200") .or.;
			(cVValid == "0710" .and. cVLayOut == "0201") .or.;
			(cVValid == "0720" .and. cVLayOut == "0202") .or.;
			(cVValid == "0730" .and. cVLayOut == "0203") .or.;
			(cVValid == "0740" .and. cVLayOut == "0204") .or.;
			(cVValid == "0750" .and. cVLayOut == "0205") .or.;
			(cVValid == "0760" .and. cVLayOut == "0206") .or.;
			(cVValid == "0770" .and. cVLayOut == "0207") .or.;
			(cVValid == "0780" .and. cVLayOut == "0208") .or.;    
			(cVValid == "0790" .and. cVLayOut == "0209") .or.;
			(cVValid == "0800" .and. cVLayOut == "0210")

			aDados[5]   :=  (cArqInt)->IMPOSTO                                  //IMPOSTO
			aDados[6]	:=	(cArqInt)->OUTRAS									//Outras
			aDados[7]	:=	(cArqInt)->PETROL									//Petroleo/Energia
			aDados[8]	:=	(cArqInt)->OUTPROD									//Outros Produtos
        Else
			aDados[5]	:=	(cArqInt)->OUTRAS									//Outras
			aDados[6]	:=	(cArqInt)->PETROL									//Petroleo/Energia
			aDados[7]	:=	(cArqInt)->OUTPROD									//Outros Produtos        	
        Endif
		aTotais[1]	+=	(cArqInt)->VALCONT										//Valor Contabil
		aTotais[2]	+=	(cArqInt)->BASECON										//Base de Calculo

		If (cVValid == "0700" .and. cVLayOut == "0200") .or.;
			(cVValid == "0710" .and. cVLayOut == "0201") .or.;
			(cVValid == "0720" .and. cVLayOut == "0202") .or.;
			(cVValid == "0730" .and. cVLayOut == "0203") .or.;
			(cVValid == "0740" .and. cVLayOut == "0204") .or.;
			(cVValid == "0750" .and. cVLayOut == "0205") .or.;
			(cVValid == "0760" .and. cVLayOut == "0206") .or.;
			(cVValid == "0770" .and. cVLayOut == "0207") .or.;
			(cVValid == "0780" .and. cVLayOut == "0208") .or.;
			(cVValid == "0790" .and. cVLayOut == "0209") .or.;
			(cVValid == "0800" .and. cVLayOut == "0210")

			aTotais[3]	+=	(cArqInt)->IMPOSTO                                     //Imposto
			aTotais[4]	+=	(cArqInt)->OUTRAS										//Outras
			aTotais[5]	+=	(cArqInt)->PETROL										//Petroleo/Energia
			aTotais[6]	+=	(cArqInt)->OUTPROD										//Outros Produtos
        Else
			aTotais[3]	+=	(cArqInt)->OUTRAS										//Outras
			aTotais[4]	+=	(cArqInt)->PETROL										//Petroleo/Energia
			aTotais[5]	+=	(cArqInt)->OUTPROD										//Outros Produtos
        EndIf
		FmtLin(@aDados,aL[14],cPictVal,,@nLin)
		lFirst	:= .F.
		dbSkip()
	EndDo	
	FmtLin(,aL[13],,,@nLin)
End

FmtLin(@aTotais,aL[15],cPictVal,,@nLin)

FmtLin(,aL[8],,,@nLin)

dbSelectArea(cAlias)

return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFuncao    ³R972UFSai ºAutor  ³Andreia dos Santos  º Data ³  28/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Imprime detalhamento das operacoes interestaduais de saida  º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP5                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Function R972UFSai                       
Local cAlias	:= Alias()
Local aTotais	:= {}
Local cCfo	:=	""
Local lFirst:=	.T.
Local cUF		:= ""

aTotais	:= If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
				(cVValid == "0710" .and. cVLayOut == "0201") .or.;
				(cVValid == "0720" .and. cVLayOut == "0202") .or.;
				(cVValid == "0730" .and. cVLayOut == "0203") .or.;
				(cVValid == "0740" .and. cVLayOut == "0204") .or.;
				(cVValid == "0750" .and. cVLayOut == "0205") .or.;
				(cVValid == "0760" .and. cVLayOut == "0206") .or.;
				(cVValid == "0770" .and. cVLayOut == "0207") .or.;
				(cVValid == "0780" .and. cVLayOut == "0208") .or.;
				(cVValid == "0790" .and. cVLayOut == "0209") .or.;
				(cVValid == "0800" .and. cVLayOut == "0210"),array(8),array(7))

nLin	:=	80

afill(aTotais,0)
R972LayOut(1)
R972Contr()

R972LayOut(If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
			(cVValid == "0710" .and. cVLayOut == "0201") .or.;
			(cVValid == "0720" .and. cVLayOut == "0202") .or.;
			(cVValid == "0730" .and. cVLayOut == "0203") .or.;
			(cVValid == "0740" .and. cVLayOut == "0204") .or.;
			(cVValid == "0750" .and. cVLayOut == "0205") .or.;
			(cVValid == "0760" .and. cVLayOut == "0206") .or.;
			(cVValid == "0770" .and. cVLayOut == "0207").or.;
			(cVValid == "0780" .and. cVLayOut == "0208") .or.;
			(cVValid == "0790" .and. cVLayOut == "0209") .or.;
			(cVValid == "0800" .and. cVLayOut == "0210"),10,5))

nLin++
FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6],aL[7],aL[8],aL[9],aL[10],aL[11],aL[12]},,,@nLin)

dbSelectArea(cArqInt)
dbSeek("5",.t.)
While !eof() .and. substr((cArqInt)->CFOP,1,1) >='5'

	If Interrupcao(@lAbortPrint)
		Exit
	Endif
	//
	cCFO	:=	alltrim((cArqInt)->CFOP)
	lFirst:= .T.
    While !eof() .and. alltrim((cArqInt)->CFOP) == cCFO
        If nLin>55
	        FmtLin(,aL[13],,,@nLin)
			cabec(titulo,cabec1,cabec2,nomeprog,tamanho,nTipo)
			nLin:=PROW()+1
			FmtLin({Replic("*",limite)},"#",,,@nLin)
			nLin:=nLin+1
			FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6],aL[7],aL[8],aL[9],aL[10],aL[11],aL[12]},,,@nLin)
		Endif 
		cUF			:= R972Estado((cArqInt)->UF)
		cEstado		:= if( SX5->(dbSeek(xFilial("SX5")+"12"+cUF)),alltrim(SX5->X5_DESCRI),"")

		aDados		:=	If((cVValid == "0700" .and. cVLayOut == "0200") .or.;
							(cVValid == "0710" .and. cVLayOut == "0201") .or.;
							(cVValid == "0720" .and. cVLayOut == "0202") .or.;
							(cVValid == "0730" .and. cVLayOut == "0203") .or.;
							(cVValid == "0740" .and. cVLayOut == "0204") .or.;
							(cVValid == "0750" .and. cVLayOut == "0205") .or.;
							(cVValid == "0760" .and. cVLayOut == "0206") .or.;
							(cVValid == "0770" .and. cVLayOut == "0207") .or.;
							(cVValid == "0780" .and. cVLayOut == "0208") .or.;
							(cVValid == "0790" .and. cVLayOut == "0209") .or.;
							(cVValid == "0800" .and. cVLayOut == "0210"),Array(10),Array(9))

        aDados[1]   :=  if(lFirst,Transform((cArqInt)->CFOP,PESQPICT("SF3","F3_CFO")),"") //CFOP
		aDados[2]	:=	(cArqInt)->UF+"."+cEstado								//	UF
		aDados[3]	:=	(cArqInt)->VALNCON										//Valor Contabil nao contribuinte
		aDados[4]	:=	(cArqInt)->VALCONT										//Valor Contabil Contribuinte 
		aDados[5]	:=	(cArqInt)->BASENCO										//Base de Calculo nao contribuinte
		aDados[6]	:=	(cArqInt)->BASECON										//Base de Calculo Contribuinte
        aDados[7]	:=	(cArqInt)->ISENTA										//Isentas/nao tributadas

        If (cVValid == "0700" .and. cVLayOut == "0200") .or.;
        	(cVValid == "0710" .and. cVLayOut == "0201") .or.;
        	(cVValid == "0720" .and. cVLayOut == "0202") .or.;
        	(cVValid == "0730" .and. cVLayOut == "0203") .or.;
        	(cVValid == "0740" .and. cVLayOut == "0204") .or.;
        	(cVValid == "0750" .and. cVLayOut == "0205") .or.;
        	(cVValid == "0760" .and. cVLayOut == "0206") .or.;
        	(cVValid == "0770" .and. cVLayOut == "0207") .or.;
        	(cVValid == "0780" .and. cVLayOut == "0208") .or.;
        	(cVValid == "0790" .and. cVLayOut == "0209") .or.;
        	(cVValid == "0800" .and. cVLayOut == "0210")

			aDados[8]	:=	(cArqInt)->IMPOSTO										//IMPOSTO
			aDados[9]	:=	(cArqInt)->OUTRAS										//Outras
			aDados[10]	:=	(cArqInt)->RETIDO										//ICMS Cobrado por subst. Tributaria
		Else
	    	aDados[8]	:=	(cArqInt)->OUTRAS										//Outras
			aDados[9]	:=	(cArqInt)->RETIDO										//ICMS Cobrado por subst. Tributaria
		EndIf	
      	lFirst		:= .F.

		aTotais[1]	+=	(cArqInt)->VALNCON										//Valor Contabil nao contribuinte
		aTotais[2]	+=	(cArqInt)->VALCONT										//Valor Contabil Contribuinte 
		aTotais[3]	+=	(cArqInt)->BASENCO										//Base de Calculo nao contribuinte
		aTotais[4]	+=	(cArqInt)->BASECON
		aTotais[5]	+=	(cArqInt)->ISENTA

		If (cVValid == "0700" .and. cVLayOut == "0200") .or.;
			(cVValid == "0710" .and. cVLayOut == "0201") .or.;
			(cVValid == "0720" .and. cVLayOut == "0202") .or.;
			(cVValid == "0730" .and. cVLayOut == "0203") .or.;
			(cVValid == "0740" .and. cVLayOut == "0204") .or.;
			(cVValid == "0750" .and. cVLayOut == "0205") .or.;
			(cVValid == "0760" .and. cVLayOut == "0206") .or.;
			(cVValid == "0770" .and. cVLayOut == "0207") .or.;
			(cVValid == "0780" .and. cVLayOut == "0208") .or.;
            (cVValid == "0790" .and. cVLayOut == "0209") .or.;
            (cVValid == "0800" .and. cVLayOut == "0210")             

			aTotais[6]	+=	(cArqInt)->IMPOSTO
			aTotais[7]	+=	(cArqInt)->OUTRAS										//Outras
			aTotais[8]	+=	(cArqInt)->RETIDO										//ICMS Cobrado por subst. Tributaria
        Else
            aTotais[6]	+=	(cArqInt)->OUTRAS										//Outras
			aTotais[7]	+=	(cArqInt)->RETIDO										//ICMS Cobrado por subst. Tributaria                     				
		EndIF

		FmtLin(@aDados,aL[14],cPictVal,,@nLin)
		dbSkip()
	EndDo	
	FmtLin(,aL[13],,,@nLin)
End

FmtLin(@aTotais,aL[15],cPictVal,,@nLin)
FmtLin(,aL[8],,,@nLin)

dbSelectArea(cAlias)

return
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFunction  ³R972ZFM   ºAutor  ³Microsiga           º Data ³  07/28/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Imprime Operacoes de saida para ZFM/ALC                     º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP5                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Function R972ZFM
Local cAlias	:= Alias()
Local cCfop		:= ""
Local lFirst	:= .T.
Local nTotal	:= 0
Local nTotGer	:= 0
nLin	:=	80

R972LayOut(1)
R972Contr()

R972LayOut(6)
nLin++
FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6]},,,@nLin)

dbSelectArea(cArqZFM)
dbGoTop()
While !eof()

	If Interrupcao(@lAbortPrint)
		Exit
	Endif
	// 
	cCfop	:= alltrim((cArqZFM)->CFOP)
	lFirst:= .T.
    While !eof() .and.  alltrim((cArqZFM)->CFOP) == cCfop
        If nLin>55
			FmtLin(,aL[11],,,@nLin)
			cabec(titulo,cabec1,cabec2,nomeprog,tamanho,nTipo)
			nLin:=PROW()+1
			FmtLin({Replic("*",limite)},"#",,,@nLin)
			nLin:=nLin+1
			FmtLin(,{aL[1],aL[2],aL[3],aL[4],aL[5],aL[6]},,,@nLin)
		Endif
		aDados:=Array(6)
        aDados[1]   :=  if(lFirst,Transform((cArqZFM)->CFOP,PESQPICT("SF3","F3_CFO")),"") //CFOP
		aDados[2]	:=	(cArqZFM)->EMISSAO					//Emissao
		aDados[3]	:=	(cArqZFM)->NFISCAL					//Numero da NF
		aDados[4]	:=	(cArqZFM)->VALOR	 					//Valor da NF
		aDados[5]	:=	Transform((cArqZFM)->CNPJDES,"@R 99.999.999/9999-99")//CNPJ do destinatario
		aDados[6]	:=	(cArqZFM)->MUNICIP					//Municipio destino
	   lFirst		:= .F.
	   nTotal		+=	(cArqZFM)->VALOR
	   nTotGer		+=	(cArqZFM)->VALOR
		FmtLin(@aDados,aL[7],cPictVal,,@nLin)
		dbSkip()          
	EndDo	
	FmtLin(,aL[11],,,@nLin)
	FmtLin({nTotal},aL[8],cPictVal,,@nLin)
	if !eof()
  		FmtLin(,aL[11],,,@nLin)
	endif
	nTotal	:= 0	
End

FmtLin(,aL[12],,,@nLin)

FmtLin({nTotGer},aL[9],cPictVal,,@nLin)

FmtLin(,aL[10],,,@nLin)

dbSelectArea(cAlias)

return


/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFunction  ³R972Apur  ºAutor  ³Andreia dos Santos  º Data ³  31/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Imprime Apuracao do ICMS - Operacoes Proprias e             º±±
±±º          ³Apuracao do ICMS - Substituicao Tributaria                  º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP5                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Function R972Apur(nTipo)

Local cAlias		:= Alias()
Local aTotais		:= array(11)
Local nApurado		:= 0
Local nOutrDeb		:= 0
Local nEstCred      := 0
Local nOutrCred     := 0
Local nEstDebito    := 0
Local nDeducoes      := 0
nLin	:=	80

afill(aTotais,0)
R972LayOut(1)
R972Contr()
R972LayOut(7)
nLin ++
if nTipo == 1
	FmtLin(,{aL[1],aL[2],aL[3],aL[4]},,,@nLin)
Else	
	FmtLin(,{aL[4],aL[5],aL[6],aL[7]},,,@nLin)
Endif

If nLin>55
	cabec(titulo,cabec1,cabec2,nomeprog,tamanho,nTipo)
	nLin:=PROW()+1
	FmtLin({Replic("*",limite)},"#",,,@nLin)
	nLin ++
	if nTipo == 1
		FmtLin(,{aL[1],aL[2],aL[3],aL[4]},,,@nLin)
	Else	
		FmtLin(,{aL[4],aL[5],aL[6],aL[7]},,,@nLin)
	Endif
Endif                                   
if nTipo == 1
	nOutrDeb		:= aApuracao[2]				//outros debitos
	nEstCred      	:= aApuracao[3]				//estorno Creditos
	nOutrCred     	:= aApuracao[6]				//Outros Creditos
	nEstDebito    	:= aApuracao[7]				//Estorno Debitos
 	nDeducoes      	:= aApuracao[12]				//Deducoes
	aTotais[1]		:=	nTotDeb						///Saidas
	aTotais[2]		:=	nTotCred					//Entradas
	aTotais[3]		:=	nSaldPer					//Saldo Credor do Periodo anterior
	aTotais[4]		:=	nTotDeb+nOutrDeb+nEstCred	//Total Debito
	aTotais[5]		:=	nTotCred+nOutrCred+nEstdebito//Sub-Total Credito
	aTotais[6]		:=	aTotais[5]+nSaldPer			//Total Credito	
else
	aTotais[1]		:=	nTDebST						//Saidas
	aTotais[2]		:=	nTCredST						//Entradas
	aTotais[3]		:=	nSaldoST						//Saldo Credor do Periodo anterior
	aTotais[4]		:=	nTDebST 						//Total Debito
	aTotais[5]		:=	nTCredST						//Sub-Total Credito
	aTotais[6]		:=	nTCredST+nSaldoST			//Total Credito	
Endif

nApurado 		:= aTotais[4]-aTotais[6] //Total Debito - Total Credito

if nApurado <= 0
	aTotais[7]		:=	0 					//Saldo Devedor
	aTotais[8]		:=	0					//Imposto a Recolher
	aTotais[9]		:=	abs(nApurado)	//Saldo Credor a Transportar
Else
	aTotais[7]		:=	nApurado				//Saldo Devedor
	aTotais[8]		:=	nApurado-nDeducoes		//Imposto a Recolher
	aTotais[9]		:=	0						//Saldo Credor a Transportar
Endif

if nTipo == 1 .and. nRegime == 2
	aTotais[11]	:=	nICMSFIX -aTotais[7] // Fixado a maior             
endIf
FmtLin(,aL[08],,,@nLin) 
FmtLin(,aL[09],,,@nLin) 
FmtLin(,aL[10],,,@nLin) 
FmtLin({aTotais[01]},aL[11],cPictVal,,@nLin)           		//	001 | Por sa¡das com d‚bito do imposto
FmtLin(,aL[12],,,@nLin)													// 002 | Outros d‚bitos         
FmtLin({nOutrDeb},aL[13],cPictVal,,@nLin)
FmtLin(,aL[14],cPictVal,,@nLin)              						//003 | Estorno de creditos
FmtLin({nEstCred},aL[15],cPictVal,,@nLin)
FmtLin(,aL[16],,,@nLin)
FmtLin({aTotais[04]},aL[17],cPictVal,,@nLin)            		//005 | SUBTOTAL-DEBITO( 051+052+053)
FmtLin(,aL[18],cPictVal,,@nLin)
FmtLin(,aL[19],,,@nLin)
FmtLin(,aL[20],,,@nLin)
FmtLin({aTotais[02]},aL[21],cPictVal,,@nLin)      				//006 | Por entradas com credito do imposto
FmtLin(,aL[22],,,@nLin)													//007 | Outros Creditos 
FmtLin({nOutrCred},aL[23],cPictVal,,@nLin)            	
FmtLin(,aL[24],,,@nLin)                   		 					//008 | Estorno de debitos
FmtLin({nEstDebito},aL[25],cPictVal,,@nLin)
FmtLin({aTotais[05]},aL[26],cPictVal,,@nLin)						// 010 | SUBTOTAL( 056+057+058)                     | 060 |##################|"
FmtLin({aTotais[03]},aL[27],cPictVal,,@nLin)						// 011 | Saldo Credor do periodo anterior           | 061 |##################|"
FmtLin(,aL[28],,,@nLin)                        			
FmtLin({aTotais[06]},aL[29],cPictVal,,@nLin)  	        		//	012 | TOTAL-CREDITO( 060+061)	
FmtLin(,aL[30],,,@nLin)                        			
FmtLin(,aL[31],,,@nLin)                        			
FmtLin(,aL[32],,,@nLin)                        			
FmtLin({aTotais[07]},aL[33],cPictVal,,@nLin)      				//013 | Saldo devedor(055-062) 			
if nTipo == 1 .and. nRegime == 2
	FmtLin({nDeducoes},aL[38],cPictVal,,@nLin)					//014 | Deducoes               			
	FmtLin({nICMSFIX},aL[39],cPictVal,,@nLin) 						//014 | ICMS Fixado p/o periodo
	FmtLin({aTotais[10],nICMSFIX},aL[40],cPictVal,,@nLin)		//014 | outras	                                                                             
else
	FmtLin({nDeducoes},aL[34],cPictVal,,@nLin)   				//014 | Deducoes               			
Endif
FmtLin({aTotais[08]},aL[35],cPictVal,,@nLin)      	  			//015 | Imposto a recolher(063-064)		
if nTipo == 1 .and. nRegime == 2
 	FmtLin({aTotais[11]},aL[41],cPictVal,,@nLin)   	  			//015 | Fixado a maior(064-063)		
	FmtLin({aTotais[10]},aL[36],cPictVal,,@nLin)   				//016 | Saldo Credor a transportar(062-055)
else
	FmtLin({aTotais[09]},aL[36],cPictVal,,@nLin)   				//016 | Saldo Credor a transportar(062-055)
Endif


FmtLin(,aL[37],,,@nLin)

dbSelectArea(cAlias)


Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFuncao  	 ³R972ESTADOºAutor  ³Andreia dos Santos  º Data ³  12/07/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Converte um codigo aceito no programa NOVA GIA da Secretariaº±±
±±º          ³da fazendapara as unidades de federacao.                    º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ matR972                                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Function R972ESTADO(cCod)
cUNIDADE := "SP"
             
Do Case
	Case cCOD == "01"
		cUnidade	:= "AC"
	Case cCOD == "02"
		cUnidade	:= "AL"
	Case cCOD == "03"
		cUnidade	:= "AP"
	Case cCOD == "04"
		cUnidade	:= "AM"
	Case cCOD == "05"
		cUnidade	:= "BA"
	Case cCOD == "06"
		cUnidade	:= "CE"
	Case cCOD == "07"
		cUnidade	:= "DF"
	Case cCOD == "08"
		cUnidade	:=	"ES"
	Case cCOD == "10"
		cUnidade	:=	"GO"
	Case cCOD == "12"
		cUnidade	:=	"MA"
	Case cCOD == "13"
		cUnidade	:=	"MT"
	Case cCOD == "28"
		cUnidade	:= "MS"
	Case cCOD == "14"
		cUnidade	:=	"MG"
	Case cCOD == "15"
		cUnidade	:=	"PA"
	Case cCOD == "16"
		cUnidade	:=	"PB"
	Case cCOD == "17"
		cUnidade	:=	"PR"
	Case cCOD == "18"
		cUnidade	:=	"PE"
	Case cCOD == "19"
		cUnidade	:=	"PI"
	Case cCOD == "22"
		cUnidade	:=	"RJ"
	Case cCOD == "20"
		cUnidade	:=	"RN"
	Case cCOD == "21"
		cUnidade	:=	"RS"
	Case cCOD == "23"
		cUnidade	:= "RO"
	Case cCOD == "24"
		cUnidade	:= "RR"
	Case cCOD == "25"
		cUnidade	:=	"SC"
	Case cCOD == "26"
		cUnidade	:=	"SP"
	Case cCOD == "27"
		cUnidade	:=	"SE"
	Case cCOD == "29"
		cUnidade	:="TO"
EndCase

Return(cUNIDADE)
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³MATA972   ºAutor  ³Gustavo G. Rueda    º Data ³  09/06/06   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Ajuste das perguntas da rotina                              º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP                                                         º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function AjustaSx1 (cPerg)
	Local	aHelpPor	:=	{}
	Local	aHelpEng	:=	{}
	Local	aHelpSpa	:=	{}	
	//
	Aadd( aHelpPor, STR0291 )	//"Informe a filial inicial no caso de pro-"
	Aadd( aHelpPor, STR0292 )	//"cessamento consolidado.                 "
	Aadd( aHelpEng, STR0291 )	//"Informe a filial inicial no caso de pro-"
	Aadd( aHelpEng, STR0292 )	//"cessamento consolidado.                 "
	Aadd( aHelpSpa, STR0291 )	//"Informe a filial inicial no caso de pro-"
	Aadd( aHelpSpa, STR0292 )	//"cessamento consolidado.                 "
	PutSx1 (cPerg,"16",STR0293,STR0293,STR0293,"mv_chp","C",2,0,0,"G","","","","","mv_par16","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)	//"Filial De"
	
	aHelpPor	:=	{}
	aHelpEng	:=	{}
	aHelpSpa	:=	{}	
	Aadd( aHelpPor, STR0294 )	//"Informe a filial final  no caso de  pro-"
	Aadd( aHelpPor, STR0292 )	//"cessamento consolidado.                 "
	Aadd( aHelpEng, STR0294 )	//"Informe a filial final  no caso de  pro-"
	Aadd( aHelpEng, STR0292 )	//"cessamento consolidado.                 "
	Aadd( aHelpSpa, STR0294 )	//"Informe a filial final  no caso de  pro-"
	Aadd( aHelpSpa, STR0292 )	//"cessamento consolidado.                 "
	PutSx1 (cPerg,"17",STR0295,STR0295,STR0295,"mv_chq","C",2,0,0,"G","","","","","mv_par17","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)	//"Filial Ate"
	
	/*-----------------------MV_PAR20--------------------------*/
	Aadd( aHelpPor, "Para notas de transferência de saldo    " )
	Aadd( aHelpPor, "entre filiais, serão consideradas notas " )
	Aadd( aHelpPor, "emitidas até o dia 9 do mês subseqüente." )
	Aadd( aHelpPor, "1 - Sim;                                 ")
	Aadd( aHelpPor, "2 - Não.                                 ")
	
	Aadd( aHelpEng, "Para notas de transferência de saldo    " )
	Aadd( aHelpEng, "entre filiais, serão consideradas notas " )
	Aadd( aHelpEng, "emitidas até o dia 9 do mês subseqüente." )
	Aadd( aHelpEng, "1 - Sim;                                 ")
	Aadd( aHelpEng, "2 - Não.                                 ")
	
	Aadd( aHelpSpa, "Para notas de transferência de saldo    " )
	Aadd( aHelpSpa, "entre filiais, serão consideradas notas " )
	Aadd( aHelpSpa, "emitidas até o dia 9 do mês subseqüente." )
	Aadd( aHelpSpa, "1 - Sim;                                 ")
	Aadd( aHelpSpa, "2 - Não.                                 ")
	
	PutSx1( cPerg,"18","NF Transf. Filiais","NF Transf. Filiais","NF Transf. Filiais","mv_chl",;
	"C",1,0,2,"C","","","","","mv_par18","Sim","Si","Yes","","Nao","No","No","","","","","","","","","",;
	aHelpPor,aHelpEng,aHelpSpa)
	
/*-----------------------MV_PAR21-------------------------*/
aHelpPor	:=	{}
aHelpEng	:=	{}
aHelpSpa	:=	{}

Aadd( aHelpPor, "Informe se deseja processar filiais." )
Aadd( aHelpPor, "Neste caso, será aberta uma janela  " )
Aadd( aHelpPor, "para informar quais filiais deseja  " )
Aadd( aHelpPor, "processar, desconsiderando as per-  " )
Aadd( aHelpPor, "guntas de filial de/ate.            " )
Aadd( aHelpEng, "Informe se deseja processar filiais." )
Aadd( aHelpEng, "Neste caso, será aberta uma janela  " )
Aadd( aHelpEng, "para informar quais filiais deseja  " )
Aadd( aHelpEng, "processar, desconsiderando as per-  " )
Aadd( aHelpEng, "guntas de filial de/ate.            " )
Aadd( aHelpSpa, "Informe se deseja processar filiais." )
Aadd( aHelpSpa, "Neste caso, será aberta uma janela  " )
Aadd( aHelpSpa, "para informar quais filiais deseja  " )
Aadd( aHelpSpa, "processar, desconsiderando as per-  " )
Aadd( aHelpSpa, "guntas de filial de/ate.            " )

PutSx1(cPerg, "19", "Seleciona filiais?", "Seleciona filiais?", "Seleciona filiais?","mv_chm",;
"N", 1, 0, 2,"C", "","","","","mv_par19", "Sim", "Si",  "Yes", "","Nao", "No", "No",;
"", "", "", "", "", "","","","",aHelpPor,aHelpEng,aHelpSpa)
Return
