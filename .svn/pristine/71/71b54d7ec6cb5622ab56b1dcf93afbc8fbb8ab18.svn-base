#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\MATR971.CH"
#line 2 "d:\totvs 11\microsiga\protheus\my projects\materiais\matr971.prw"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Dialog.ch"
#line 28 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Font.ch"
#line 29 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\PTMenu.ch"
#line 31 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Print.ch"
#line 33 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Colors.ch"
#line 35 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\Folder.ch"
#line 37 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\msobject.ch"
#line 38 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\VKey.ch"
#line 42 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\WinApi.ch"
#line 44 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\FWCommand.ch"
#line 47 "PROTHEUS.CH"
#line 1 "D:\TOTVS 11\MICROSIGA\PROTHEUS\INCLUDE\FWCSS.CH"
#line 50 "PROTHEUS.CH"
#line 27 "d:\totvs 11\microsiga\protheus\my projects\materiais\matr971.prw"
Function Matr971()

Local oReport
Local aMes     	:= {}
Local aMercado	:= {}
Private nVAgrDes := 0


Private aWizCum := {}
Private aCumVlrs:= {}
Private aWizNCum:= {}
Private aNCumVlr:= {}
Private lPisFolha := Existblock("MTR971F")
Private lPisFolSN := Existblock("MTR971S")
AjustaSx1()

If FindFunction("TRepInUse") .And.  TRepInUse()



	oReport	:= ReportDef(@aMes,@aMercado)
	oReport:PrintDialog()
Else
	Matr971R3(@aMes,@aMercado)
EndIf


If mv_par11 == 2
	DACONMS(@aMes,@nVAgrDes,aWizCum,aCumVlrs,aWizNCum,aNCumVlr,aMercado)
EndIf


If Select("TMP")>0
	dbSelectArea("TMP")
	dbCloseArea()
EndIf
If Select("T01")>0
	dbSelectArea("T01")
	dbCloseArea()
EndIf

Return





















Static Function ReportDef(aMes,aMercado)

Local oReport
Local oCabec
Local oFicha6
Local oFicha7
Local oFicha8
Local oFicha9
Local oFicha10
Local oFicha6b
Local oFicha010
Local oFicha15
Local oFicha25




oReport := TReport():New("MATR971",If( cPaisLoc $ "ANG|PTG", "Dacon - Recibo De Apuro De Contribuições Sociais", "DACON - Demonstrativo de Apuração de Contribuições Sociais" ),"MTR971", {|oReport| ReportPrint(oReport,@aMes,@aMercado)},"Este relatório emite as informações necessárias "+" "+"para auxiliar o preenchimento do DACON.")
Pergunte("MTR971", .F. )




oCabec	:= TRSection():New(oReport,"Dados da Empresa/Filial",{"SM0"},{"Empresa"},,)
TRCell():New(oCabec,"M0_CGC"		,"SM0",If( cPaisLoc $ "ANG|PTG", "Nr. contribuinte.: ", "CNPJ.: " ) ,"@R 99.999.999/9999-99",20	,,)
TRCell():New(oCabec,"PERIODO"		,""	,"Periodo" ,,50,,)
TRCell():New(oCabec,"MES"			,""	,"Mes" ,,25,,)
TRCell():New(oCabec,"VALIDADOR"		,""	,"Validador" ,,26,,)




oFicha6:= TRSection():New(oReport,If( cPaisLoc $ "ANG|PTG", "Ficha 06a - Apuramento Dos Créditos De Pis/pasep – Aquisições No Mercado Interno - Regime Não Cumulativo", "Ficha 06A - Apuração dos Créditos de PIS/PASEP - Aquisições no Mercado Interno - Regime Não Cumulativo" ),{"SF3"},,,)
oFicha6:SetEdit( .F. )
TRCell():New(oFicha6,"MOVIMENTO"	,"SF3"	,If( cPaisLoc $ "ANG|PTG", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE" ) ,,100,,)
TRCell():New(oFicha6,"VAL01"		,"SF3"	,"Trib.Mer.Interno" ,,18,,)
TRCell():New(oFicha6,"VAL02"		,"SF3"	,"Não Trib.Merc.Interno" ,,21,,)
TRCell():New(oFicha6,"VAL03"		,"SF3"	,"Exportação" ,,18,,)




oFicha7:= TRSection():New(oReport,If( cPaisLoc $ "ANG|PTG", "Ficha 07a - Cálculo Da Contribuição Para O Pis/pasep - Regime Não Cumulativo", "Ficha 07A - Cálculo da Contribuição para o PIS/PASEP - Regime Não Cumulativo" ),{"SF3"},,,)
oFicha7:SetEdit( .F. )
TRCell():New(oFicha7,"MOVIMENTO"	,"SF3"	,If( cPaisLoc $ "ANG|PTG", "Apuramento da contribuição ", "APURAÇÃO DA CONTRIBUIÇÃO " ) ,,100,,)
TRCell():New(oFicha7,"VAL01"		,"SF3"	,"Receita" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha7,"VAL02"		,"SF3"	,"Base de Cálculo" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha7,"VAL03"		,"SF3"	,"Contribuição" ,"@E 99,999,999,999.99",18,,)




oFicha9:= TRSection():New(oReport,If( cPaisLoc $ "ANG|PTG", "Ficha 09a - Cálculo Da Contribuição Para O Pis/pasep - Taxas Diferenciadas", "Ficha 09A - Cálculo da Contribuição para o PIS/PASEP - Alíquotas Diferenciadas" ),{"TMP"},,,)
oFicha9:SetEdit( .F. )
TRCell():New(oFicha9,"PRODUTO"		,"TMP"	,,,55,,)
TRCell():New(oFicha9,"VAL01"		,"TMP"	,"Receita Vendas" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha9,"VAL02"		,"TMP"	,"Base Cálculo" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha9,"VAL03"		,"TMP"	,"Alíquota%" ,"@E 99.99",05,,)
TRCell():New(oFicha9,"VAL04"		,"TMP"	,"Vl.Apurado" ,"@E 99,999,999,999.99",18,,)




oFicha8:= TRSection():New(oReport,If( cPaisLoc $ "ANG|PTG", "Ficha 08a - Cálculo Da Contribuição Para O Segurança Social - Regime Cumulativo", "Ficha 08A - Cálculo da Contribuição para o PIS/Pasep - Regime Cumulativo" ),{"SE5"},,,)
oFicha8:SetEdit( .F. )
TRCell():New(oFicha8,"MOVIMENTO"	,"SE5"	,If( cPaisLoc $ "ANG|PTG", "Apuramento Da Contribuição Para O Pis/pasep", "APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP" ) ,,100,,)
TRCell():New(oFicha8,"VAL01"		,"SF3"	,"Receita" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha8,"VAL02"		,"SF3"	,"Base de Cálculo" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha8,"VAL03"		,"SF3"	,"Contribuição" ,"@E 99,999,999,999.99",18,,)




oFicha10:= TRSection():New(oReport,If( cPaisLoc $ "ANG|PTG", "Ficha 07B - Cálculo da Contribuição para o PIS/PASEP - Regime não cumulativo e cumulativo", "Ficha 07B - Cálculo da Contribuição para o PIS/PASEP - Regime Não Cumulativo e Cumulativo" ),{"SF3"},,,)
oFicha10:SetEdit( .F. )
TRCell():New(oFicha10,"MOVIMENTO"	,"SF3"	,If( cPaisLoc $ "ANG|PTG", "Apuramento Da Contribuição Para O Pis/pasep", "APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP" ) ,,100,,)
TRCell():New(oFicha10,"VAL01"		,"SF3"	,"Receita" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha10,"VAL02"		,"SF3"	,"Base de Cálculo" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha10,"VAL03"		,"SF3"	,"Contribuição" ,"@E 99,999,999,999.99",18,,)




oFicha6b:= TRSection():New(oReport,If( cPaisLoc $ "ANG|PTG", "Ficha 06B - Apuramento dos créditos de PIS/PASEP - importações - regime não cumulativo", "Ficha 06B - Apuração dos Créditos de PIS/PASEP - Importações - Regime Não Cumulativo" ),{"SF3"},,,)
oFicha6b:SetEdit( .F. )
TRCell():New(oFicha6b,"MOVIMENTO"	,"SF3"	,If( cPaisLoc $ "ANG|PTG", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE" ) ,,100,,)
TRCell():New(oFicha6b,"VAL01"		,"SF3"	,"Trib.Mer.Interno" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha6b,"VAL02"		,"SF3"	,"Não Trib.Merc.Interno" ,"@!",21,,)
TRCell():New(oFicha6b,"VAL03"		,"SF3"	,"Exportação" ,"@E 99,999,999,999.99",18,,)




oFicha010:= TRSection():New(oReport,If( cPaisLoc $ "ANG|PTG", "Ficha 10a - Cálculo da Contribuição para o Pis/Pasep - Alíquotas por Unidade de Medida", "Ficha 10a - Cálculo Da Contribuição Para O Pis/pasep - Aliquotas por Unidade de Medida" ),{"T01"},,,)
oFicha010:SetEdit( .F. )
TRCell():New(oFicha010,"PRODUTO"	,"T01"	,,,55,,)
TRCell():New(oFicha010,"VAL01"		,"T01"	,"Receita Vendas" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha010,"VAL02"		,"T01"	,"Quantidade" ,"@E 99999999.99",18,,)
TRCell():New(oFicha010,"VAL03"		,"T01"	,"Alíquota" ,"@E 99.9999",05,,)
TRCell():New(oFicha010,"VAL04"		,"T01"	,"Vl.Apurado" ,"@E 99,999,999,999.99",18,,)




oFicha15:= TRSection():New(oReport,"Ficha 15a",{"SF3"},,,)
oFicha15:SetEdit( .F. )
TRCell():New(oFicha15,"MOVIMENTO"	,"SF3"	,"CONTRIBUIÇÃO PARA PIS/PASEP - RESUMO" ,,100,,)
TRCell():New(oFicha15,"VAL01"		,"SF3"	,"Valor" ,"@E 99,999,999,999.99",18,,)




oFicha15:= TRSection():New(oReport,"Ficha 15b",{"SF3"},,,)
oFicha15:SetEdit( .F. )
TRCell():New(oFicha15,"MOVIMENTO"	,"SF3"	,"CONTRIBUIÇÃO PARA PIS/PASEP - RESUMO" ,,100,,)
TRCell():New(oFicha15,"VAL01"		,"SF3"	,"Valor" ,"@E 99,999,999,999.99",18,,)




oFicha25:= TRSection():New(oReport,"Ficha 25a",{"SF3"},,,)
oFicha25:SetEdit( .F. )
TRCell():New(oFicha25,"MOVIMENTO"	,"SF3"	,"CONTRIBUIÇÃO PARA COFINS - RESUMO" ,,100,,)
TRCell():New(oFicha25,"VAL01"		,"SF3"	,"Valor" ,"@E 99,999,999,999.99",18,,)




oFicha25:= TRSection():New(oReport,"Ficha 25b",{"SF3"},,,)
oFicha25:SetEdit( .F. )
TRCell():New(oFicha25,"MOVIMENTO"	,"SF3"	,"CONTRIBUIÇÃO PARA COFINS - RESUMO" ,,100,,)
TRCell():New(oFicha25,"VAL01"		,"SF3"	,"Valor" ,"@E 99,999,999,999.99",18,,)




oFicha013:= TRSection():New(oReport,"Ficha 11 - Controle do Diferimento - Valores Adicionados no Mês - PIS/Pasep",{"CFB"},,,)
oFicha013:SetEdit( .F. )
TRCell():New(oFicha013,"RegCont"	,""	,"Regime de Apuração da Contribuição",,55,,)
TRCell():New(oFicha013,"VAL01"		,""	,"Período do Diferimento" ,,07,,)
TRCell():New(oFicha013,"VAL02"		,"CFB"	,"Contribuição Diferida" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha013,"VAL03"		,"CFB"	,"Crédito Diferido" ,"@E 99,999,999,999.99",18,,)




oFicha014:= TRSection():New(oReport,"Ficha 12 - Controle do Diferimento - Valores Diferidos no Mês - PIS/Pasep",{"CFA"},,,)
oFicha014:SetEdit( .F. )
TRCell():New(oFicha014,"Regime"	,""	,"Regime de Apuração da Contribuição",,55,,)
TRCell():New(oFicha014,"VAL01"		,""	,"Período do Diferimento" ,,07,,)
TRCell():New(oFicha014,"VAL02"		,"CFA"	,"Contribuição Adicionada" ,"@E 99,999,999,999.99",18,,)
TRCell():New(oFicha014,"VAL03"		,"CFA"	,"Crédito Adicionado" ,"@E 99,999,999,999.99",18,,)


Return(oReport)





















Static Function ReportPrint(oReport,aMes,aMercado)

Local dDtIni	:= mv_par01
Local dDtFin	:= mv_par02
Local nVDeprAt	:= 0
Local nTotVlMI	:= 0
Local nTotVlEX	:= 0
Local nTotVlNTr	:= 0
Local nTotVRec	:= 0
Local nTotVCum	:= 0
Local nBsCrdAqI	:= 0
Local nBsCrdAqE	:= 0
Local nPercInt	:= 0
Local nPercExt	:= 0
Local nPercNTr	:= 0
Local nRecFinC	:= 0
Local nRecFinN	:= 0
Local nOutRecN	:= 0
Local nOutRecC	:= 0
Local nRecVen   := 0
Local nPosMes	:= 0
Local nI		:= 0
Local nY		:= 0
Local nX		:= 0
Local nToCreMI	:= 0
Local nToCreEX	:= 0
Local nToCreNT	:= 0
Local nToMAMI1	:= 0
Local nToMAEX1	:= 0
Local nToMAMI3	:= 0
Local nToMAEX3	:= 0
Local nTot		:= 0
Local nTotCum	:= 0
Local nPis		:= 0
Local nCof		:= 0
Local nItem1	:= 0
Local nItem2	:= 0
Local nItem3	:= 0
Local nValor1	:= 0
Local nValor2	:= 0
Local nValor3	:= 0
Local nValor4   := 0
Local nVlrTot15 := 0
Local nVlrTot25 := 0
Local nNTrib	:= 0
Local cCod		:= ""
Local cMovimento:= ""
Local aDescr	:= {}
Local aDescr06B	:= {}
Local aDescr1	:= {}
Local aDescr2	:= {}
Local aDescr3	:= {}
Local aDescr4	:= {}
Local aDescr15A := {}
Local aDescr25A := {}
Local aDescr15B := {}
Local aDescr25B := {}
Local aArea		:= GetArea()
Local lFirst	:= .T. 
Local lRet		:= .F. 
Local nCont1	:= 0
Local nCont2	:= 0
Local nAjusMI	:= 0
Local nAjusEX	:= 0
Local nAjusNT	:= 0
Local aRecAuf 	:= {}
Local nQuant    := 0
Local n09A_15   := 0
Local n09A_25   := 0
Local n10A_15   := 0
Local n10A_25   := 0
Local nScan     := 0
Local cTpCon := ""
Local cDtPer := StrZero(Month(mv_par01),2)+Str(Year(mv_par01),4)
Local cRegApur	:= ""

aMercado := If( aMercado == nil, {}, aMercado ) ;

aMercado  := {{0,0,0},{0,0,0},{0,0,0}}




If Empty(mv_par01) .Or.  Empty(mv_par02) .Or.  (Month(mv_par01)<>Month(mv_par02)) .Or.  (Year(mv_par01)<>Year(mv_par02))
	xMagHelpFis(OemToAnsi("Período Inconsistente!"),OemToAnsi(If( cPaisLoc $ "ANG|PTG", "As perguntas data inicial e data final, foram preenchidas incorrectamente ou não foram devidamente preenchidas.", "As perguntas Data Inicial e Data Final, foram preenchidas incorretamente ou não foram devidamente preenchidas." )),OemToAnsi(If( cPaisLoc $ "ANG|PTG", "As Perguntas Data Inicial E Final, Devem Estar Devidamente Preenchidas, Possuírem O Mesmo Ano E Apenas Será Válida A Periodicidade Mensal.", "As perguntas Data Inicial e Final, devem estar devidamente preenchidas, possuirem o mesmo ano e somente será válida a periodicidade Mensal." )))
	Return( .F. )
Else
	If Day(mv_par01) <> 1
		mv_par01 := CtoD("01/"+StrZero(Month(mv_par01),2)+"/"+StrZero(Year(mv_par01),4))
	Endif
	If Day(mv_par02) <> Day(LastDay(mv_par02))
		mv_par02 := CtoD(StrZero(Day(LastDay(mv_par02)),2)+"/"+StrZero(Month(mv_par02),2)+"/"+StrZero(Year(mv_par02),4))
	Endif
Endif




aMes:= ProcDacon(@nVDeprAt,@nTotVlMI,@nTotVlEX,@nBsCrdAqI,@nBsCrdAqE,@nPercInt,@nPercExt,@nOutRecN,@nOutRecC,@nPosMes,@lRet,@nNTrib,@aRecAuf,@nRecVen,@nVAgrDes,@aMercado)

If lRet

	If mv_par06==2 .Or.  mv_par06==3



		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "01.bens Para Revenda", "01.Bens para Revenda" ),3})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "02.bens Utilizados Como Recursos", "02.Bens Utilizados como Insumos" ),4})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "03.serviços Utilizados Como Recursos", "03.Serviços Utilizados como Insumos" ),6})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "04.despesas De Energia Eléctrica", "04.Despesas de Energia Elétrica" ),5})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "05.despesas De Alugueres De Prédios Arrendados De Pessoas Jurídicas", "05.Despesas de Aluguéis de Prédios Locados de Pessoas Jurídicas" ),20})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "06.Despesas De Alugueres De Máquinas E Equipamentos Arrendados De Pessoas Jurídicas", "06.Despesas de Aluguéis de Máquinas e Equipamentos Locados de Pessoas Jurídicas" ),21})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "07.Despesas De Armazenamento De Mercadoria E Serviço Na Operação De Venda", "07.Despesas de Armazenagem de Mercadoria e Frete na Operação de Venda" ),23})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "08.Despesas De Contraprestações De Arrendamento Mercantil", "08.Despesas de Contraprestações de Arrendamento Mercantil" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "09.sobre Bens Do Activo Imobilizado(com Base Nas Categorias De Desvalorização)", "09.Sobre Bens do Ativo Imobilizado(Com Base nos Encargos de Depreciação)" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "10.sobre Bens Do Activo Imobilizado(com Base No Valor De Aquisição)", "10.Sobre Bens do Ativo Imobilizado(Com Base no Valor de Aquisição)" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "11.encategorias De Amortização De Edificações E Benfeitorias", "11.Encargos de Amortização de Edificações e Benfeitorias" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "12.Devolução de vendas sujeitas a aliquota de ", "12.Devolução de Vendas Sujeitas a Alíquota de " ),7})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "13.Outras Operações Com Direito A Crédito", "13.Outras Operações com Direito a Crédito" ),22})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "14.base De Cálculo Dos Créditos", "14.BASE DE CÁLCULO DOS CRÉDITOS" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "15.Créditos A Descontar", "15.Créditos a Descontar" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "Apuração De Outros Créditos", "APURAÇÃO DE OUTROS CRÉDITOS" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "16.Créditos Calculados A Aliquotas Diferenciadas", "16.Créditos Calculados a Alíquotas Diferenciadas" ),1,2})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "17.créditos Calculados Por Unidade De Medida De Artigo", "17.Créditos Calculados por Unidade de Medida de Produto" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "18.créditos Da Actividade De Transporte De Cargas - Subcontr.serviços", "18.Créditos da Atividade de Transporte de Cargas - Subcontr.Serviços" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "19.Crédito Calculado Relativo A Stock De Abertura", "19.Crédito Presumido Relativo a Estoque de Abertura" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "20.créditos Da Actividade Imobiliária", "20.Créditos da Atividade Imobiliária" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "21.outros Créditos A Descontar", "21.Outros Créditos a Descontar" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "22.acordos Positivos De Créditos", "22.Ajustes Positivos de Créditos" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "23.(-)acordos Negativos De Créditos", "23.(-)Ajustes Negativos de Créditos" ),10})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "24.total De Créditos Apurados Após Acordos", "24.TOTAL DE CRÉDITOS APURADOS APÓS AJUSTES" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "Créditos Presumidos - Actividades Agro-industriais", "CRÉDITOS PRESUMIDOS - ATIVIDADES AGROINDUSTRIAIS" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "25.calculados à taxa de 0,9900%", "25.Calculados a Alíquota de 0,9900%" ),52})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "26.calculados à taxa de 0,5775%", "26.Calculados a Alíquota de 0,5775%" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "27.acordos Positivos De Créditos", "27.Ajustes Positivos de Créditos" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "28.(-)acordos Negativos De Créditos", "28.(-)Ajustes Negativos de Créditos" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "29.total De Créditos Presumidos - Actividades Agro-industriais, Após Acordos", "29.TOTAL DE CRÉDITOS PRESUMIDOS - ATIVIDADES AGROINDUSTRIAIS, APÓS AJUSTES" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "Créditos Decorrentes Da Aquisição De Embalagens Para Revenda", "CRÉDITOS DECORRENTES DA AQUISIÇÃO DE EMBALAGENS PARA REVENDA" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "30.créditos Apurados", "30.Créditos Apurados" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "31.acordos Positivos De Créditos", "31.Ajustes Positivos de Créditos" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "32.(-)acordos Negativos De Créditos", "32.(-)Ajustes Negativos de Créditos" ),99})
		aAdd(aDescr,{If( cPaisLoc $ "ANG|PTG", "33.total De Créditos Decorrentes Da Aquisição De Embalagens Para Revenda, Após Acordos", "33.TOTAL DE CRÉDITOS DECORRENTES DA AQUISIÇÃO DE EMBALAGENS PARA REVENDA, APÓS AJUSTES" ),99})



		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "01.receita de vendas de bens e serviços - taxa 1,65%", "01.Receita de Vendas de Bens e Serviços - Alíq. 1,65%" ),8})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "02.demais receitas - taxa 1,65%", "02.Demais Receitas - Alíq. 1,65%" ),9})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "03.total da contribuição para o pis/pasep apurada à taxa de 1,65%", "03.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 1,65%" ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "Outras Receitas Aferidas", "OUTRAS RECEITAS AUFERIDAS" ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "04.receita Tributada à Taxa Zero", "04.Receita Tributada a Alíquota Zero" ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "05.receita Tributada à Taxa Zero-revenda Prod. Sujeitos Trib. Monof.", "05.Receita Tributada a Alíquota Zero-Revenda Prod. Sujeitos Trib. Monof." ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "06.receita De Vendas De Bens Do Activo Permanente", "06.Receita de Vendas de Bens do Ativo Permanente" ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "07.receita Sem Incidência Da Contribuição - Exportação", "07.Receita sem Incidência da Contribuição - Exportação" ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "08.receita Isenta E Demais Receitas Sem Incid.contribuição", "08.Receita Isenta e Demais Receitas sem Incid.Contribuição" ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "09.receita Com Suspensão Da Contribuição", "09.Receita com Suspensão da Contribuição" ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "10.receita De Revenda Dec.operações Suj.subs.tribut.", "10.Receita de Revenda Dec.Operações Suj.Subs.Tribut." ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "11.receita Tributada Pelo Ret - Património De Afectação", "11.Receita Tributada pelo RET -Patrimônio de Afetação" ),99})
		aAdd(aDescr1,{If( cPaisLoc $ "ANG|PTG", "12.contribuição Para O Pis/pasep -folha De Salários", "12.CONTRIBUIÇÃO PARA O PIS/PASEP -FOLHA DE SALÁRIOS" ),99})



		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "01.receita de vendas de bens e serviços - taxa 1,65%", "01.Receita de Vendas de Bens e Serviços - Alíq. 1,65%" ),10})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "02.demais receitas - taxa 1,65%", "02.Demais Receitas - Alíq. 1,65%" ),11})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "03.total da contribuição para o pis/pasep apurada à taxa de 1,65%", "03.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 1,65%" ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "Apuro da contribuição para o pis/pasep - regime cumulativo", "APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP - REGIME CUMULATIVO" ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "04.receita de vendas de bens e serviços - alíq. 0,65%", "04.Receita de Vendas de Bens e Serviços - Aliq. 0,65%" ),12})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "05.demais receitas - alíq. 0,65%", "05.Demais Receitas - Alíq. 0,65%" ),13})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "06.receita tributada no regime de substituição tributária - alíq.0,65%", "06.Receita Tributada no Regime de Substituição Tributária - Aliq.0,65%" ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "07.total da contribuição para o pis/pasep apurada a alíquota de 0,65%", "07.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 0,65%" ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "Outras Receitas Aferidas", "OUTRAS RECEITAS AUFERIDAS" ),99})
		aAdd(aDescr4,{"08.Receita Tributada a Alíquota Zero",99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "09.receita tributada a alíquota zero-revenda prod. Sujeitos trib. Monof.", "09.Receita Tributada a Alíquota Zero-Revenda Prod. Sujeitos Trib. Monof." ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "10.receita De Vendas De Bens Do Activo Permanente", "10.Receita de Vendas de Bens do Ativo Permanente" ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "11.receita sem incidência da contribuição - exportação", "11.Receita sem Incidência da Contribuição - Exportação" ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "12.receita isenta e demais receitas sem incid.contribuição", "12.Receita Isenta e Demais Receitas sem Incid.Contribuição" ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "13.receita com suspensão da contribuição", "13.Receita com Suspensão da Contribuição" ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "14.receita de revenda dec.operações suj.subs.tribut.", "14.Receita de Revenda Dec.Operações Suj.Subs.Tribut." ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "15.receita tributada pelo ret -património de afectação", "15.Receita Tributada pelo RET -Patrimônio de Afetação" ),99})
		aAdd(aDescr4,{If( cPaisLoc $ "ANG|PTG", "16.contribuição para o pis/pasep -folha de salários", "16.CONTRIBUIÇÃO PARA O PIS/PASEP -FOLHA DE SALÁRIOS" ),99})
	Else



		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "01.receita de vendas de bens e serviços - taxa 0,65%", "01.Receita de Vendas de Bens e Serviços - Aliq. 0,65%" ),8})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "02.demais receitas - taxa 0,65%", "02.Demais Receitas - Alíq. 0,65%" ),9})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "03.receita Tributada No Regime De Substituição Tributária – Taxa 0,65%", "03.Receita Tributada no Regime de Substituição Tributária - Aliq.0,65%" ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "04.total da contribuição para o pis/pasep apurado à taxa de 0,65%", "04.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 0,65%" ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "Outras Receitas Aferidas", "OUTRAS RECEITAS AUFERIDAS" ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "05.receita Tributada à Taxa Zero", "05.Receita Tributada a Alíquota Zero" ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "06.receita Tributada à Taxa Zero-revenda Prod. Sujeitos Trib. Monof.", "06.Receita Tributada a Alíqota Zero-Revenda Prod. Sujeitos Trib. Monof." ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "07.receita De Vendas De Bens Do Activo Permanente", "07.Receita de Vendas de Bens do Ativo Permanente" ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "08.receita Sem Incidência Da Contribuição - Exportação", "08.Receita sem Incidência da Contribuição - Exportação" ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "09.receita Isenta E Demais Receitas Sem Incid.contribuição", "09.Receita Isenta e Demais Receitas sem Incid.Contribuição" ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "10.receita Com Suspensão Da Contribuição", "10.Receita com Suspensao da Contribuição" ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "11.receita De Revenda Dec.operações Suj.subs.tribut.", "11.Receita de Revenda Dec.Operações Suj.Subs.Tribut." ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "12.receita Tributada Pelo Ret - Património De Afectação", "12.Receita Tributada pelo RET -Patrimônio de Afetação" ),99})
		aAdd(aDescr3,{If( cPaisLoc $ "ANG|PTG", "13.contribuição Pis/pasep -folha De Salários", "13.CONTRIBUIÇÃO PIS/PASEP -FOLHA DE SALÁRIOS" ),99})
	Endif

	If mv_par13==2

		aAdd(aDescr15A,{"01. Contribuição para o PIS/Pasep Apurada"})
		aAdd(aDescr15A,{"02. Contribuição para o PIS/Pasep Apurada - Alíquotas Diferenciadas"})
		aAdd(aDescr15A,{"03. Contribuição para o PIS/Pasep - Alíquotas Diferenciadas - Substituto Tributário"})
		aAdd(aDescr15A,{If( cPaisLoc $ "ANG|PTG", "04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Artigo", "04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Produto" )})
		aAdd(aDescr15A,{If( cPaisLoc $ "ANG|PTG", "05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Artigo - ST", "05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Produto - ST" )})
		aAdd(aDescr15A,{"06. Contribuição Diferida em meses anteriores"})
		aAdd(aDescr15A,{"07. (-) Créditos Diferidos em Meses Anteriores"})
		aAdd(aDescr15A,{"08. (-) Contribuiçao Diferida no Mês"})
		aAdd(aDescr15A,{"09. TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADO NO MÊS"})
		aAdd(aDescr15A,{"DEDUÇÕES"})
		aAdd(aDescr15A,{"10. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações Federais"})
		aAdd(aDescr15A,{"11. (-) PIS/Pasep Retida na Fonte pelas demais Entidades da Adm Pública Federal"})
		aAdd(aDescr15A,{"12. (-) PIS/Pasep Retida na Fonte por Pessoas Jurídicas de Direito Privado"})
		aAdd(aDescr15A,{"13. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações do Estado, DF e Municípios"})
		aAdd(aDescr15A,{"14. (-) PIS/Pasep Retida na Fonte por Sociedade Cooperativa"})
		aAdd(aDescr15A,{"15. (-) PIS/Pasep Retida na Fonte por Fabricantes de Veículos e Máquinas"})
		aAdd(aDescr15A,{If( cPaisLoc $ "ANG|PTG", "16. (-) PIS/Pasep Substituição pela Não Ocorrência do Facto Gerador Presumido", "16. (-) PIS/Pasep Substituição pela Não Ocorrência do Fato Gerador Presumido" )})
		aAdd(aDescr15A,{"17. (-) Crédito Presumido - Medicamentos"})
		aAdd(aDescr15A,{"18. (-) Créditos Admitidos no Regime Cumulativo"})
		aAdd(aDescr15A,{"19. (-) PIS/Pasep Paga pelo Substituto Tributário"})
		aAdd(aDescr15A,{"20. (-) Outras Deduções"})
		aAdd(aDescr15A,{If( cPaisLoc $ "ANG|PTG", "21. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FACTURAÇÃO", "21. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FATURAMENTO" )})
		aAdd(aDescr15A,{"22. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FOLHA DE SALÁRIOS"})
		aAdd(aDescr15A,{"23. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR DE SCP"})
		aAdd(aDescr15A,{"24. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR RETIDA DE COOPERADOS"})

	    aAdd(aDescr25A,{"01. Cofins Apurada"})
		aAdd(aDescr25A,{"02. Cofins Apurada - Alíquotas Diferenciadas"})
		aAdd(aDescr25A,{"03. Cofins Apurada – Alíquotas Diferenciadas – Sunstituto Tributário"})
		aAdd(aDescr25A,{"04. Cofins Apurada – Alíquotas por Unidade de Medida de Produto"})
		aAdd(aDescr25A,{"05. Cofins Apurada – Alíquotas por Unidade de Medida de Produto – Substituto Tributário"})
		aAdd(aDescr25A,{"06. Cofins Diferida em Meses Anteriores"})
		aAdd(aDescr25A,{"07. (-) Créditos Diferidos em Meses Anteriores"})
		aAdd(aDescr25A,{"08. (-) Cofins Diferida no Mês"})
		aAdd(aDescr25A,{"09. TOTAL DA COFINS APURADA NO MÊS"})
		aAdd(aDescr25A,{"DEDUÇÕES"})
		aAdd(aDescr25A,{"10. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações Federais"})
		aAdd(aDescr25A,{"11. (-) Cofins Retida na Fonte pelas Demais Entidades da Administração Pública Federal"})
		aAdd(aDescr25A,{"12. (-) Cofins Retida na Fonte por Pessoas Jurídicas de Direito Privado"})
		aAdd(aDescr25A,{"13. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações dos Estados, DF e Municípios"})
		aAdd(aDescr25A,{"14. (-) Cofins Retida na Fonte por Sociedade Cooperativa"})
		aAdd(aDescr25A,{"15. (-) Cofins Retida na Fonte por Fabricantes de Veículos e Máquinas"})
		aAdd(aDescr25A,{"16. (-) Cofins Substituição pela não Ocorrência do Fato Gerador Presumido"})
		aAdd(aDescr25A,{"17. (-) Crédito Presumido – Medicamentos"})
		aAdd(aDescr25A,{"18. (-) Créditos Admitidos no Regime Cumulativo"})
		aAdd(aDescr25A,{"19. (-) Cofins Paga pelo Substituto Tributário"})
		aAdd(aDescr25A,{"20. (-) Outras Deduções"})
		aAdd(aDescr25A,{"21. COFINS A PAGAR – FATURAMENTO"})
		aAdd(aDescr25A,{"22. COFINS A PAGAR DE SCP"})
		aAdd(aDescr25A,{"23. COFINS A PAGAR RETIDA DE COOPERADOS"})

		aAdd(aDescr15B,{"01. Contribuição para o PIS/Pasep Apurada"})
		aAdd(aDescr15B,{"02. Contribuição para o PIS/Pasep Apurada - Alíquotas Diferenciadas"})
		aAdd(aDescr15B,{"03. Contribuição para o PIS/Pasep - Alíquotas Diferenciadas - Substituto Tributário"})
		aAdd(aDescr15B,{If( cPaisLoc $ "ANG|PTG", "04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Artigo", "04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Produto" )})
		aAdd(aDescr15B,{If( cPaisLoc $ "ANG|PTG", "05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Artigo - ST", "05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Produto - ST" )})
		aAdd(aDescr15B,{"06. Contribuição Diferida em meses anteriores"})
		aAdd(aDescr15B,{"07. (-) Contribuição Diferida no Mês"})
		aAdd(aDescr15B,{"08. TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA NO MÊS"})
		aAdd(aDescr15B,{"CRÉDITOS DESCONTADOS REFERENTES A AQUISIÇÕES NO MERCADO INTERNO"})
		aAdd(aDescr15B,{"09. (-) Vinculados à Receita Tributada no Mercado Interno"})
		aAdd(aDescr15B,{"10. (-) Vinculados à Receita Não Tributada no Mercado Interno"})
		aAdd(aDescr15B,{"11. (-) Vinculados à Receita de Exportação"})
		aAdd(aDescr15B,{If( cPaisLoc $ "ANG|PTG", "12. (-) Presumido - Actividades Agroindustriais", "12. (-) Presumido - Atividades Agroindustriais" )})
		aAdd(aDescr15B,{"13. (-) Vinculados a Embalagens para Revenda"})
		aAdd(aDescr15B,{"CRÉDITOS DESCONTADOS REFERENTES A IMPORTAÇÕES"})
		aAdd(aDescr15B,{If( cPaisLoc $ "ANG|PTG", "14. (-) Vinculados à Receita Tributada no Mercado Interno", "14. (-) Vinculados a Receita Tributada no Mercado Interno" )})
		aAdd(aDescr15B,{If( cPaisLoc $ "ANG|PTG", "15. (-) Vinculados à Receita Não Tributada no Mercado Interno", "15. (-) Vinculados a Receita não Tributada no Mercado Interno" )})
		aAdd(aDescr15B,{If( cPaisLoc $ "ANG|PTG", "16. (-) Vinculados à Receita de Exportação", "16. (-) Vinculados a Receita de Exportação" )})
		aAdd(aDescr15B,{"17. TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP DEVIDA NO MÊS"})
		aAdd(aDescr15B,{"DEDUÇÕES"})
		aAdd(aDescr15B,{"18. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações Federais"})
		aAdd(aDescr15B,{"19. (-) PIS/Pasep Retida na Fonte pelas Demais Entidades da Administração Pública Federal"})
		aAdd(aDescr15B,{"20. (-) PIS/Pasep Retida na Fonte por Pessoas Jurídicas de Direito Privado"})
		aAdd(aDescr15B,{"21. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações dos Estados, DF e Municípios"})
		aAdd(aDescr15B,{"22. (-) PIS/Pasep Retida na Fonte por Sociedade Cooperativa"})
		aAdd(aDescr15B,{"23. (-) PIS/Pasep Retida na Fonte por Fabricantes de Veículos e Máquinas"})
		aAdd(aDescr15B,{If( cPaisLoc $ "ANG|PTG", "24. (-) PIS/Pasep Substituição pela Não Ocorrência do Facto Gerador Presumido", "24. (-) PIS/Pasep Substituição pela não ocorrência do Fato Gerador Presumido" )})
		aAdd(aDescr15B,{"25. (-) Crédito Presumido - Medicamentos"})
		aAdd(aDescr15B,{"26. (-) Créditos Admitidos no Regime Cumulativo"})
		aAdd(aDescr15B,{"27. (-) PIS/Pasep paga pelo Substituto Tributário"})
		aAdd(aDescr15B,{"28. (-) Outras Deduções"})
		aAdd(aDescr15B,{If( cPaisLoc $ "ANG|PTG", "29. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FACTURAÇÃO", "29. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FATURAMENTO" )})
		aAdd(aDescr15B,{"30. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FOLHA DE SALÁRIOS"})
		aAdd(aDescr15B,{"31. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR DE SCP"})
		aAdd(aDescr15B,{"32. CONTRIBUIÇAO PARA O PIS/PASEP A PAGAR RETIDA DE COOPERADOS"})

		aAdd(aDescr25B,{"01. Cofins Apurada"})
		aAdd(aDescr25B,{"02. Cofins Apurada - Alíquotas Diferenciadas"})
		aAdd(aDescr25B,{"03. Cofins Apurada – Alíquotas Diferenciadas – Sunstituto Tributário"})
		aAdd(aDescr25B,{"04. Cofins Apurada – Alíquotas por Unidade de Medida de Produto"})
		aAdd(aDescr25B,{"05. Cofins Apurada – Alíquotas por Unidade de Medida de Produto – Substituto Tributário"})
		aAdd(aDescr25B,{"06. Cofins Diferida em Meses Anteriores"})
		aAdd(aDescr25B,{"07. (-) Cofins Diferida no Mês"})
		aAdd(aDescr25B,{"08. TOTAL DA COFINS APURADA NO MÊS"})
		aAdd(aDescr25B,{"CRÉDITOS DESCONTADOS REFERENTES A AQUISIÇÕES NO MERCADO INTERNO"})
		aAdd(aDescr25B,{"09. (-) Vinculados à Receita Tributada no Mercado Interno"})
		aAdd(aDescr25B,{"10. (-) Vinculados à Receita Não Tributada no Mercado Interno"})
		aAdd(aDescr25B,{"11. (-) Vinculados à Receita de Exportação"})
		aAdd(aDescr25B,{If( cPaisLoc $ "ANG|PTG", "12. (-) Presumido - Actividades Agroindustriais", "12. (-) Presumido - Atividades Agroindustriais" )})
		aAdd(aDescr25B,{"13. (-) Vinculados a Embalagens para Revenda"})
		aAdd(aDescr25B,{"CRÉDITOS DESCONTADOS REFERENTES A IMPORTAÇÕES"})
		aAdd(aDescr25B,{If( cPaisLoc $ "ANG|PTG", "14. (-) Vinculados à Receita Tributada no Mercado Interno", "14. (-) Vinculados a Receita Tributada no Mercado Interno" )})
		aAdd(aDescr25B,{If( cPaisLoc $ "ANG|PTG", "15. (-) Vinculados à Receita Não Tributada no Mercado Interno", "15. (-) Vinculados a Receita não Tributada no Mercado Interno" )})
		aAdd(aDescr25B,{If( cPaisLoc $ "ANG|PTG", "16. (-) Vinculados à Receita de Exportação", "16. (-) Vinculados a Receita de Exportação" )})
		aAdd(aDescr25B,{"17. TOTAL DA CONTRIBUIÇÃO DEVIDA NO MÊS"})
		aAdd(aDescr25B,{"DEDUÇÕES"})
		aAdd(aDescr25B,{"18. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações Federais"})
		aAdd(aDescr25B,{"19. (-) Cofins Retida na Fonte pelas Demais Entidades da Administração Pública Federal"})
		aAdd(aDescr25B,{"20. (-) Cofins Retida na Fonte por Pessoas Jurídicas de Direito Privado"})
		aAdd(aDescr25B,{"21. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações dos Estados, DF e Municípios"})
		aAdd(aDescr25B,{"22. (-) Cofins Retida na Fonte por Sociedade Cooperativa"})
		aAdd(aDescr25B,{"23. (-) Cofins Retida na Fonte por Fabricantes de Veículos e Máquinas"})
		aAdd(aDescr25B,{"24. (-) Cofins Substituição pela não Ocorrência do Fato Gerador Presumido"})
		aAdd(aDescr25B,{"25. (-) Crédito Presumido – Medicamentos"})
		aAdd(aDescr25B,{"26. (-) Créditos Admitidos no Regime Cumulativo"})
		aAdd(aDescr25B,{"27. (-) Cofins Paga pelo Substituto Tributário"})
		aAdd(aDescr25B,{"28. (-) Outras Deduções"})
		aAdd(aDescr25B,{"29. COFINS A PAGAR – FATURAMENTO"})
		aAdd(aDescr25B,{"30. COFINS A PAGAR DE SCP"})
		aAdd(aDescr25B,{"31. COFINS A PAGAR RETIDA DE COOPERADOS"})
	Endif

	If mv_par09==2



		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "01.bens Para Revenda", "01.Bens para Revenda" ),3})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "02.bens Utilizados Como Recursos", "02.Bens Utilizados como Insumos" ),4})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "03.serviços Utilizados Como Recursos", "03.Serviços Utilizados como Insumos" ),6})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "04.despesas De Energia Eléctrica", "04.Despesas de Energia Elétrica" ),5})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "05.Despesas de aluguéres de prédios", "05.Despesas de Alugueis de Predios" ),20})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "06.Sobre bens do activo imobilizado(com base nos encargos de depreciação)", "06.Sobre Bens do Ativo Imobilizado(Com Base nos Encargos de Depreciação)" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "07.Sobre bens do activo Imobilizado(com base no valor de aquisição)", "07.Sobre Bens do Ativo Imobilizado(Com Base no Valor de Aquisição)" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "08.Outras operações com direito a crédito", "08.Outras Operacoes com Direito a Credito" ),22})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "09.BASE DE CÁLCULO DOS CRÉDITOS", "09.BASE DE CALCULO DOS CREDITOS" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "10.Créditos a descontar", "10.Creditos a Descontar" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "Apuração De Outros Créditos", "APURAÇÃO DE OUTROS CRÉDITOS" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "11.Créditos calculados alíquotas diferenciadas", "11.Creditos Calculados a Aliquotas Diferenciadas" ),1})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "12.Créditos calculados por unidade de medida de artigo", "12.Creditos Calculados por Unidade de Medida de Produto" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "13.Crédito presumido Relat. Stock de Abertura - Álcool", "13.Crédito presumido Relat. Estoque de Abertura - Álcool" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "14.Créditos da Actividade Imobiliária", "14.Creditos da Atividade Imobiliária" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "15.Outros Créditos a Descontar", "15.Outros Creditos a Descontar" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "16.Ajustes Positivos de Créditos", "16.Ajustes Positivos de Creditos" ),99})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "17.(-)Ajustes Negativos de Créditos", "17.(-)Ajustes Negativos de Creditos" ),10})
		aAdd(aDescr06B,{If( cPaisLoc $ "ANG|PTG", "18.TOTAL DE CRÉDITOS APURADOS APÓS AJUSTES", "18.TOTAL DE CREDITOS APURADOS APOS AJUSTES" ),99})
	EndIf

	For nI := 1 to nPosMes



		If mv_par06==2 .Or.  mv_par06==3
			For nY:= 1 To 4



				nTotVlMI :=0
				nTotVlMI += aMes[nI][2][3][1]+aMes[nI][2][4][1]+aMes[nI][2][6][1]+aMes[nI][2][5][1]+aMes[nI][2][20][1]+aMes[nI][2][21][1]+aMes[nI][2][22][1]+aMes[nI][2][23][1]+aMercado[02][01]+nBsCrdAqI+nVDeprAt
				nTotVlEX :=0
				nTotVlEX += aMes[nI][2][3][2]+aMes[nI][2][4][2]+aMes[nI][2][6][2]+aMes[nI][2][5][2]+aMes[nI][2][20][2]+aMes[nI][2][21][2]+aMes[nI][2][22][2]+aMes[nI][2][23][2]+aMercado[02][03]+nBsCrdAqE+nVDeprAt
				nTotVlNTr :=0
				nTotVlNTr +=aMes[nI][2][3][3]+aMes[nI][2][4][3]+aMes[nI][2][6][3]+aMes[nI][2][5][3]+aMes[nI][2][20][3]+aMes[nI][2][21][3]+aMes[nI][2][22][3]+aMes[nI][2][23][3]+aMercado[02][02]





				If aMes[nI][2][17][1] <> 0 .Or.  aMes[nI][2][18][1] <> 0 .Or.  aMes[nI][2][36][1] <> 0
					nPercInt := aMes[nI][2][17][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
					nPercExt := aMes[nI][2][18][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
					nPercNTr := aMes[nI][2][36][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
				Else
			       	nPercInt := 1
			       	nPercNTr := 1
			       	nPercExt := 1
				Endif



				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				End
				oReport:SetMeter(1)
		   		oReport:EndPage()

				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				If nY == 1 .Or.  nY == 3
			    	oReport:SkipLine()
					oReport:PrintText(IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "Ficha 06a - Apuramento Dos Créditos De Pis/pasep – Aquisições No Mercado Interno - Regime Não Cumulativo", "Ficha 06A - Apuração dos Créditos de PIS/PASEP - Aquisições no Mercado Interno - Regime Não Cumulativo" ),If( cPaisLoc $ "ANG|PTG", "Ficha 16a - Apuramento Dos Créditos Da Cofins - Aquisições No Mercado Interno - Regime Não Cumulativo", "Ficha 16A - Apuração dos Créditos da COFINS - Aquisições no Mercado Interno - Regime Não Cumulativo" )))
					oReport:SkipLine()
					oReport:Section(2):Cell("MOVIMENTO"):SetTitle(IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE" )+" 1,65% ",If( cPaisLoc $ "ANG|PTG", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE" )+" 7,6% "))
				ElseIf nY == 2 .Or.  nY == 4
					oReport:SkipLine()
					If mv_par06==2

						oReport:PrintText(IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "Ficha 07a - Cálculo Da Contribuição Para O Pis/pasep - Regime Não Cumulativo", "Ficha 07A - Cálculo da Contribuição para o PIS/PASEP - Regime Não Cumulativo" ),If( cPaisLoc $ "ANG|PTG", "Ficha 17a - Cálculo Da Cofins - Regime Não Cumulativo", "Ficha 17A - Cálculo da Cofins - Regime Não Cumulativo" )))
						oReport:Section(3):Cell("MOVIMENTO"):SetTitle(IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "Apuramento Da Contribuição Para O Pis/pasep", "APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP" ),If( cPaisLoc $ "ANG|PTG", "Apuramento Da Cofins", "APURAÇÃO DA COFINS" )))
					Elseif mv_par06==3

						oReport:PrintText(IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "Ficha 07B - Cálculo da Contribuição para o PIS/PASEP - Regime não cumulativo e cumulativo", "Ficha 07B - Cálculo da Contribuição para o PIS/PASEP - Regime Não Cumulativo e Cumulativo" ),If( cPaisLoc $ "ANG|PTG", "Ficha 17b - cálculo da cofins - regime não cumulativo e cumulativo", "Ficha 17B - Cálculo da Cofins - Regime Não Cumulativo e Cumulativo" )))
						oReport:Section(6):Cell("MOVIMENTO"):SetTitle(IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "Apuração da contribuição para o pis/pasep - regime não cumulativo", "APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP - REGIME NÃO CUMULATIVO" ),If( cPaisLoc $ "ANG|PTG", "Apuração da cofins - regime não cumulativo", "APURAÇÃO DA COFINS - REGIME NÃO CUMULATIVO" )))
					Endif
					oReport:SkipLine()
				Endif

				If oReport:Cancel()
					Exit
				EndIf

				If (nY == 1 .Or.  nY == 3)

					For nX := 1 to Len(aDescr)
						cMovimento 	:= aDescr[nX,1]
						oReport:Section(2):Init()
						oReport:Section(2):Cell("MOVIMENTO"):SetBlock({|| cMovimento })
						oReport:Section(2):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("08,11,17,18,19,20,21,22,26,27,28,29,30,31,32,33"),"------------------",nValor1)})
						oReport:Section(2):Cell("VAL02"):SetBlock({||Iif(Substr(cMovimento,1,2)$("08,11,17,18,19,20,21,22,26,27,28,29,30,31,32,33"),"------------------",nValor2)})
						oReport:Section(2):Cell("VAL03"):SetBlock({||Iif(Substr(cMovimento,1,2)$("08,11,17,18,19,20,21,22,26,27,28,29,30,31,32,33"),"------------------",nValor3)})

						If Substr(cMovimento,1,2) $("08,11,17,18,19,20,21,22,26,27,28,29,31,32,33")
	  						oReport:Section(2):Cell("VAL01"):SetPicture ("@!")
	  						oReport:Section(2):Cell("VAL02"):SetPicture ("@!")
		  					oReport:Section(2):Cell("VAL03"):SetPicture ("@!")
		  				Elseif Substr(cMovimento,1,2) == "09"
							oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@!")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
	  						nValor1	:= nVDeprAt*nPercInt
	  						nValor2	:= "------------------"
							nValor3	:= nVDeprAt*nPercExt
		    	        Elseif Substr(cMovimento,1,2) == "10"
							oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
	  						nValor1	:= nBsCrdAqI*nPercInt
	  						nValor2	:= nBsCrdAqI*nPercNTr
							nValor3	:= nBsCrdAqE*nPercExt
						Elseif Substr(cMovimento,1,2) == "12"
							oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							cMovimento := IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "12.Devolução de vendas sujeitas a aliquota de ", "12.Devolução de Vendas Sujeitas a Alíquota de " )+"1,65%",If( cPaisLoc $ "ANG|PTG", "12.Devolução de vendas sujeitas a aliquota de ", "12.Devolução de Vendas Sujeitas a Alíquota de " )+"7,6%")
							nValor1	:= aMes[nI][2][aDescr[nX,2]][1]
							nValor2 := nNTrib
							nValor3	:= aMes[nI][2][aDescr[nX,2]][2]
						Elseif Substr(cMovimento,1,2) == "13"
							oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							nValor1	:= (aMes[nI][2][aDescr[nX,2]][1]+aMes[nI][2][aDescr[nX,2]][2])*nPercInt
							nValor2 := (aMes[nI][2][aDescr[nX,2]][3]+aMes[nI][2][aDescr[nX,2]][2])*nPercNTr
							nValor3	:= (aMes[nI][2][aDescr[nX,2]][2]+aMes[nI][2][aDescr[nX,2]][2])*nPercExt
						Elseif Substr(cMovimento,1,2) == "14"
							oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
	  						nValor1	:= ((nTotVlMI+nVAgrDes)*nPercInt)+aMes[nI][2][7][1]
	  						nValor2 := ((nTotVlNTr+nVAgrDes)*nPercNTr)+nNTrib
							nValor3	:= ((nTotVlEX+nVAgrDes)*nPercExt)+aMes[nI][2][7][2]
						Elseif Substr(cMovimento,1,2) == "15"
	   						oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							cMovimento := IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "15.Créditos A Descontar", "15.Créditos a Descontar" )+" à Alíquota de 1,65%",If( cPaisLoc $ "ANG|PTG", "15.Créditos A Descontar", "15.Créditos a Descontar" )+" à Alíquota de 7,6%")
	  						nValor1	:= (((nTotVlMI+nVAgrDes)*nPercInt)+aMes[nI][2][7][1])*(IIF(nY==1,0.0165,0.076))
	  						nValor2 := (((nTotVlNTr+nVAgrDes)*nPercNTr)+nNTrib) *(IIF(nY==1,0.0165,0.076))
 							nValor3	:= (((nTotVlEX+nVAgrDes)*nPercExt)+aMes[nI][2][7][2])*(IIF(nY==1,0.0165,0.076))
						Elseif cMovimento == If( cPaisLoc $ "ANG|PTG", "Apuração De Outros Créditos", "APURAÇÃO DE OUTROS CRÉDITOS" )
	   						oReport:Section(2):Cell("VAL01"):Disable()
							oReport:Section(2):Cell("VAL02"):Disable()
							oReport:Section(2):Cell("VAL03"):Disable()
							oReport:SkipLine()
						Elseif Substr(cMovimento,1,2) == "16"
							oReport:Section(2):Cell("VAL01"):Enable()
							oReport:Section(2):Cell("VAL02"):Enable()
							oReport:Section(2):Cell("VAL03"):Enable()
							oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
		  					If nY==1
			  					nValor1	:= (aMes[nI][2][aDescr[nX,2]][1]+aMes[nI][2][aDescr[nX,2]][2])*nPercInt
			  					nValor2	:= (aMes[nI][2][aDescr[nX,2]][3]+aMes[nI][2][aDescr[nX,2]][2])*nPercNTr
								nValor3	:= (aMes[nI][2][aDescr[nX,2]][2]+aMes[nI][2][aDescr[nX,2]][2])*nPercExt
							Elseif nY==3
			  					nValor1	:= (aMes[nI][2][aDescr[nX,3]][1]+aMes[nI][2][aDescr[nX,3]][2])*nPercInt
			  					nValor2	:= (aMes[nI][2][aDescr[nX,3]][3]+aMes[nI][2][aDescr[nX,3]][2])*nPercNTr
								nValor3	:= (aMes[nI][2][aDescr[nX,3]][2]+aMes[nI][2][aDescr[nX,3]][2])*nPercExt
							Endif
							oReport:SkipLine()
						Elseif Substr(cMovimento,1,2) == "23"
							oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							nValor1	:= ((aMes[nI][2][aDescr[nX,2]][1]+aMes[nI][2][aDescr[nX,2]][2])*nPercInt)*(IIF(nY==1,0.0165,0.076))
							nValor2	:= ((aMes[nI][2][aDescr[nX,2]][3]+aMes[nI][2][aDescr[nX,2]][2])*nPercNTr)*(IIF(nY==1,0.0165,0.076))
							nValor3	:= ((aMes[nI][2][aDescr[nX,2]][2]+aMes[nI][2][aDescr[nX,2]][2])*nPercExt)*(IIF(nY==1,0.0165,0.076))
							nAjusMI	:= ((aMes[nI][2][aDescr[nX,2]][1]+aMes[nI][2][aDescr[nX,2]][2])*nPercInt)*(IIF(nY==1,0.0165,0.076))
							nAjusNT := ((aMes[nI][2][aDescr[nX,2]][3]+aMes[nI][2][aDescr[nX,2]][2])*nPercNTr)*(IIF(nY==1,0.0165,0.076))
							nAjusEX := ((aMes[nI][2][aDescr[nX,2]][2]+aMes[nI][2][aDescr[nX,2]][2])*nPercExt)*(IIF(nY==1,0.0165,0.076))
						Elseif Substr(cMovimento,1,2) == "24"
						    If nY==1
								nToCreMI := ((((((nTotVlMI+nVAgrDes))*nPercInt)+aMes[nI][2][7][1])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][1][1]))-nAjusMI
								nToCreNT := ((((((nTotVlNTr+nVAgrDes))*nPercNTr)+nNTrib) *(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][3][1]))-nAjusNT
			 					nToCreEX := ((((((nTotVlEX+nVAgrDes))*nPercExt)+aMes[nI][2][7][2])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][1][2]))-nAjusEX
							Elseif 	nY==3
			 					nToCreMI := ((((((nTotVlMI+nVAgrDes))*nPercInt)+aMes[nI][2][7][1])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][2][1]))-nAjusMI
		 						nToCreNT := ((((((nTotVlNTr+nVAgrDes))*nPercNTr)+nNTrib) *(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][3][1]))-nAjusNT
		 						nToCreEX := ((((((nTotVlEX+nVAgrDes))*nPercExt)+aMes[nI][2][7][2])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][2][2]))-nAjusEX
							Endif
	   						oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
	  						nValor1	:= nToCreMI
	  						nValor2 := nToCreNT
							nValor3	:= nToCreEX
					   Elseif cMovimento == If( cPaisLoc $ "ANG|PTG", "Créditos Presumidos - Actividades Agro-industriais", "CRÉDITOS PRESUMIDOS - ATIVIDADES AGROINDUSTRIAIS" )
							oReport:Section(2):Cell("VAL01"):Disable()
							oReport:Section(2):Cell("VAL02"):Disable()
							oReport:Section(2):Cell("VAL03"):Disable()
							oReport:SkipLine()
					   	Elseif Substr(cMovimento,1,2) == "25"
				  			oReport:Section(2):Cell("VAL01"):Enable()
							oReport:Section(2):Cell("VAL02"):Enable()
							oReport:Section(2):Cell("VAL03"):Enable()
							oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							cMovimento := IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "25.calculados à taxa de 0,9900%", "25.Calculados a Alíquota de 0,9900%" ),If( cPaisLoc $ "ANG|PTG", "25.calculados à taxa de 4,56%", "25.Calculados a Alíquota de 4,56%" ))
	  				   		nValor1	:= ((aMes[nI][2][aDescr[nX,2]][1]+aMes[nI][2][aDescr[nX,2]][2])*nPercInt)*(IIF(nY==1,0.0099,0.0456))
							nValor2	:= ((aMes[nI][2][aDescr[nX,2]][3]+aMes[nI][2][aDescr[nX,2]][2])*nPercNTr)*(IIF(nY==1,0.0099,0.0456))
							nValor3	:= ((aMes[nI][2][aDescr[nX,2]][2]+aMes[nI][2][aDescr[nX,2]][2])*nPercExt)*(IIF(nY==1,0.0099,0.0456))
	  						oReport:SkipLine()
	  				   	Elseif cMovimento == If( cPaisLoc $ "ANG|PTG", "Créditos Decorrentes Da Aquisição De Embalagens Para Revenda", "CRÉDITOS DECORRENTES DA AQUISIÇÃO DE EMBALAGENS PARA REVENDA" )
							oReport:Section(2):Cell("VAL01"):Disable()
							oReport:Section(2):Cell("VAL02"):Disable()
							oReport:Section(2):Cell("VAL03"):Disable()
							oReport:SkipLine()
						Elseif Substr(cMovimento,1,2) == "30"
							oReport:Section(2):Cell("VAL01"):Enable()
							oReport:Section(2):Cell("VAL02"):Enable()
							oReport:Section(2):Cell("VAL03"):Enable()
			  				oReport:Section(2):Cell("VAL02"):SetPicture ("@!")
			  				oReport:Section(2):Cell("VAL02"):SetPicture ("@!")
		  					oReport:Section(2):Cell("VAL02"):SetPicture ("@!")
	  						oReport:SkipLine()
	  					Elseif Substr(cMovimento,1,2) == "04"
	  						oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
			   				oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							nValor1	:= ((aMes[nI][2][aDescr[nX,2]][1]+aMes[nI][2][aDescr[nX,2]][2])*nPercInt)+aMercado[01][01]
							nValor2 := ((aMes[nI][2][aDescr[nX,2]][3]+aMes[nI][2][aDescr[nX,2]][2])*nPercNTr)+aMercado[01][02]
							nValor3	:= ((aMes[nI][2][aDescr[nX,2]][2]+aMes[nI][2][aDescr[nX,2]][2])*nPercExt)+aMercado[01][03]
	  					Elseif Substr(cMovimento,1,2) == "05"
	  						oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
			   				oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							nValor1	:= ((aMes[nI][2][aDescr[nX,2]][1]+aMes[nI][2][aDescr[nX,2]][2])*nPercInt)+aMercado[02][01]
							nValor2 := ((aMes[nI][2][aDescr[nX,2]][3]+aMes[nI][2][aDescr[nX,2]][2])*nPercNTr)+aMercado[02][02]
							nValor3	:= ((aMes[nI][2][aDescr[nX,2]][2]+aMes[nI][2][aDescr[nX,2]][2])*nPercExt)+aMercado[02][03]
						Elseif Substr(cMovimento,1,2) == "06"
	  						oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
			   				oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							nValor1	:= ((aMes[nI][2][aDescr[nX,2]][1]+aMes[nI][2][aDescr[nX,2]][2])*nPercInt)+aMercado[03][01]
							nValor2 := ((aMes[nI][2][aDescr[nX,2]][3]+aMes[nI][2][aDescr[nX,2]][2])*nPercNTr)+aMercado[03][02]
							nValor3	:= ((aMes[nI][2][aDescr[nX,2]][2]+aMes[nI][2][aDescr[nX,2]][2])*nPercExt)+aMercado[03][03]
					  	Elseif Substr(cMovimento,1,2) == "01"
	  						oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
			   				oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							nValor1	:= aMes[nI][2][aDescr[nX,2]][1]
							nValor2 := aMes[nI][2][aDescr[nX,2]][3]
							nValor3	:= aMes[nI][2][aDescr[nX,2]][2]
						Else
			   				oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
			   				oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
							oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
							nValor1	:= (aMes[nI][2][aDescr[nX,2]][1]+aMes[nI][2][aDescr[nX,2]][2])*nPercInt
							nValor2 := (aMes[nI][2][aDescr[nX,2]][3]+aMes[nI][2][aDescr[nX,2]][2])*nPercNTr
							nValor3	:= (aMes[nI][2][aDescr[nX,2]][2]+aMes[nI][2][aDescr[nX,2]][2])*nPercExt
						Endif
						oReport:Section(2):PrintLine()
					Next
				Else
                    If mv_par06==2
						For nX := 1 to Len(aDescr1)
							cMovimento 	:= aDescr1[nX,1]
							oReport:Section(3):Init()
							oReport:Section(3):Cell("MOVIMENTO"):SetBlock({|| cMovimento })
								oReport:Section(3):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("12"),"------------------",nValor1)})
							If lPisFolha .Or.  lPisFolSN
						    	oReport:Section(3):Cell("VAL02"):SetBlock({||Iif(Substr(cMovimento,1,2)$("05,07,08,09,10,11"),"------------------",nValor2)})
							    oReport:Section(3):Cell("VAL03"):SetBlock({||Iif(Substr(cMovimento,1,2)$("05,07,08,09,10,11"),"------------------",nValor3)})
	                        Else
						    	oReport:Section(3):Cell("VAL02"):SetBlock({||Iif(Substr(cMovimento,1,2)$("05,07,08,09,10,11,12"),"------------------",nValor2)})
							    oReport:Section(3):Cell("VAL03"):SetBlock({||Iif(Substr(cMovimento,1,2)$("05,07,08,09,10,11,12"),"------------------",nValor3)})
	                        Endif
							If Substr(cMovimento,1,2) == "01"
								oReport:Section(3):Cell("VAL01"):Enable()
								oReport:Section(3):Cell("VAL02"):Enable()
								oReport:Section(3):Cell("VAL03"):Enable()
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "01.receita de vendas de bens e serviços - taxa 1,65%", "01.Receita de Vendas de Bens e Serviços - Alíq. 1,65%" ),If( cPaisLoc $ "ANG|PTG", "01.receita de vendas de bens e serviços - taxa 7,6%", "01.Receita de Vendas de Bens e Serviços - Alíq. 7,6%" ))
								nValor1	:= aMes[nI][2][8][1]+ nRecVen
								nValor2	:= ((aMes[nI][2][8][1]+ nRecVen)-(aMes[nI][2][19][1]+aMes[nI][2][15][1]))
								nValor3 := (((aMes[nI][2][8][1]+ nRecVen)-(aMes[nI][2][19][1]+aMes[nI][2][15][1])))*IIF(nY==2,0.0165,0.076)
								nCont1 := (((aMes[nI][2][8][1]+ nRecVen)-(aMes[nI][2][19][1]+aMes[nI][2][15][1])))*IIF(nY==2,0.0165,0.076)
							Elseif Substr(cMovimento,1,2)== "02"
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "02.demais receitas - taxa 1,65%", "02.Demais Receitas - Alíq. 1,65%" ),If( cPaisLoc $ "ANG|PTG", "02.demais receitas - taxa 7,6%", "02.Demais Receitas - Alíq. 7,6%" ))
								nValor1	:= aMes[nI][2][9][1]+nOutRecN
								nValor2	:= (aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1])
								nValor3 := ((aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==2,0.0165,0.076)
								nCont2 := ((aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==2,0.0165,0.076)
							Elseif Substr(cMovimento,1,2) == "03"
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "03.total da contribuição para o pis/pasep apurada à taxa de 1,65%", "03.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 1,65%" ),If( cPaisLoc $ "ANG|PTG", "03.total da cofins apurada à taxa de 7,6%", "03.TOTAL DA COFINS APURADA A ALÍQUOTA DE 7,6%" ))
								oReport:Section(3):Cell("VAL01"):SetPicture("@!")
								oReport:Section(3):Cell("VAL02"):SetPicture("@!")
								oReport:Section(3):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
								nValor1	:= ""
								nValor2	:= ""
								nValor3 := nCont1+nCont2
					 		Elseif cMovimento == If( cPaisLoc $ "ANG|PTG", "Outras Receitas Aferidas", "OUTRAS RECEITAS AUFERIDAS" )
								oReport:Section(3):Cell("VAL01"):Disable()
								oReport:Section(3):Cell("VAL02"):Disable()
								oReport:Section(3):Cell("VAL03"):Disable()
								oReport:SkipLine()
							Elseif Substr(cMovimento,1,2) == "04"
								oReport:Section(3):Cell("VAL01"):Enable()
								oReport:Section(3):Cell("VAL02"):Enable()
								oReport:Section(3):Cell("VAL03"):Enable()
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@!")
								oReport:Section(3):Cell("VAL03"):SetPicture("@!")
								nValor1	:= aMes[nI][2][29][1]
								nValor2 := "------------------"
								nValor3 := "------------------"
							Elseif Substr(cMovimento,1,2) == "05"
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@!")
								oReport:Section(3):Cell("VAL03"):SetPicture("@!")
								nValor1	:= aMes[nI][2][30][1]+ aRecAuf[2]
								nValor2	:= "------------------"
								nValor3 := "------------------"
							Elseif Substr(cMovimento,1,2) == "06"
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@!")
								oReport:Section(3):Cell("VAL03"):SetPicture("@!")
								nValor1	:= aMes[nI][2][31][1]+ aRecAuf[3]
								nValor2	:= "------------------"
								nValor3 := "------------------"
							Elseif Substr(cMovimento,1,2) == "07"
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@!")
								oReport:Section(3):Cell("VAL03"):SetPicture("@!")
								nValor1	:= aMes[nI][2][27][1]+ aRecAuf[4]
								nValor2	:= "------------------"
								nValor3 := "------------------"
							Elseif Substr(cMovimento,1,2) == "08"
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@!")
								oReport:Section(3):Cell("VAL03"):SetPicture("@!")
								nValor1	:= aMes[nI][2][32][1]+ aRecAuf[5]
								nValor2	:= "------------------"
								nValor3 := "------------------"
							Elseif Substr(cMovimento,1,2) == "09"
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@!")
								oReport:Section(3):Cell("VAL03"):SetPicture("@!")
								nValor1	:= aMes[nI][2][33][1]+ aRecAuf[6]
								nValor2	:= "------------------"
								nValor3 := "------------------"
							Elseif Substr(cMovimento,1,2) == "10"
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@!")
								oReport:Section(3):Cell("VAL03"):SetPicture("@!")
								nValor1	:= aMes[nI][2][34][1] + aRecAuf[7]
								nValor2	:= "------------------"
								nValor3 := "------------------"
							Elseif Substr(cMovimento,1,2) == "11"
								oReport:Section(3):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(3):Cell("VAL02"):SetPicture("@!")
								oReport:Section(3):Cell("VAL03"):SetPicture("@!")
								nValor1	:= aMes[nI][2][35][1]+ aRecAuf[8]
								nValor2	:= "------------------"
								nValor3 := "------------------"
		  					Elseif Substr(cMovimento,1,2) == "12"
								If (nY==2)
									oReport:SkipLine()
									oReport:Section(3):Cell("MOVIMENTO"):Enable()
	   							    oReport:Section(3):Cell("VAL01"):Enable()
									oReport:Section(3):Cell("VAL02"):Enable()
									oReport:Section(3):Cell("VAL03"):Enable()
				  					oReport:Section(3):Cell("VAL01"):SetPicture ("@!")
					  				If lPisFolha .Or.  lPisFolSN
					  			   	    oReport:Section(3):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
					  				    oReport:Section(3):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
    								    nValor1	:= "------------------"
		    						    nValor2	:= aMes[nI][2][36][2]
			    					    nValor3 := nValor2*0.01
			    					Else
					  			   	    oReport:Section(3):Cell("VAL02"):SetPicture ("@!")
					  				    oReport:Section(3):Cell("VAL03"):SetPicture ("@!")
    								    nValor1	:= "------------------"
		    						    nValor2	:= "------------------"
			    					    nValor3 := "------------------"
			    					Endif
						  		Else
							  		oReport:Section(3):Cell("MOVIMENTO"):Disable()
					   				oReport:Section(3):Cell("VAL01"):Disable()
									oReport:Section(3):Cell("VAL02"):Disable()
									oReport:Section(3):Cell("VAL03"):Disable()
		       	    		    Endif
						    Endif
							oReport:Section(3):PrintLine()
						Next
					Elseif mv_par06==3
						For nX := 1 to Len(aDescr4)
							cMovimento 	:= aDescr4[nX,1]
							oReport:Section(6):Init()
							oReport:Section(6):Cell("MOVIMENTO"):SetBlock({|| cMovimento })
							If lPisFolha .Or.  lPisFolSN
					    		oReport:Section(6):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("06"),"------------------",nValor1)})
						    	oReport:Section(6):Cell("VAL02"):SetBlock({||Iif(Substr(cMovimento,1,2)$("06"),"------------------",nValor2)})
							    oReport:Section(6):Cell("VAL03"):SetBlock({||Iif(Substr(cMovimento,1,2)$("06"),"------------------",nValor3)})
							Else
					    		oReport:Section(6):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("06,16"),"------------------",nValor1)})
						    	oReport:Section(6):Cell("VAL02"):SetBlock({||Iif(Substr(cMovimento,1,2)$("06,16"),"------------------",nValor2)})
							    oReport:Section(6):Cell("VAL03"):SetBlock({||Iif(Substr(cMovimento,1,2)$("06,16"),"------------------",nValor3)})
							EndIf



							If Substr(cMovimento,1,2) == "01"
								oReport:Section(6):Cell("VAL01"):Enable()
								oReport:Section(6):Cell("VAL02"):Enable()
								oReport:Section(6):Cell("VAL03"):Enable()
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "01.receita de vendas de bens e serviços - taxa 1,65%", "01.Receita de Vendas de Bens e Serviços - Alíq. 1,65%" ),If( cPaisLoc $ "ANG|PTG", "01.receita de vendas de bens e serviços - taxa 7,6%", "01.Receita de Vendas de Bens e Serviços - Alíq. 7,6%" ))
								nValor1	:= aMes[nI][2][8][1]+ nRecVen
								nValor2	:= ((aMes[nI][2][8][1]+ nRecVen)-(aMes[nI][2][19][1]+aMes[nI][2][15][1]))
								nValor3 := (((aMes[nI][2][8][1]+ nRecVen)-(aMes[nI][2][19][1]+aMes[nI][2][15][1])))*IIF(nY==2,0.0165,0.076)
								nCont1 := (((aMes[nI][2][8][1]+ nRecVen)-(aMes[nI][2][19][1]+aMes[nI][2][15][1])))*IIF(nY==2,0.0165,0.076)
							Elseif Substr(cMovimento,1,2)== "02"
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "02.demais receitas - taxa 1,65%", "02.Demais Receitas - Alíq. 1,65%" ),If( cPaisLoc $ "ANG|PTG", "02.demais receitas - taxa 7,6%", "02.Demais Receitas - Alíq. 7,6%" ))
								nValor1	:= aMes[nI][2][9][1]+nOutRecN
								nValor2	:= (aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1])
								nValor3 := ((aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==2,0.0165,0.076)
								nCont2 := ((aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==2,0.0165,0.076)
							Elseif Substr(cMovimento,1,2)== "03"
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "03.total da contribuição para o pis/pasep apurada à taxa de 1,65%", "03.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 1,65%" ),If( cPaisLoc $ "ANG|PTG", "03.total da cofins apurada à taxa de 7,6%", "03.TOTAL DA COFINS APURADA A ALÍQUOTA DE 7,6%" ))
								oReport:Section(6):Cell("VAL01"):SetPicture("@!")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
								oReport:Section(6):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
								nValor1	:= ""
								nValor2	:= ""
								nValor3 := nCont1+nCont2



					 		Elseif cMovimento == If( cPaisLoc $ "ANG|PTG", "Apuro da contribuição para o pis/pasep - regime cumulativo", "APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP - REGIME CUMULATIVO" )
						 		cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "Apuro da contribuição para o pis/pasep - regime cumulativo", "APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP - REGIME CUMULATIVO" ),If( cPaisLoc $ "ANG|PTG", "Apuração da cofins - regime cumulativo", "APURAÇÃO DA COFINS - REGIME CUMULATIVO" ))
								oReport:Section(6):Cell("VAL01"):Disable()
								oReport:Section(6):Cell("VAL02"):Disable()
								oReport:Section(6):Cell("VAL03"):Disable()
								oReport:SkipLine(2)
							Elseif Substr(cMovimento,1,2) == "04"
								oReport:Section(6):Cell("VAL01"):Enable()
								oReport:Section(6):Cell("VAL02"):Enable()
								oReport:Section(6):Cell("VAL03"):Enable()
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "04.receita de vendas de bens e serviços - alíq. 0,65%", "04.Receita de Vendas de Bens e Serviços - Aliq. 0,65%" ),If( cPaisLoc $ "ANG|PTG", "04.receita de vendas de bens e serviços - aliq. 3%", "04.Receita de Vendas de Bens e Serviços - Alíq. 3%" ))
								nValor1	:= aMes[nI][2][12][1]+ nRecVen
								nValor2	:= ((aMes[nI][2][12][1]+ nRecVen)-(aMes[nI][2][14][1]+aMes[nI][2][25][1]))
								nValor3 := (((aMes[nI][2][12][1]+ nRecVen)-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*IIF(nY==2,0.0065,0.03)
								nCont1 := (((aMes[nI][2][12][1]+ nRecVen)-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*IIF(nY==2,0.0065,0.03)
							Elseif Substr(cMovimento,1,2)== "05"
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "05.demais receitas - alíq. 0,65%", "05.Demais Receitas - Alíq. 0,65%" ),If( cPaisLoc $ "ANG|PTG", "05.demais receitas - aliq. 3%", "05.Demais Receitas - Alíq. 3%" ))
								nValor1	:= aMes[nI][2][13][1]+nOutRecC
								nValor2	:= (aMes[nI][2][13][1]+nOutRecC)-(aMes[nI][2][24][1]+aMes[nI][2][26][1])
								nValor3 := ((aMes[nI][2][13][1]+nOutRecC)-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*IIF(nY==2,0.0065,0.03)
								nCont2 := ((aMes[nI][2][13][1]+nOutRecC)-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*IIF(nY==2,0.0065,0.03)
							Elseif Substr(cMovimento,1,2)== "06"
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "06.receita tributada no regime de substituição tributária - alíq.0,65%", "06.Receita Tributada no Regime de Substituição Tributária - Aliq.0,65%" ),If( cPaisLoc $ "ANG|PTG", "06.receita tributada no reg.subs.tributária - aliq. 3%", "06.Receita Tributada no Reg.Subs.Tributária - Alíq. 3%" ))
				  				oReport:Section(6):Cell("VAL01"):SetPicture ("@!")
				  				oReport:Section(6):Cell("VAL02"):SetPicture ("@!")
					  			oReport:Section(6):Cell("VAL03"):SetPicture ("@!")
							Elseif Substr(cMovimento,1,2)== "07"
								cMovimento :=IIF(nY==2,If( cPaisLoc $ "ANG|PTG", "07.total da contribuição para o pis/pasep apurada a alíquota de 0,65%", "07.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 0,65%" ),If( cPaisLoc $ "ANG|PTG", "07.total da cofins apurada a alíquota de 3%", "07.TOTAL DA COFINS APURADA A ALÍQUOTA DE 3%" ))
								oReport:Section(6):Cell("VAL01"):SetPicture("@!")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
								oReport:Section(6):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
								nValor1	:= ""
								nValor2	:= ""
								nValor3 := nCont1+nCont2
					 		Elseif cMovimento == If( cPaisLoc $ "ANG|PTG", "Outras Receitas Aferidas", "OUTRAS RECEITAS AUFERIDAS" )
								oReport:Section(6):Cell("VAL01"):Disable()
								oReport:Section(6):Cell("VAL02"):Disable()
								oReport:Section(6):Cell("VAL03"):Disable()
								oReport:SkipLine(2)
		  					ElseIf Substr(cMovimento,1,2) = "08"
								oReport:Section(6):Cell("VAL01"):Enable()
								oReport:Section(6):Cell("VAL02"):Enable()
								oReport:Section(6):Cell("VAL03"):Enable()
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
								oReport:Section(6):Cell("VAL03"):SetPicture("@!")
								nValor1 := aMes[nI][2][29][1]
								nValor2	:= "------------------"
								nValor3 := "------------------"
		  					ElseIf Substr(cMovimento,1,2) = "09"
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
								oReport:Section(6):Cell("VAL03"):SetPicture("@!")
								nValor1 := aMes[nI][2][30][1]+ aRecAuf[2]
								nValor2	:= "------------------"
								nValor3 := "------------------"
		  					ElseIf Substr(cMovimento,1,2) = "10"
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
 								oReport:Section(6):Cell("VAL03"):SetPicture("@!")
   							    nValor1 := aMes[nI][2][31][1]+ aRecAuf[3]
								nValor2	:= "------------------"
								nValor3 := "------------------"
		  					ElseIf Substr(cMovimento,1,2) = "11"
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
								oReport:Section(6):Cell("VAL03"):SetPicture("@!")
 							    nValor1 := aMes[nI][2][27][1]+ aRecAuf[4]
								nValor2	:= "------------------"
								nValor3 := "------------------"
		  					ElseIf Substr(cMovimento,1,2) = "12"
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
								oReport:Section(6):Cell("VAL03"):SetPicture("@!")
  							    nValor1 := aMes[nI][2][32][1]+ aRecAuf[5]
								nValor2	:= "------------------"
								nValor3 := "------------------"
		  					ElseIf Substr(cMovimento,1,2) = "13"
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
								oReport:Section(6):Cell("VAL03"):SetPicture("@!")
							    nValor1 := aMes[nI][2][33][1]+ aRecAuf[6]
								nValor2	:= "------------------"
								nValor3 := "------------------"
		  					ElseIf Substr(cMovimento,1,2) = "14"
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
								oReport:Section(6):Cell("VAL03"):SetPicture("@!")
								nValor1 := aMes[nI][2][34][1]+ aRecAuf[7]
								nValor2	:= "------------------"
								nValor3 := "------------------"
		  					ElseIf Substr(cMovimento,1,2) = "15"
								oReport:Section(6):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
								oReport:Section(6):Cell("VAL02"):SetPicture("@!")
								oReport:Section(6):Cell("VAL03"):SetPicture("@!")
								nValor1 := aMes[nI][2][35][1]+ aRecAuf[8]
								nValor2	:= "------------------"
								nValor3 := "------------------"
		  					Elseif Substr(cMovimento,1,2) == "16"
								If (nY==2)
									oReport:SkipLine()
									oReport:Section(6):Cell("MOVIMENTO"):Enable()
	   								oReport:Section(6):Cell("VAL01"):Enable()
									oReport:Section(6):Cell("VAL02"):Enable()
									oReport:Section(6):Cell("VAL03"):Enable()
			  			            If lPisFolha .Or.  lPisFolSN
			  					    	oReport:Section(6):Cell("VAL01"):SetPicture ("@!")
					  				    oReport:Section(6):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
					  				    oReport:Section(6):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
										nValor1 := "------------------"
								        nValor2	:= aMes[nI][2][36][2]
								        nValor3 := aMes[nI][2][36][2]*0.01
			  			            Else
			  					    	oReport:Section(6):Cell("VAL01"):SetPicture ("@!")
					  				    oReport:Section(6):Cell("VAL02"):SetPicture ("@!")
					  				    oReport:Section(6):Cell("VAL03"):SetPicture ("@!")
						  		    EndIf
						  		Else
							  		oReport:Section(6):Cell("MOVIMENTO"):Disable()
					   				oReport:Section(6):Cell("VAL01"):Disable()
									oReport:Section(6):Cell("VAL02"):Disable()
									oReport:Section(6):Cell("VAL03"):Disable()
	       	    		    	Endif
						    Endif
							oReport:Section(6):PrintLine()
						Next
					Endif
				Endif
				oReport:Section(2):Finish()
				oReport:Section(3):Finish()
				oReport:Section(6):Finish()
		 	Next



		Else
			For nY:= 1 To 2



				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				End
				oReport:SetMeter(1)
		   		oReport:EndPage()

				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				If nY == 1
	  			    oReport:SkipLine()
					oReport:PrintText(If( cPaisLoc $ "ANG|PTG", "Ficha 08a - Cálculo Da Contribuição Para O Segurança Social - Regime Cumulativo", "Ficha 08A - Cálculo da Contribuição para o PIS/Pasep - Regime Cumulativo" ))
					oReport:SkipLine()
					oReport:Section(5):Cell("MOVIMENTO"):SetTitle(If( cPaisLoc $ "ANG|PTG", "Apuramento Da Contribuição Para O Pis/pasep", "APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP" ))
	 			Else
					oReport:SkipLine()
					oReport:PrintText(If( cPaisLoc $ "ANG|PTG", "Ficha 18a - Cálculo Da Cofins - Regime Cumulativo", "Ficha 18A - Cálculo da Cofins - Regime Cumulativo" ))
					oReport:Section(5):Cell("MOVIMENTO"):SetTitle(If( cPaisLoc $ "ANG|PTG", "Apuramento Da Cofins", "APURAÇÃO DA COFINS" ))
					oReport:SkipLine()
				Endif

				If oReport:Cancel()
					Exit
				EndIf

				For nX := 1 to Len(aDescr3)
					cMovimento 	:= aDescr3[nX,1]

					oReport:Section(5):Init()
					oReport:Section(5):Cell("MOVIMENTO"):SetBlock({|| cMovimento })
					If lPisFolha .Or.  lPisFolSN
					    oReport:Section(5):Cell("VAL01"):SetBlock({||nValor1})
					    oReport:Section(5):Cell("VAL02"):SetBlock({||nValor2})
					    oReport:Section(5):Cell("VAL03"):SetBlock({||nValor3})
					Else
					    oReport:Section(5):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("13"),"------------------",nValor1)})
					    oReport:Section(5):Cell("VAL02"):SetBlock({||Iif(Substr(cMovimento,1,2)$("13"),"------------------",nValor2)})
					    oReport:Section(5):Cell("VAL03"):SetBlock({||Iif(Substr(cMovimento,1,2)$("13"),"------------------",nValor3)})
					EndIf
					oReport:Section(5):Cell("VAL01"):Enable()
					oReport:Section(5):Cell("VAL02"):Enable()
					oReport:Section(5):Cell("VAL03"):Enable()

					If Substr(cMovimento,1,2) == "01"
						oReport:Section(5):Cell("VAL01"):Enable()
						oReport:Section(5):Cell("VAL02"):Enable()
						oReport:Section(5):Cell("VAL03"):Enable()
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
						cMovimento :=IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "01.receita de vendas de bens e serviços - taxa 0,65%", "01.Receita de Vendas de Bens e Serviços - Aliq. 0,65%" ),If( cPaisLoc $ "ANG|PTG", "01.receita De Vendas De Bens E Serviços - Taxa Cumulativa", "01.Receita de Vendas de Bens e Serviços - Aliq. Cumulativa" ))
						nValor1	:= aMes[nI][2][8][2]+ nRecVen
						nValor2	:= ((aMes[nI][2][8][2]+ nRecVen)-(aMes[nI][2][19][2]+aMes[nI][2][15][2]))
						nValor3 := (((aMes[nI][2][8][2]+ nRecVen)-(aMes[nI][2][19][2]+aMes[nI][2][15][2])))*IIF(nY==1,0.0065,0.03)
						nCont1 := (((aMes[nI][2][8][2]+ nRecVen)-(aMes[nI][2][19][2]+aMes[nI][2][15][2])))*IIF(nY==1,0.0065,0.03)
					Elseif Substr(cMovimento,1,2)== "02"
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
						cMovimento :=IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "02.demais receitas - taxa 0,65%", "02.Demais Receitas - Alíq. 0,65%" ),If( cPaisLoc $ "ANG|PTG", "02.demais Receitas - Taxa Cumulativa", "02.Demais Receitas - Alíq. Cumulativa" ))
						nValor1	:= aMes[nI][2][9][2]+nOutRecC
						nValor2	:= (aMes[nI][2][9][2]+nOutRecC)-(aMes[nI][2][11][2]+aMes[nI][2][16][2])
						nValor3 := ((aMes[nI][2][9][2]+nOutRecC)-(aMes[nI][2][11][2]+aMes[nI][2][16][2]))*IIF(nY==1,0.0065,0.03)
						nCont2 := ((aMes[nI][2][9][2]+nOutRecC)-(aMes[nI][2][11][2]+aMes[nI][2][16][2]))*IIF(nY==1,0.0065,0.03)
					Elseif Substr(cMovimento,1,2)== "03"
						cMovimento :=IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "03.receita Tributada No Regime De Substituição Tributária – Taxa 0,65%", "03.Receita Tributada no Regime de Substituição Tributária - Aliq.0,65%" ),If( cPaisLoc $ "ANG|PTG", "03.receita tributada no regime de substituição tributária - taxa 3%", "03.Receita Tributada no Regime de Substituição Tributária - Aliq. 3%" ))
		  				oReport:Section(5):Cell("VAL01"):SetPicture ("@!")
		  				oReport:Section(5):Cell("VAL02"):SetPicture ("@!")
			  			oReport:Section(5):Cell("VAL03"):SetPicture ("@!")
					Elseif Substr(cMovimento,1,2) == "04"
						cMovimento :=IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "04.total da contribuição para o pis/pasep apurado à taxa de 0,65%", "04.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 0,65%" ),If( cPaisLoc $ "ANG|PTG", "04.total Da Cofins Apurada - Taxa Cumulativa", "04.TOTAL DA COFINS APURADA - ALÍQUOTA CUMULATIVA" ))
						oReport:Section(5):Cell("VAL01"):SetPicture("@!")
						oReport:Section(5):Cell("VAL02"):SetPicture("@!")
						oReport:Section(5):Cell("VAL03"):SetPicture("@E 99,999,999,999.99")
						nValor1	:= ""
						nValor2	:= ""
						nValor3 := nCont1+nCont2
			 		Elseif cMovimento == If( cPaisLoc $ "ANG|PTG", "Outras Receitas Aferidas", "OUTRAS RECEITAS AUFERIDAS" )
						oReport:Section(5):Cell("VAL01"):Disable()
						oReport:Section(5):Cell("VAL02"):Disable()
						oReport:Section(5):Cell("VAL03"):Disable()
  						oReport:SkipLine()
					Elseif Substr(cMovimento,1,2) == "05"
						oReport:Section(5):Cell("VAL01"):Enable()
						oReport:Section(5):Cell("VAL02"):Enable()
						oReport:Section(5):Cell("VAL03"):Enable()
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@!")
						oReport:Section(5):Cell("VAL03"):SetPicture("@!")
						nValor1	:= aMes[nI][2][29][2] + aRecAuf[1]
						nValor2	:= "------------------"
						nValor3 := "------------------"
						oReport:SkipLine()
					Elseif Substr(cMovimento,1,2) == "06"
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@!")
						oReport:Section(5):Cell("VAL03"):SetPicture("@!")
						nValor1	:= aMes[nI][2][30][2]+ aRecAuf[2]
						nValor2	:= "------------------"
						nValor3 := "------------------"
					Elseif Substr(cMovimento,1,2) == "07"
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@!")
						oReport:Section(5):Cell("VAL03"):SetPicture("@!")
						nValor1	:= aMes[nI][2][31][2]+ aRecAuf[3]
						nValor2	:= "------------------"
						nValor3 := "------------------"
					Elseif Substr(cMovimento,1,2) == "08"
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@!")
						oReport:Section(5):Cell("VAL03"):SetPicture("@!")
						nValor1	:= aMes[nI][2][27][2]+ aRecAuf[4]
						nValor2	:= "------------------"
						nValor3 := "------------------"
					Elseif Substr(cMovimento,1,2) == "09"
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@!")
						oReport:Section(5):Cell("VAL03"):SetPicture("@!")
						nValor1	:= aMes[nI][2][32][2]+ aRecAuf[5]
						nValor2	:= "------------------"
						nValor3 := "------------------"
					Elseif Substr(cMovimento,1,2) == "10"
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@!")
						oReport:Section(5):Cell("VAL03"):SetPicture("@!")
						nValor1	:= aMes[nI][2][33][2]+ aRecAuf[6]
						nValor2	:= "------------------"
						nValor3 := "------------------"
					Elseif Substr(cMovimento,1,2) == "11"
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@!")
						oReport:Section(5):Cell("VAL03"):SetPicture("@!")
						nValor1	:= aMes[nI][2][34][2]+ aRecAuf[7]
						nValor2	:= "------------------"
						nValor3 := "------------------"
					Elseif Substr(cMovimento,1,2) == "12"
						oReport:Section(5):Cell("VAL01"):SetPicture("@E 99,999,999,999.99")
						oReport:Section(5):Cell("VAL02"):SetPicture("@!")
						oReport:Section(5):Cell("VAL03"):SetPicture("@!")
						nValor1	:= aMes[nI][2][35][2]+ aRecAuf[8]
						nValor2	:= "------------------"
						nValor3 := "------------------"
  					Elseif Substr(cMovimento,1,2) == "13"
						If (nY==1)
							oReport:SkipLine()
							oReport:Section(5):Cell("MOVIMENTO"):Enable()
   							oReport:Section(5):Cell("VAL01"):Enable()
							oReport:Section(5):Cell("VAL02"):Enable()
							oReport:Section(5):Cell("VAL03"):Enable()
							If lPisFolha .Or.  lPisFolSN
		  					    oReport:Section(5):Cell("VAL01"):SetPicture ("@!")
			  				    oReport:Section(5):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
			  				    oReport:Section(5):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
								nValor1	:= "------------------"
    							nValor2	:= aMes[nI][2][36][2]
								nValor3 := nValor2*0.01
							Else
		  					    oReport:Section(5):Cell("VAL01"):SetPicture ("@!")
			  				    oReport:Section(5):Cell("VAL02"):SetPicture ("@!")
			  				    oReport:Section(5):Cell("VAL03"):SetPicture ("@!")
				  		    EndIf
				  		Else
					  		oReport:Section(5):Cell("MOVIMENTO"):Disable()
			   				oReport:Section(5):Cell("VAL01"):Disable()
							oReport:Section(5):Cell("VAL02"):Disable()
							oReport:Section(5):Cell("VAL03"):Disable()
       	    		    Endif
				    Endif
					oReport:Section(5):PrintLine()
				Next
				oReport:Section(5):Finish()
			Next
			oReport:SkipLine()
			oReport:ThinLine()
			oReport:IncMeter()
		Endif




		If mv_par09==2 .And.  Len(aMes[nI])>=3
			For nY:= 1 To 2

				nTotVlMI :=0
  			    nTotVlMI += aMes[nI][3][3][1]+aMes[nI][3][4][1]+aMes[nI][3][6][1]+aMes[nI][3][5][1]+aMes[nI][3][20][1]+aMes[nI][3][22][1]+nBsCrdAqI+nVDeprAt





				If aMes[nI][2][17][1] <> 0 .Or.  aMes[nI][2][18][1] <> 0 .Or.  aMes[nI][2][36][1] <> 0
					nPercInt := aMes[nI][2][17][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
					nPercExt := aMes[nI][2][18][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
					nPercNTr := aMes[nI][2][36][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
				Else
			       	nPercInt := 1
	       			nPercExt := 0
	     		  	nPercNTr := 0
				Endif



				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				End
				oReport:SetMeter(1)
		   		oReport:EndPage()

				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

		    	oReport:SkipLine()
				oReport:PrintText(IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "Ficha 06B - Apuramento dos créditos de PIS/PASEP - importação - regime não cumulativo", "Ficha 06B - Apuração dos Créditos de PIS/PASEP - Importação - Regime Não Cumulativo" ),If( cPaisLoc $ "ANG|PTG", "Ficha 16B - Apuramento dos créditos da COFINS - importação - regime não cumulativo", "Ficha 16B - Apuração dos Créditos da COFINS - Importação - Regime Não Cumulativo" )))

				oReport:SkipLine()
				oReport:Section(7):Cell("MOVIMENTO"):SetTitle(IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE" )+" 1,65% ",If( cPaisLoc $ "ANG|PTG", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE", "BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE" )+" 7,6% "))

				If oReport:Cancel()
					Exit
				EndIf

				For nX := 1 to Len(aDescr06B)
					cMovimento 	:= aDescr06B[nX,1]
					oReport:Section(7):Init()
					oReport:Section(7):Cell("MOVIMENTO"):SetBlock({|| cMovimento })
					oReport:Section(7):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("06,12,13,14,15"),"------------------",nValor1)})
					oReport:Section(7):Cell("VAL02"):SetBlock({||Iif(Substr(cMovimento,1,2)$("06,12,13,14,15"),"------------------",nValor2)})
					oReport:Section(7):Cell("VAL03"):SetBlock({||Iif(Substr(cMovimento,1,2)$("06,12,13,14,15"),"------------------",nValor3)})

					If Substr(cMovimento,1,2) $("06,12,13,14,15,16")
  						oReport:Section(7):Cell("VAL01"):SetPicture ("@!")
  						oReport:Section(7):Cell("VAL02"):SetPicture ("@!")
	  					oReport:Section(7):Cell("VAL03"):SetPicture ("@!")
	    	        Elseif Substr(cMovimento,1,2) == "07"
						oReport:Section(7):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
  						nValor1	:= nBsCrdAqI*nPercInt
  						nValor2 := nBsCrdAqI*nPercNTr
						nValor3	:= nBsCrdAqE*nPercExt
					Elseif Substr(cMovimento,1,2) == "09"
						oReport:Section(7):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
  						nValor1	:= (nTotVlMI)*nPercInt
  						nValor2	:= (nTotVlMI)*nPercNTr
						nValor3	:= (nTotVlMI)*nPercExt
					Elseif Substr(cMovimento,1,2) == "10"
   						oReport:Section(7):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
						cMovimento := IIF(nY==1,If( cPaisLoc $ "ANG|PTG", "10.Créditos a descontar", "10.Creditos a Descontar" )+" à Alíquota de 1,65%",If( cPaisLoc $ "ANG|PTG", "10.Créditos a descontar", "10.Creditos a Descontar" )+" à Alíquota de 7,6%")
  						nValor1	:= ((nTotVlMI)*nPercInt)*(IIF(nY==1,0.0165,0.076))
  						nValor2 := ((nTotVlMI)*nPercNTr)*(IIF(nY==1,0.0165,0.076))
						nValor3	:= ((nTotVlMI)*nPercExt)*(IIF(nY==1,0.0165,0.076))
					Elseif cMovimento == If( cPaisLoc $ "ANG|PTG", "Apuração De Outros Créditos", "APURAÇÃO DE OUTROS CRÉDITOS" )
   						oReport:Section(7):Cell("VAL01"):Disable()
						oReport:Section(7):Cell("VAL02"):Disable()
						oReport:Section(7):Cell("VAL03"):Disable()
						oReport:SkipLine()
					Elseif Substr(cMovimento,1,2) == "11"
						oReport:Section(7):Cell("VAL01"):Enable()
						oReport:Section(7):Cell("VAL02"):Enable()
						oReport:Section(7):Cell("VAL03"):Enable()
						oReport:Section(7):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
	  					nValor1	:= (aMes[nI][3][aDescr06B[nX,2]][1])*nPercInt
	  					nValor2 := (aMes[nI][3][aDescr06B[nX,2]][1])*nPercNTr
						nValor3	:= (aMes[nI][3][aDescr06B[nX,2]][1])*nPercExt
						oReport:SkipLine()
					Elseif Substr(cMovimento,1,2) == "17"
						oReport:Section(7):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
						nValor1	:= ((aMes[nI][3][aDescr06B[nX,2]][1])*nPercInt)*(IIF(nY==1,0.0165,0.076))
						nValor2 := ((aMes[nI][3][aDescr06B[nX,2]][1])*nPercNTr)*(IIF(nY==1,0.0165,0.076))
						nValor3	:= ((aMes[nI][3][aDescr06B[nX,2]][1])*nPercExt)*(IIF(nY==1,0.0165,0.076))
						nAjusMI	:= ((aMes[nI][3][aDescr06B[nX,2]][1])*nPercInt)*(IIF(nY==1,0.0165,0.076))
						nAjusNT := ((aMes[nI][3][aDescr06B[nX,2]][1])*nPercNTr)*(IIF(nY==1,0.0165,0.076))
						nAjusEX := ((aMes[nI][3][aDescr06B[nX,2]][1])*nPercExt)*(IIF(nY==1,0.0165,0.076))
					Elseif Substr(cMovimento,1,2) == "18"
						nToCreMI := ((((nTotVlMI)*nPercInt)*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][3][1][1]))-nAjusMI
						nToCreNT := ((((nTotVlMI)*nPercNTr)*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][3][1][1]))-nAjusNT
						nToCreEX := ((((nTotVlMI)*nPercExt)*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][3][1][1]))-nAjusEX
   						oReport:Section(7):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(7):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
  						nValor1	:= nToCreMI
  						nValor2 := nToCreNT
						nValor3	:= nToCreEX
					Else
		   				oReport:Section(2):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
		   				oReport:Section(2):Cell("VAL02"):SetPicture ("@E 99,999,999,999.99")
						oReport:Section(2):Cell("VAL03"):SetPicture ("@E 99,999,999,999.99")
						nValor1	:= (aMes[nI][3][aDescr06B[nX,2]][1])*nPercInt
						nValor2	:= (aMes[nI][3][aDescr06B[nX,2]][1])*nPercNTr
						nValor3	:= (aMes[nI][3][aDescr06B[nX,2]][1])*nPercExt
					Endif
					oReport:Section(7):PrintLine()
				Next
				oReport:Section(7):Finish()
		 	Next
		EndIf




		If mv_par07 == 2
			For nY:= 1 To 2



				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				End
				oReport:SetMeter(1)
	   			oReport:EndPage()
				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				If nY == 1
  				    oReport:SkipLine()
					oReport:PrintText(If( cPaisLoc $ "ANG|PTG", "Ficha 09a - Cálculo Da Contribuição Para O Pis/pasep - Taxas Diferenciadas", "Ficha 09A - Cálculo da Contribuição para o PIS/PASEP - Alíquotas Diferenciadas" ))
					oReport:SkipLine()
 				Else
					oReport:SkipLine()
					oReport:PrintText(If( cPaisLoc $ "ANG|PTG", "Ficha 19a - Cálculo Da Cofins - Taxas Diferenciadas", "Ficha 19A - Cálculo da Cofins - Alíquotas Diferenciadas" ))
					oReport:SkipLine()
				Endif

				dbSelectArea("TMP")
				cMes :=	StrZero(aMes[nI,1],2)
				oReport:Section(4):Init()
				oReport:Section(4):Cell("PRODUTO"):SetBlock({|| Alltrim(cCod) + " - " + Alltrim(Posicione("SB1",1,xFilial("SB1")+cCod,"B1_DESC"))})
				oReport:Section(4):Cell("VAL01"):SetBlock({||nItem1})
				oReport:Section(4):Cell("VAL02"):SetBlock({||(nItem1-(nItem2+nItem3))})
				oReport:Section(4):Cell("VAL03"):SetBlock({|| Iif(nY==1,nPis,nCof)})
				oReport:Section(4):Cell("VAL04"):SetBlock({|| Iif(nY==1,(((nItem1-(nItem2+nItem3))*nPis)/100),(((nItem1-(nItem2+nItem3))*nCof)/100))})

				If dbSeek(cMes)
					If nY == 1
						nPis := TMP->PIS
						cCod := TMP->CODIGO
						While !Eof() .And.  TMP->MES == cMes
							While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
								Do Case
									Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
									Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
									Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
								EndCase
								dbSelectArea("TMP")
								dbSkip()
							Enddo
							cMes :=	StrZero(aMes[nI,1],2)
							oReport:Section(4):PrintLine()
							n09A_15 += (nItem1+nItem2+nItem3) * nPis / 100
							nPis 	:= TMP->PIS
							cCod 	:= TMP->CODIGO
							nItem1	:= 0
							nItem2	:= 0
							nItem3	:= 0
						Enddo
					Else
						nCof := TMP->COFINS
						cCod := TMP->CODIGO
						While !Eof() .And.  TMP->MES == cMes
							While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
								Do Case
									Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
									Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
									Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
								EndCase
								dbSelectArea("TMP")
								dbSkip()
							Enddo
							cMes :=	StrZero(aMes[nI,1],2)
							oReport:Section(4):PrintLine()
							n09A_25 += (nItem1+nItem2+nItem3) * nCof / 100
							nCof 	:= TMP->COFINS
							cCod 	:= TMP->CODIGO
							nItem1	:= 0
							nItem2	:= 0
							nItem3	:= 0
						Enddo
					Endif
				Endif
				oReport:Section(4):Finish()
			Next
		Endif
		oReport:SkipLine()
		oReport:ThinLine()
		oReport:IncMeter()




		If mv_par12 == 2

			For nY:= 1 To 2



				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				End
				oReport:SetMeter(1)
	   			oReport:EndPage()
				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				If nY == 1
  				    oReport:SkipLine()
					oReport:PrintText(If( cPaisLoc $ "ANG|PTG", "Ficha 10a - Cálculo da Contribuição para o Pis/Pasep - Alíquotas por Unidade de Medida", "Ficha 10a - Cálculo Da Contribuição Para O Pis/pasep - Aliquotas por Unidade de Medida" ))
					oReport:SkipLine()
 				Else
					oReport:SkipLine()
					oReport:PrintText("Ficha 20A - Cálculo da Cofins - Alíquotas por Unidade de Medida de Produto")
					oReport:SkipLine()
			   	Endif

				dbSelectArea("T01")
				cMes :=	StrZero(aMes[nI,1],2)
				oReport:Section(8):Init()
				oReport:Section(8):Cell("PRODUTO"):SetBlock({|| Alltrim(cCod) + " - " + Alltrim(Posicione("SB1",1,xFilial("SB1")+cCod,"B1_DESC"))})
				oReport:Section(8):Cell("VAL01"):SetBlock({||nItem1})
				oReport:Section(8):Cell("VAL02"):SetBlock({||nQuant})
				oReport:Section(8):Cell("VAL03"):SetBlock({|| Iif(nY==1,nPis,nCof)})
				oReport:Section(8):Cell("VAL04"):SetBlock({|| Iif(nY==1,nQuant * nPis,nQuant * nCof)})

				If dbSeek(cMes)
					If nY == 1
						nPis := T01->PIS
						cCod := T01->CODIGO
						While !Eof() .And.  T01->MES == cMes
							While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
								nItem1 += T01->VALOR
								nQuant += T01->QUANT
								dbSelectArea("T01")
								dbSkip()
							Enddo
							cMes :=	StrZero(aMes[nI,1],2)
							oReport:Section(8):PrintLine()

							n10A_15 += nQuant * nPis
							nPis 	:= T01->PIS
							cCod 	:= T01->CODIGO
							nItem1	:= 0
							nQuant  := 0
						Enddo

				  	Else
				   	   	nCof := T01->COFINS
						cCod := T01->CODIGO
						While !Eof() .And.  T01->MES == cMes
							While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
								nItem1 += T01->VALOR
								nQuant += T01->QUANT
								dbSelectArea("T01")
								dbSkip()
							Enddo
							cMes :=	StrZero(aMes[nI,1],2)
							oReport:Section(8):PrintLine()

							n10A_25 += nQuant * nCof
							nCof 	:= T01->COFINS
							cCod 	:= T01->CODIGO
							nItem1	:= 0
							nQuant  := 0
						Enddo
					Endif
				Endif
				oReport:Section(8):Finish()
			Next
		Endif
		oReport:SkipLine()
		oReport:ThinLine()
		oReport:IncMeter()




  	  	If mv_par14 == 2

			Do Case
				Case mv_par06 == 1 ; cRegApur := "Regime Cumulativo"
				Case mv_par06 == 2 ; cRegApur := "Regime Não-Cumulativo"
				Case mv_par06 == 3 ; cRegApur := "Regime Cumulativo e Não Cumulativo (Ambos)"
			EndCase

			dbSelectArea("CFB")
			dbSetOrder(1)

			For nY:= 1 To 2




				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				End
				oReport:SetMeter(1)
	   			oReport:EndPage()
				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				If nY == 1
  				    oReport:SkipLine()
					oReport:PrintText("Ficha 11 - Controle do Diferimento - Valores Adicionados no Mês - PIS/Pasep")
					oReport:SkipLine()
					cTpCon := "PIS"
 				Else
					oReport:SkipLine()
					oReport:PrintText("Ficha 21 - Controle do Diferimento - Valores Adicionados no Mês - Cofins")
					oReport:SkipLine()
					cTpCon := "COF"
			   	Endif

				If dbSeek(xFilial("CFB")+cDtPer+cTpCon)

					oReport:Section(13):Init()
					oReport:Section(13):Cell("RegCont"):SetBlock({||cRegApur})
					oReport:Section(13):Cell("VAL01"):SetBlock({||SubStr(DtoC(mv_par01),4,7)})
					oReport:Section(13):Cell("VAL02"):SetBlock({||CFB->CFB_CONREC})
					If mv_par06 <> 1
						oReport:Section(13):Cell("VAL03"):SetBlock({||CFB->CFB_CREDES})
					EndIf
				Endif
				oReport:Section(13):PrintLine()
				oReport:Section(13):Finish()
			Next
		Endif
		oReport:SkipLine()
		oReport:ThinLine()
		oReport:IncMeter()




	  	If mv_par14 == 2

			Do Case
				Case mv_par06 == 1 ; cRegApur := "Regime Cumulativo"
				Case mv_par06 == 2 ; cRegApur := "Regime Não-Cumulativo"
				Case mv_par06 == 3 ; cRegApur := "Regime Cumulativo e Não Cumulativo (Ambos)"
			EndCase

			dbSelectArea("CFA")
			dbSetOrder(1)

			For nY:= 1 To 2




				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				End
				oReport:SetMeter(1)
	   			oReport:EndPage()
				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				If nY == 1
  				    oReport:SkipLine()
					oReport:PrintText("Ficha 12 - Controle do Diferimento - Valores Diferidos no Mês - PIS/Pasep")
					oReport:SkipLine()
					cTpCon := "PIS"
 				Else
					oReport:SkipLine()
					oReport:PrintText("Ficha 22 - Controle do Diferimento - Valores Diferidos no Mês - Cofins")
					oReport:SkipLine()
					cTpCon := "COF"
			   	Endif

				If dbSeek(xFilial("CFA")+cDtPer+cTpCon)

					oReport:Section(14):Init()
					oReport:Section(14):Cell("Regime"):SetBlock({||cRegApur})
					oReport:Section(14):Cell("VAL01"):SetBlock({||SubStr(DtoC(mv_par01),4,7)})
					oReport:Section(14):Cell("VAL02"):SetBlock({||CFA->CFA_CONDIF})
					If mv_par06 <> 1
						oReport:Section(14):Cell("VAL03"):SetBlock({||CFA->CFA_CREDIF})
					EndIf
				Endif
				oReport:Section(14):PrintLine()
				oReport:Section(14):Finish()
			Next
		Endif
		oReport:SkipLine()
		oReport:ThinLine()
		oReport:IncMeter()




		If mv_par13==2 .And.  mv_par06==1
			For nY:= 1 To 1



				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				Endif
				oReport:SetMeter(1)
		   		oReport:EndPage()

				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				oReport:SkipLine()
				oReport:PrintText("Ficha 15A - RESUMO - Contribuição para PIS/Pasep - Regime Cumulativo")
				oReport:SkipLine()

				For nX := 1 to Len(aDescr15A)
					nScan := aScan(aWizCum,{|x| x[2]=="Ficha 15A - RESUMO - Contribuição para PIS/Pasep - Regime Cumulativo" } )
					cMovimento :=	aDescr15A[nX,1]
					oReport:Section(9):Init()
					oReport:Section(9):Cell("MOVIMENTO"):SetBlock({|| cMovimento })
					oReport:Section(9):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("03,05,06,07,08"),"------------------",nValor4)})
					oReport:Section(9):Cell("VAL01"):Enable()

					If Substr(cMovimento,1,2) $("03,05,06,07,08")
						oReport:Section(7):Cell("VAL01"):SetPicture ("@!")
					Elseif Substr(cMovimento,1,2) $("01")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nCont1 		:= (((aMes[nI][2][8][2]+aMes[nI][2][51][1])-(aMes[nI][2][19][2]+aMes[nI][2][15][2])))*(0.0065)
						nCont2 		:= ((aMes[nI][2][9][2]+aMes[nI][2][39][1])-(aMes[nI][2][11][2]+aMes[nI][2][16][2]))*(0.0065)
						nValor4 	:= nCont1+nCont2
						nVlrTot15  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("02")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= n09A_15
						nVlrTot15  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("04")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= n10A_15
						nVlrTot15  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("09")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot15
					Elseif Substr(cMovimento,1,2) $("10")
						oReport:Section(9):Cell("VAL01"):Enable()
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][1])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("11")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][2])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("12")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][3])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("13")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][4])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("14")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][5])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("15")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][6])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("16")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][7])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("17")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][8])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("18")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][9])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("19")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][10])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("20")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][11])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("21")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot15
					Elseif Substr(cMovimento,1,2) $("22")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						If lPisFolha .Or.  lPisFolSN
							nValor4 	:=	aMes[nI][2][36][2]*0.01
						Else
							nValor4 	:= 0
						EndIf
					Elseif Substr(cMovimento,1,2) $("23")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][12])
					Elseif Substr(cMovimento,1,2) $("24")
						oReport:Section(9):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][13])
					Elseif cMovimento == "DEDUÇÕES"
   						oReport:Section(9):Cell("VAL01"):Disable()
						oReport:SkipLine()
					Endif

					oReport:Section(9):PrintLine()
				Next
				oReport:Section(9):Finish()
			Next
		Endif




	   	If mv_par13==2 .And.  mv_par06==1
			For nY:= 1 To 1



				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				Endif
				oReport:SetMeter(1)
		   		oReport:EndPage()

				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				oReport:SkipLine()
				oReport:PrintText("Ficha 25A - RESUMO - Cofins - Regime Cumulativo")
				oReport:SkipLine()

				For nX := 1 to Len(aDescr25A)
					nScan := aScan(aWizCum,{|x| x[2]=="Ficha 25A - RESUMO - Cofins - Regime Cumulativo" } )
					cMovimento :=	aDescr25A[nX,1]
					oReport:Section(11):Init()
					oReport:Section(11):Cell("MOVIMENTO"):SetBlock({|| cMovimento })
					oReport:Section(11):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("03,05,06,07,08"),"------------------",nValor4)})
					oReport:Section(11):Cell("VAL01"):Enable()

					If Substr(cMovimento,1,2) $("03,05,06,07,08")
						oReport:Section(7):Cell("VAL01"):SetPicture ("@!")
					Elseif Substr(cMovimento,1,2) $("01")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nCont1 		:= (((aMes[nI][2][8][2]+aMes[nI][2][51][1])-(aMes[nI][2][19][2]+aMes[nI][2][15][2])))*(0.03)
						nCont2 		:= ((aMes[nI][2][9][2]+aMes[nI][2][39][1])-(aMes[nI][2][11][2]+aMes[nI][2][16][2]))*(0.03)
						nValor4 	:= nCont1+nCont2
						nVlrTot25  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("02")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= n09A_25
						nVlrTot25  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("04")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= n10A_25
						nVlrTot25  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("09")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot25
					Elseif Substr(cMovimento,1,2) $("10")
						oReport:Section(11):Cell("VAL01"):Enable()
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][1])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("11")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][2])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("12")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][3])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("13")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][4])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("14")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][5])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("15")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][6])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("16")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][7])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("17")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][8])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("18")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][9])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("19")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][10])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("20")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][11])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("21")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot25
					Elseif Substr(cMovimento,1,2) $("22")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][12])
					Elseif Substr(cMovimento,1,2) $("23")
						oReport:Section(11):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aCumVlrs[nScan][13])
					Elseif cMovimento == "DEDUÇÕES"
   						oReport:Section(11):Cell("VAL01"):Disable()
						oReport:SkipLine()
					Endif

					oReport:Section(11):PrintLine()
				Next
				oReport:Section(11):Finish()
			Next
		Endif





		If mv_par13==2 .And.  (mv_par06==2 .Or.  mv_par06==3)
			For nY:= 1 To 1



				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				Endif
				oReport:SetMeter(1)
		   		oReport:EndPage()

				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				oReport:SkipLine()
				oReport:PrintText("Ficha 15B - RESUMO - Contribuição para o PIS/Pasep - Regime Não Cumulativo")
				oReport:SkipLine()

				For nX := 1 to Len(aDescr15B)
					nScan := aScan(aWizNCum,{|x| x[2]=="Ficha 15B - RESUMO - Contribuição para o PIS/Pasep - Regime Não Cumulativo" } )
					cMovimento :=	aDescr15B[nX,1]
					oReport:Section(10):Init()
					oReport:Section(10):Cell("MOVIMENTO"):SetBlock({|| cMovimento })
					oReport:Section(10):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("03,05,06,07"),"------------------",nValor4)})
					oReport:Section(10):Cell("VAL01"):Enable()

					If Substr(cMovimento,1,2) $("03,05,06,07")
						oReport:Section(7):Cell("VAL01"):SetPicture ("@!")
					Elseif Substr(cMovimento,1,2) $("01")
					    nCont1 		:= ((aMes[nI][2][8][1]+aMes[nI][2][51][1])-(aMes[nI][2][19][1]+aMes[nI][2][15][1]))*0.0165


					    nCont2 		:= ((aMes[nI][2][9][1]+aMes[nI][2][38][1])-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*(0.0165) + (((aMes[nI][2][12][1]+aMes[nI][2][51][1])-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*(0.0065) + ((aMes[nI][2][13][1]+aMes[nI][2][39][1])-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*(0.0065)
						nValor4 	:= nCont1+nCont2
						nVlrTot15  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("02")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= n09A_15
						nVlrTot15  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("04")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= n10A_15
						nVlrTot15  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("08")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot15
					Elseif Substr(cMovimento,1,2) $("09")
						oReport:Section(10):Cell("VAL01"):Enable()
				   		oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][1])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("10")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][2])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("11")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][3])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("12")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][4])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("13")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][5])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("14")
						oReport:Section(10):Cell("VAL01"):Enable()
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][6])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("15")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][7])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("16")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][8])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("17")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot15
					Elseif Substr(cMovimento,1,2) $("18")
						oReport:Section(10):Cell("VAL01"):Enable()
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][9])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("19")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][10])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("20")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][11])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("21")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][12])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("22")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][13])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("23")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][14])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("24")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][15])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("25")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][16])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("26")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][17])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("27")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][18])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("28")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][19])
						nVlrTot15  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("29")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot15
					Elseif Substr(cMovimento,1,2) $("30")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][20])
					Elseif Substr(cMovimento,1,2) $("31")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][21])
					Elseif Substr(cMovimento,1,2) $("32")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][22])
					Elseif cMovimento == "DEDUÇÕES" .Or.  cMovimento == "CRÉDITOS DESCONTADOS REFERENTES A AQUISIÇÕES NO MERCADO INTERNO" .Or.  cMovimento == "CRÉDITOS DESCONTADOS REFERENTES A IMPORTAÇÕES"
   						oReport:Section(10):Cell("VAL01"):Disable()
						oReport:SkipLine()
					Endif

					oReport:Section(10):PrintLine()
				Next
				oReport:Section(10):Finish()
			Next
		Endif




		If mv_par13==2 .And.  (mv_par06==2 .Or.  mv_par06==3)
			For nY:= 1 To 1



				oReport:Section(1):Cell("PERIODO"):SetBlock({|| DtoC(dDtIni)+" a "+DtoC(dDtFin)})
				oReport:Section(1):Cell("MES"):SetBlock({|| Alltrim(MesExtenso(aMes[nI][1]))})

				If mv_par08 == 1
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal " + mv_par10})
				Elseif mv_par08 == 2
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Semestral " + mv_par10})
				Else
					oReport:Section(1):Cell("VALIDADOR"):SetBlock({|| "Dacon Mensal-Semestral " + mv_par10})
				Endif
				oReport:SetMeter(1)
		   		oReport:EndPage()

				oReport:Section(1):Init()
				oReport:Section(1):PrintLine()
				oReport:Section(1):Finish()

				oReport:SkipLine()
				oReport:PrintText("Ficha 25B - Cofins - Regime Não-Cumulativo")
				oReport:SkipLine()

				For nX := 1 to Len(aDescr25B)
					nScan := aScan(aWizNCum,{|x| x[2]=="Ficha 25B - Cofins - Regime Não-Cumulativo" } )
					cMovimento :=	aDescr25B[nX,1]
					oReport:Section(12):Init()
					oReport:Section(12):Cell("MOVIMENTO"):SetBlock({|| cMovimento })
					oReport:Section(12):Cell("VAL01"):SetBlock({||Iif(Substr(cMovimento,1,2)$("03,05,06,07"),"------------------",nValor4)})
					oReport:Section(12):Cell("VAL01"):Enable()

					If Substr(cMovimento,1,2) $("03,05,06,07")
						oReport:Section(7):Cell("VAL01"):SetPicture ("@!")
					Elseif Substr(cMovimento,1,2) $("01")
					    nCont1 		:= ((aMes[nI][2][8][1]+aMes[nI][2][51][1])-(aMes[nI][2][19][1]+aMes[nI][2][15][1]))*0.076


					    nCont2 		:= ((aMes[nI][2][9][1]+aMes[nI][2][38][1])-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*(0.076) + (((aMes[nI][2][12][1]+aMes[nI][2][51][1])-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*(0.076) + ((aMes[nI][2][13][1]+aMes[nI][2][39][1])-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*(0.076)
						nValor4 	:= nCont1+nCont2
						nVlrTot25  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("02")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= n09A_25
						nVlrTot25  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("04")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= n10A_25
						nVlrTot25  	+= nValor4
					Elseif Substr(cMovimento,1,2) $("08")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot25
					Elseif Substr(cMovimento,1,2) $("09")
						oReport:Section(12):Cell("VAL01"):Enable()
				   		oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][1])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("10")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][2])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("11")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][3])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("12")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][4])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("13")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][5])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("14")
						oReport:Section(12):Cell("VAL01"):Enable()
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][6])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("15")
						oReport:Section(10):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][7])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("16")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][8])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("17")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot25
					Elseif Substr(cMovimento,1,2) $("18")
						oReport:Section(12):Cell("VAL01"):Enable()
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][9])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("19")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][10])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("20")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][11])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("21")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][12])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("22")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][13])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("23")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][14])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("24")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][15])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("25")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][16])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("26")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][17])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("27")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][18])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("28")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][19])
						nVlrTot25  	-= nValor4
					Elseif Substr(cMovimento,1,2) $("29")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= nVlrTot25
					Elseif Substr(cMovimento,1,2) $("30")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][20])
					Elseif Substr(cMovimento,1,2) $("31")
						oReport:Section(12):Cell("VAL01"):SetPicture ("@E 99,999,999,999.99")
						nValor4 	:= Val(aNCumVlr[nScan][21])
					Elseif cMovimento == "DEDUÇÕES" .Or.  cMovimento == "CRÉDITOS DESCONTADOS REFERENTES A AQUISIÇÕES NO MERCADO INTERNO" .Or.  cMovimento == "CRÉDITOS DESCONTADOS REFERENTES A IMPORTAÇÕES"
   						oReport:Section(12):Cell("VAL01"):Disable()
						oReport:SkipLine()
					Endif

					oReport:Section(12):PrintLine()
				Next
				oReport:Section(12):Finish()
			Next
		Endif

		oReport:SkipLine()
		oReport:ThinLine()
		oReport:IncMeter()
	Next
Endif

RestArea(aArea)




Return Nil















Function MATR971R3(aMes,aMercado)

Local aCFOPs	:= {}
Local aArea		:= GetArea()
Local aWizard	:=	{}
Local lRet		:= .T. 
Local lDic      := .F. 
Local lComp     := .F. 
Local lFiltro   := .F. 
Local Titulo    := OemToAnsi(If( cPaisLoc $ "ANG|PTG", "Dacon - Recibo De Apuro De Contribuições Sociais", "DACON - Demonstrativo de Apuração de Contribuições Sociais" ))
Local cDesc1    := OemToAnsi("Este relatório emite as informações necessárias ")
Local cDesc2    := OemToAnsi(If( cPaisLoc $ "ANG|PTG", "Para Auxiliar O Preenchimento Do Dacon.", "para auxiliar o preenchimento do DACON." ))
Local cDesc3    := ""
Local cString	:= "SF3"
Local cRegime   := ""
Local wnrel     := "MATR971"
Local nomeprog  := "MATR971"
Local nPagina	:= 1

Private Tamanho := "M"
Private Limite  := 132
Private cPerg   := "MTR971"
Private aReturn := {If( cPaisLoc $ "ANG|PTG", "Código de barras", "Zebrado" ),1,"Administração",1,2,1,"",1}
Private lEnd    := .F. 
Private m_pag   := 1
Private nLastKey:= 0

If Pergunte("MTR971", .T. )




	If Empty(mv_par01) .Or.  Empty(mv_par02) .Or.  (Month(mv_par01)<>Month(mv_par02)) .Or.  (Year(mv_par01)<>Year(mv_par02))
		xMagHelpFis(OemToAnsi("Período Inconsistente!"),OemToAnsi(If( cPaisLoc $ "ANG|PTG", "As perguntas data inicial e data final, foram preenchidas incorrectamente ou não foram devidamente preenchidas.", "As perguntas Data Inicial e Data Final, foram preenchidas incorretamente ou não foram devidamente preenchidas." )),OemToAnsi(If( cPaisLoc $ "ANG|PTG", "As Perguntas Data Inicial E Final, Devem Estar Devidamente Preenchidas, Possuírem O Mesmo Ano E Apenas Será Válida A Periodicidade Mensal.", "As perguntas Data Inicial e Final, devem estar devidamente preenchidas, possuirem o mesmo ano e somente será válida a periodicidade Mensal." )))
		Return Nil
	Else
		If Day(mv_par01) <> 1
			mv_par01 := CtoD("01/"+StrZero(Month(mv_par01),2)+"/"+StrZero(Year(mv_par01),4))
		Endif
		If Day(mv_par02) <> Day(LastDay(mv_par02))
			mv_par02 := CtoD(StrZero(Day(LastDay(mv_par02)),2)+"/"+StrZero(Month(mv_par02),2)+"/"+StrZero(Year(mv_par02),4))
		Endif
	Endif




	If lRet
		wnrel:=SetPrint(cString,wnrel,"",@titulo,cDesc1,cDesc2,cDesc3,lDic,,lComp,Tamanho,lFiltro, .F. )
		If ( nLastKey==27 )
			dbSelectArea(cString)
			dbSetOrder(1)
			dbClearFilter()
			Return
		Endif
		SetDefault(aReturn,cString)
		If ( nLastKey==27 )
			dbSelectArea(cString)
			dbSetOrder(1)
			dbClearFilter()
			Return
		Endif

		RptStatus({|lEnd| ImpDacon(lEnd,wnrel,cString,Tamanho,nPagina,cRegime,Titulo,nomeprog,@aMes,@aMercado)},Titulo)




		dbSelectArea(cString)
		dbClearFilter()
		Set( 20, "SCREEN" )
		Set( 24, "" )

		If ( aReturn[5] = 1 )
			dbCommitAll()
			OurSpool(wnrel)
		Endif
		MS_FLUSH()



	EndIf
Endif

Return














Static Function Wiz_NCum(nPainel10A)

Local aTxtPre 	:= {}
Local aPaineis	:= {}
Local cTitObj1	:= ""
Local nPos		:= 0
Local nCampo	:= 240
Local lRet		:= .F. 
nPainel10A := If( nPainel10A == nil, 0, nPainel10A ) ;




aAdd(aTxtPre,If( cPaisLoc $ "ANG|PTG", "Dacon - Recibo De Apuro De Contribuições Sociais", "DACON - Demonstrativo de Apuração de Contribuições Sociais" ))
aAdd(aTxtPre,"Atenção")
aAdd(aTxtPre,If( cPaisLoc $ "ANG|PTG", "Preencher correctamente as informações solicitadas.", "Preencha corretamente as informações solicitadas." ))
aAdd(aTxtPre,"Este relatório emite as informações necessárias "+If( cPaisLoc $ "ANG|PTG", "Para Auxiliar O Preenchimento Do Dacon - Regime Não Cumulativo", "para auxiliar o preenchimento do DACON - Regime Não Cumulativo" ))




aAdd(aPaineis,{})
nPos :=	Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],If( cPaisLoc $ "ANG|PTG", "Apuramento Dos Créditos Para O Pis/pasep(taxa1,65%) E Cofins(taxa7,6%) - Não Cumulativo", "Apuração dos Créditos para o Pis/Pasep(Aliq.1,65%) e Cofins(Aliq.7,6%) - Não Cumulativo" ))
aAdd(aPaineis[nPos],{})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Base De Cálculo Dos Créditos", "BASE DE CÁLCULO DOS CRÉDITOS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "01.bens Para Revenda", "01.Bens para Revenda" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "02.bens Utilizados Como Recursos", "02.Bens Utilizados como Insumos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "03.serviços Utilizados Como Recursos", "03.Serviços Utilizados como Insumos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "04.despesas De Energia Eléctrica", "04.Despesas de Energia Elétrica" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "05.desp.alug. Prédios Locados De Pj", "05.Desp.Alug. Prédios Locados de PJ" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "06.desp.alug. Maq/equip. Locados De Pj", "06.Desp.Alug. Maq/Equip. Locados de PJ" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "07.desp.armaz. Merc./frete Na Oper. Venda", "07.Desp.Armaz. Merc./Frete na Oper. Venda" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "08.desp. Contraprest. Arrend. Mercantil", "08.Desp. Contraprest. Arrend. Mercantil" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "09.bens Activo Imob.-categorias Desvalorização", "09.Bens Ativo Imob.-Encargos Depreciação" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "10.bens Activo Imob.-valor De Aquisição", "10.Bens Ativo Imob.-Valor de Aquisição" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "11.encategorias Amort.edific. E Benfeitorias", "11.Encargos Amort.Edific. e Benfeitorias" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "12.devol.vendas suj. taxa 1,65/7,6%", "12.Devol.Vendas Suj. Aliq. 1,65/7,6%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. , If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "13.outras Oper. Com Direito Créd.", "13.Outras Oper. com Direito Cred." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Apuração De Outros Créditos", "APURAÇÃO DE OUTROS CRÉDITOS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "16.créd. Calc. A Taxa Diferenciadas", "16.Cred. Calc. a Aliq. Diferenciadas" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "17.créd. Calc. Por Un. De Artigo", "17.Cred. Calc. por Un. de Produto" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "18.créd. Act. Transporte De Cargas", "18.Cred. Ativ. Transporte de Cargas" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "19.créd. Presumido Rel. Est.abertura", "19.Cred. Presumido Rel. Est.Abertura" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "20.créd. Activ.imobiliária", "20.Cred. Ativ.Imobiliária" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "21.outros Créditos A Descontar", "21.Outros Créditos a Descontar" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "22.acordos Positivos De Créditos", "22.Ajustes Positivos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "23.(-)acordos Negativos De Créditos", "23.(-)Ajustes Negativos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Créd.presumid. Activ.agroind.", "CRED.PRESUMID. ATIV.AGROIND." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "25.calculados à taxa de 0,99/4,56%", "25.Calculados a Alíquota de 0,99/4,56%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "26.calculados à taxa de 0,5775/2,66%", "26.Calculados a Alíquota de 0,5775/2,66%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "27.acordos Positivos De Créditos", "27.Ajustes Positivos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "28.(-)acordos Negativos De Créditos", "28.(-)Ajustes Negativos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Créd.decorrentes Aquis.embalagens", "CRED.DECORRENTES AQUIS.EMBALAGENS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "30.créditos Apurados", "30.Créditos Apurados" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "31.acordos Positivos De Créditos", "31.Ajustes Positivos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "32.(-)acordos Negativos De Créditos", "32.(-)Ajustes Negativos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})




aAdd(aPaineis,{})
nPos :=	Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],If( cPaisLoc $ "ANG|PTG", "Cálculo Da Contribuição Para O Segurança Social E Cofins", "Cálculo da Contribuição para o Pis/Pasep e Cofins" ))
aAdd(aPaineis[nPos],{})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Apuramento Pis/pasep E Cofins", "APURAÇÃO PIS/PASEP E COFINS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "01.rec.bens E Serviços-taxa 1,65/7,6%", "01.Rec.Bens e Serviços-Aliq.1,65/7,6%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "02.demais Receitas-taxa 1,65/7,6%", "02.Demais Receitas-Aliq.1,65/7,6%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Outras Receitas Aferidas", "OUTRAS RECEITAS AUFERIDAS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "04.receita Trib. Taxa Zero", "04.Receita Trib. Aliq.Zero" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "05.receita Trib. Taxa Zero-rev.prod.", "05.Receita Trib. Aliq.Zero-Rev.Prod." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "06.receita Vendas Bens Activ.perman.", "06.Receita Vendas Bens Ativ.Perman." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "07.receita Sem Incid.contrib.", "07.Receita Sem Incid.Contrib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "08.receita Isenta Sem Incid.contrib.", "08.Receita Isenta Sem Incid.Contrib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "09.receita Com Susp.contrib.", "09.Receita com Susp.Contrib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "10.receita Revenda Op.subst.trib.", "10.Receita Revenda Op.Subst.Trib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "11.receita Tributada Pelo Ret", "11.Receita Tributada pelo RET" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "12.contrib. Folha Salários", "12.CONTRIB. FOLHA SALÁRIOS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Exclusões- Base De Cálculo", "EXCLUSÕES- BASE DE CÁLCULO" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "13.vendas Canc./descontos(rec.vendas)", "13.Vendas Canc./Descontos(Rec.Vendas)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "14.ipi E Icms/subst. Tributário(rec.vendas)", "14.IPI e ICMS/Subst. Tributario(Rec.Vendas)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "15.vendas Canc./descontos(demais Rec.)", "15.Vendas Canc./Descontos(Demais Rec.)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "16.ipi E Icms/subst.trib.(demais Rec.)", "16.IPI e ICMS/Subst.Trib.(Demais Rec.)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Facturação Mercado Interno", "Faturamento Mercado Interno" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Facturação Mercado Externo", "Faturamento Mercado Externo" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Facturação Mercado Interno-Não Tributada", "Faturamento Mercado Interno-Não Tributada" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
If mv_par09 == 2
	Wiz_IMNC(@aPaineis,nPos,cTitObj1,nCampo)
EndIf




If mv_par07 == 2
	Wizard_AD(@aPaineis,nPos,cTitObj1,nCampo)
Endif




If mv_par12 == 2
	Wizard_10(@aPaineis,nPos,cTitObj1,nCampo)
	nPainel10A	:= len(aPaineis)
Endif

If mv_par13==2
	Wizard_15B(@aPaineis,nPos,cTitObj1,nCampo)
	Wizard_25B(@aPaineis,nPos,cTitObj1,nCampo)
Endif

aWizNCum := aClone(aPaineis)

lRet :=	xMagWizard(aTxtPre,aPaineis,"MTR971")

Return(lRet)













Static Function Wiz_Cum(nPainel10A)

Local aTxtPre	:= {}
Local aPaineis	:= {}
Local cTitObj1	:= ""
Local nPos		:= 0
Local nCampo	:= 240
Local lRet		:= .F. 

nPainel10A := If( nPainel10A == nil, 0, nPainel10A ) ;




aAdd(aTxtPre,If( cPaisLoc $ "ANG|PTG", "Dacon - Recibo De Apuro De Contribuições Sociais", "DACON - Demonstrativo de Apuração de Contribuições Sociais" ))
aAdd(aTxtPre,"Atenção")
aAdd(aTxtPre,If( cPaisLoc $ "ANG|PTG", "Preencher correctamente as informações solicitadas.", "Preencha corretamente as informações solicitadas." ))
aAdd(aTxtPre,"Este relatório emite as informações necessárias "+If( cPaisLoc $ "ANG|PTG", "Para Auxiliar O Preenchimento Do Dacon - Regime Cumulativo", "para auxiliar o preenchimento do DACON - Regime Cumulativo" ))





aAdd(aPaineis,{})
nPos :=	Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],If( cPaisLoc $ "ANG|PTG", "Cálculo Da Contribuição Para O Segurança Social E Cofins", "Cálculo da Contribuição para o Pis/Pasep e Cofins" ))
aAdd(aPaineis[nPos],{})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Apuramento Pis/pasep E Cofins", "APURAÇÃO PIS/PASEP E COFINS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "01.rec.bens E Serviços-taxa 0,65%/cumul.", "01.Rec.Bens e Servicos-Aliq.0,65%/Cumul." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "02.demais Receitas-taxa 0,65%/cumul.", "02.Demais Receitas-Aliq.0,65%/Cumul." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "03.receita Trib. Reg.subst.trib.-taxa 0,65/3%", "03.Receita Trib. Reg.Subst.Trib-Aliq.0,65/3%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Outras Receitas Aferidas", "OUTRAS RECEITAS AUFERIDAS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "05.receita Trib. Taxa Zero", "05.Receita Trib. Aliq.Zero" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "06.receita Trib. Taxa Zero-rev.prod.", "06.Receita Trib. Aliq.Zero-Rev.Prod." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "07.receita Vendas Bens Activ.perman.", "07.Receita Vendas Bens Ativ.Perman." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "08.receita Sem Incid.contrib.", "08.Receita Sem Incid.Contrib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "09.receita Isenta Sem Incid.contrib.", "09.Receita Isenta Sem Incid.Contrib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "10.receita Com Susp.contrib.", "10.Receita com Susp.Contrib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "11.receita Revenda Op.subst.trib.", "11.Receita Revenda Op.Subst.Trib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "12.receita Tributada Pelo Ret", "12.Receita Tributada pelo RET" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "13.contrib. Folha Salários", "13.CONTRIB. FOLHA SALARIOS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Exclusões- Base De Cálculo", "EXCLUSÕES- BASE DE CÁLCULO" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "14.vendas Canc./descontos(rec.vendas)", "14.Vendas Canc./Descontos(Rec.Vendas)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "15.ipi E Icms/subst. Tributário(rec.vendas)", "15.IPI e ICMS/Subst. Tributario(Rec.Vendas)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "16.vendas Canc./descontos(demais Rec.)", "16.Vendas Canc./Descontos(Demais Rec.)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "17.ipi E Icms/subst.trib.(demais Rec.)", "17.IPI e ICMS/Subst.Trib.(Demais Rec.)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

If mv_par09 == 2
	Wiz_IMNC(@aPaineis,nPos,cTitObj1,nCampo)
EndIf




If mv_par07 == 2
	Wizard_AD(@aPaineis,nPos,cTitObj1,nCampo)
Endif




If mv_par12 == 2
	Wizard_10(@aPaineis,nPos,cTitObj1,nCampo)
	nPainel10A	:= len(aPaineis)
Endif

If mv_par13==2
	Wizard_15A(@aPaineis,nPos,cTitObj1,nCampo)
	Wizard_25A(@aPaineis,nPos,cTitObj1,nCampo)
Endif

aWizCum := aClone(aPaineis)

lRet :=	xMagWizard(aTxtPre,aPaineis,"MTR971C")

Return(lRet)















Static Function Wiz_Ambos(nPainel10A)

Local aTxtPre 	:= {}
Local aPaineis	:= {}
Local cTitObj1	:= ""
Local nPos		:= 0
Local nCampo	:= 240
Local lRet		:= .F. 

nPainel10A := If( nPainel10A == nil, 0, nPainel10A ) ;




aAdd(aTxtPre,If( cPaisLoc $ "ANG|PTG", "Dacon - Recibo De Apuro De Contribuições Sociais", "DACON - Demonstrativo de Apuração de Contribuições Sociais" ))
aAdd(aTxtPre,"Atenção")
aAdd(aTxtPre,If( cPaisLoc $ "ANG|PTG", "Preencher correctamente as informações solicitadas.", "Preencha corretamente as informações solicitadas." ))
aAdd(aTxtPre,"Este relatório emite as informações necessárias "+If( cPaisLoc $ "ANG|PTG", "Para Auxiliar O Preenchimento Da Dacon - Regime Não-cumulativo E Cumulativo", "para auxiliar o preenchimento da DACON - Regime Nao-Cumulativo e Cumulativo" ))




aAdd(aPaineis,{})
nPos :=	Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],If( cPaisLoc $ "ANG|PTG", "Apuramento Dos Créditos Para O Pis/pasep(taxa1,65%) E Cofins(taxa7,6%) - Não Cumulativo", "Apuração dos Créditos para o Pis/Pasep(Aliq.1,65%) e Cofins(Aliq.7,6%) - Não Cumulativo" ))
aAdd(aPaineis[nPos],{})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Base De Cálculo Dos Créditos", "BASE DE CÁLCULO DOS CRÉDITOS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "01.bens Para Revenda", "01.Bens para Revenda" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "02.bens Utilizados Como Recursos", "02.Bens Utilizados como Insumos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "03.serviços Utilizados Como Recursos", "03.Serviços Utilizados como Insumos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "04.despesas De Energia Eléctrica", "04.Despesas de Energia Elétrica" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "05.desp.alug. Prédios Locados De Pj", "05.Desp.Alug. Prédios Locados de PJ" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "06.desp.alug. Maq/equip. Locados De Pj", "06.Desp.Alug. Maq/Equip. Locados de PJ" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "07.desp.armaz. Merc./frete Na Oper. Venda", "07.Desp.Armaz. Merc./Frete na Oper. Venda" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "08.desp. Contraprest. Arrend. Mercantil", "08.Desp. Contraprest. Arrend. Mercantil" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "09.bens Activo Imob.-categorias Desvalorização", "09.Bens Ativo Imob.-Encargos Depreciação" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "10.bens Activo Imob.-valor De Aquisição", "10.Bens Ativo Imob.-Valor de Aquisição" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "11.encategorias Amort.edific. E Benfeitorias", "11.Encargos Amort.Edific. e Benfeitorias" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "12.devol.vendas suj. taxa 1,65/7,6%", "12.Devol.Vendas Suj. Aliq. 1,65/7,6%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. , If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "13.outras Oper. Com Direito Créd.", "13.Outras Oper. com Direito Cred." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Apuração De Outros Créditos", "APURAÇÃO DE OUTROS CRÉDITOS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "16.créd. Calc. A Taxa Diferenciadas", "16.Cred. Calc. a Aliq. Diferenciadas" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "17.créd. Calc. Por Un. De Artigo", "17.Cred. Calc. por Un. de Produto" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "18.créd. Act. Transporte De Cargas", "18.Cred. Ativ. Transporte de Cargas" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "19.créd. Presumido Rel. Est.abertura", "19.Cred. Presumido Rel. Est.Abertura" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "20.créd. Activ.imobiliária", "20.Cred. Ativ.Imobiliária" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "21.outros Créditos A Descontar", "21.Outros Créditos a Descontar" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "22.acordos Positivos De Créditos", "22.Ajustes Positivos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "23.(-)acordos Negativos De Créditos", "23.(-)Ajustes Negativos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Créd.presumid. Activ.agroind.", "CRED.PRESUMID. ATIV.AGROIND." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "25.calculados à taxa de 0,99/4,56%", "25.Calculados a Alíquota de 0,99/4,56%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "26.calculados à taxa de 0,5775/2,66%", "26.Calculados a Alíquota de 0,5775/2,66%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "27.acordos Positivos De Créditos", "27.Ajustes Positivos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "28.(-)acordos Negativos De Créditos", "28.(-)Ajustes Negativos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Créd.decorrentes Aquis.embalagens", "CRED.DECORRENTES AQUIS.EMBALAGENS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "30.créditos Apurados", "30.Créditos Apurados" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "31.acordos Positivos De Créditos", "31.Ajustes Positivos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "32.(-)acordos Negativos De Créditos", "32.(-)Ajustes Negativos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})




aAdd(aPaineis,{})
nPos :=	Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],If( cPaisLoc $ "ANG|PTG", "Cálculo da contribuição para o pis/pasep e cofins-regime cumulativo e não cumulativo", "Cálculo da Contribuição para o Pis/Pasep e Cofins-Regime Cumulativo e Não Cumulativo" ))
aAdd(aPaineis[nPos],{})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Regime Não Cumulativo", "REGIME NÃO CUMULATIVO" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "01.rec.bens E Serviços-taxa 1,65/7,6%", "01.Rec.Bens e Serviços-Aliq.1,65/7,6%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "02.demais Receitas-taxa 1,65/7,6%", "02.Demais Receitas-Aliq.1,65/7,6%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Regime Cumulativo", "REGIME CUMULATIVO" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "04.rec. De Bens E Serviços-taxa0,65/3%", "04.Rec.Bens e Serviços-Aliq.0,65/3%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "05.demais Receitas-taxa 0,65/3%", "05.Demais Receitas-Aliq.0,65/3%" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "06.receita Trib.subst.tribut.", "06.Receita Trib.Subst.Tribut." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Outras Receitas Aferidas", "OUTRAS RECEITAS AUFERIDAS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "08.receita Trib. Taxa Zero", "08.Receita Trib. Aliq.Zero" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "09.receita Trib. Taxa Zero-rev.prod.", "09.Receita Trib. Aliq.Zero-Rev.Prod." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "10.receita De Vendas De Bens Activ. Perman.", "10.Receita Vendas Bens Ativ.Perman." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "11.receita Sem Incid.contrib.", "11.Receita Sem Incid.Contrib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "12.receita Isenta Sem Incid.contrib.", "12.Receita Isenta Sem Incid.Contrib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "13.receita Com Susp.contrib.", "13.Receita com Susp.Contrib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "14.receita Revenda Op.subst.trib.", "14.Receita Revenda Op.Subst.Trib." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"15.Receita Tributada pelo RET"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "16.contrib. Remunerações", "16.CONTRIB. FOLHA SALÁRIOS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Eliminações-base De Cálc. De Reg. Não Cumul.", "EXCLUSÕES-BASE CALC. REG. NÃO CUMUL." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "17.vendas Anuladas/descontos(rec. Vendas)", "17.Vendas Canc./Descontos(Rec.Vendas)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "18.IVA E Icms/subst. Tributário(rec. Vendas)", "18.IPI e ICMS/Subst. Tributário(Rec.Vendas)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "19.vendas Anuladas/descontos(demais Rec.)", "19.Vendas Canc./Descontos(Demais Rec.)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "20.iva E Icms/subst.tributário (demais Rec.)", "20.IPI e ICMS/Subst.Trib.(Demais Rec.)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Eliminações-base De Cálc. Reg. Cumulat.", "EXCLUSÕES-BASE CALC. REG.CUMULAT." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "21.vendas Anuladas/descontos(receitas De Vendas)", "21.Vendas Canc./Descontos(Rec.Vendas)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "22.iva E Icms/subst. Tributário(receitas De Vendas)", "22.IPI e ICMS/Subst. Tributário(Rec.Vendas)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "23.vendas Anuladas/descontos(demais Receitas)", "23.Vendas Canc./Descontos(Demais Rec.)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "24.iva E Icms/subst.tributário (demais Receitas)", "24.IPI e ICMS/Subst.Trib.(Demais Rec.)" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Facturação Mercado Interno", "Faturamento Mercado Interno" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Facturação Mercado Externo", "Faturamento Mercado Externo" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Facturação Mercado Interno-Não Tributada", "Faturamento Mercado Interno-Não Tributada" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})


If mv_par09 == 2
	Wiz_IMNC(@aPaineis,nPos,cTitObj1,nCampo)
EndIf




If mv_par07 == 2
	Wizard_AD(@aPaineis,nPos,cTitObj1,nCampo)
Endif




If mv_par12 == 2
	Wizard_10(@aPaineis,nPos,cTitObj1,nCampo)
	nPainel10A	:= len(aPaineis)
Endif

If mv_par13==2
	Wizard_15B(@aPaineis,nPos,cTitObj1,nCampo)
	Wizard_25B(@aPaineis,nPos,cTitObj1,nCampo)
Endif

aWizNCum := aClone(aPaineis)

lRet :=	xMagWizard(aTxtPre,aPaineis,"MTR971A")

Return(lRet)















Static Function Wizard_AD(aPaineis,nPos,cTitObj1,nCampo)




aAdd(aPaineis,{})
nPos :=	Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],If( cPaisLoc $ "ANG|PTG", "Cálculo Da Contribuição Para O Pis/pasep E Cofins - Taxas Diferenciadas", "Cálculo da Contribuição para o Pis/Pasep e Cofins - Alíquotas Diferenciadas" ))
aAdd(aPaineis[nPos],{})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "01.receitas De Vendas", "01.Receitas de Vendas" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Exclusões- Base De Cálculo", "EXCLUSÕES- BASE DE CÁLCULO" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "02.(-)vendas Canc. E Desc.incondic.", "02.(-)Vendas Canc. e Desc.Incondic." )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "03.(-)ipi E Icms/subst. Tributário", "03.(-)IPI e ICMS/Subst. Tributario" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. , If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

Return Nil















Static Function Wizard_10(aPaineis,nPos,cTitObj1,nCampo)




aAdd(aPaineis,{})
nPos :=	Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],If( cPaisLoc $ "ANG|PTG", "Cálculo da Contribuição para o Pis/Pasep - Alíquotas por Unidade de Medida", "Cálculo Da Contribuição Para O Pis/pasep - Aliquotas por Unidade de Medida" ))
aAdd(aPaineis[nPos],{})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "01.receitas De Vendas", "01.Receitas de Vendas" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

Return Nil















Static Function Wizard_15A(aPaineis,nPos,cTitObj1,nCampo)

aAdd(aPaineis,{})
nPos := Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],"Ficha 15A - RESUMO - Contribuição para PIS/Pasep - Regime Cumulativo")
aAdd(aPaineis[nPos],{})

cTitObj1 :=	"DEDUÇÕES"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte por Órgãos, "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Autarquias e Fundações Federais",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte pelas demais"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Entidades da Adm Pública Federal",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte por Pessoas "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Jurídicas de Direito Privado",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte por Órgãos, "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Autarq. e Fund. do Estado, DF e Munic.",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte por Socied."
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Cooperativa",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 := "PIS/Pasep Retida na Fonte por         "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Fabricantes de Veículos e Máquinas",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Substituição pela Não       "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Ocorrência do Fato Gerador Presumido",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Crédito Presumido - Medicamentos      "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 := "Créditos Admit. no Regime Cumulativo  "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Paga pelo Substituto Tribut."
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Outras Deduções                       "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"DE SCP",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"RETIDA DE COOPERADOS",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

Return Nil















Static Function Wizard_25A(aPaineis,nPos,cTitObj1,nCampo)

aAdd(aPaineis,{})
nPos := Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],"Ficha 25A - RESUMO - Cofins - Regime Cumulativo")
aAdd(aPaineis[nPos],{})

cTitObj1 :=	"DEDUÇÕES"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Cofins Retida na Fonte por Órgãos, "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Autarquias e Fundações Federais",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Cofins Retida na Fonte pelas demais"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Entidades da Adm Pública Federal",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Cofins Retida na Fonte por Pessoas "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Jurídicas de Direito Privado",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Cofins Retida na Fonte por Órgãos, "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Autarq. e Fund. do Estado, DF e Munic.",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Cofins Retida na Fonte por Sociedade"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Cooperativa",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 := "Cofins Retida na Fonte por         "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Fabricantes de Veículos e Máquinas",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Cofins Substituição pela Não       "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Ocorrência do Fato Gerador Presumido",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Crédito Presumido - Medicamentos      "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 := "Créditos Admit. no Regime Cumulativo  "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Cofins Paga pelo Substituto Tribut."
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Outras Deduções                       "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"CONTRIBUIÇÃO PARA O Cofins A PAGAR "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"DE SCP",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"CONTRIBUIÇÃO PARA O Cofins A PAGAR "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"RETIDA DE COOPERADOS",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

Return Nil















Static Function Wizard_15B(aPaineis,nPos,cTitObj1,nCampo)

aAdd(aPaineis,{})
nPos := Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],"Ficha 15B - RESUMO - Contribuição para o PIS/Pasep - Regime Não Cumulativo")
aAdd(aPaineis[nPos],{})

aAdd(aPaineis[nPos][3],{1,"CRÉDITOS DESCONTADOS REFERENTES A     ",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{1,"AQUISIÇÕES NO MERCADO INTERNO",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita Tributada no     "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita Não Tributada no "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita de Exportação    "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Presumido - Atividades Agroindustriais"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados a Embalagens para Revenda  "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

aAdd(aPaineis[nPos][3],{1,"CRÉDITOS DESCONTADOS REFERENTES A     ",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{1,"IMPORTAÇÕES",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados a Receita Tributada no     "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita Não Tributada no "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita de Exportação    "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

aAdd(aPaineis[nPos][3],{1,"DEDUÇÕES",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte por Órgãos, "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Autarquias e Fundações Federais",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte pelas Demais"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Entidades da Admin. Pública Federal",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte por Pessoas "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Jurídicas de Direito Privado",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte por Órgãos, "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Autarq. e Fund. dos Estados, DF e Mun.",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte por         "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Sociedade Cooperativa",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Retida na Fonte por         "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Fabricantes de Veículos e Máquinas",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep Substituição pela não       "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"ocorrência do Fato Gerador Presumido",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Crédito Presumido - Medicamentos      "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Créditos Admitidos no Regime Cumulat. "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"PIS/Pasep paga pelo Substituto        "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Tributário",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Outras Deduções                       "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"- FOLHA DE SALÁRIOS",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"DE SCP",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"CONTRIBUIÇAO PARA O PIS/PASEP A PAGAR "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"RETIDA DE COOPERADOS",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})















Static Function Wizard_25B(aPaineis,nPos,cTitObj1,nCampo)

aAdd(aPaineis,{})
nPos := Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],"Ficha 25B - Cofins - Regime Não-Cumulativo")
aAdd(aPaineis[nPos],{})

aAdd(aPaineis[nPos][3],{1,"CRÉDITOS DESCONTADOS REFERENTES A     ",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{1,"AQUISIÇÕES NO MERCADO INTERNO",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita Tributada no     "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita Não Tributada no "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita de Exportação    "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Presumido - Atividades Agroindustriais"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados a Embalagens para Revenda  "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

aAdd(aPaineis[nPos][3],{1,"CRÉDITOS DESCONTADOS REFERENTES A     ",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{1,"IMPORTAÇÕES",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados a Receita Tributada no     "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita Não Tributada no "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Vinculados à Receita de Exportação    "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

aAdd(aPaineis[nPos][3],{1,"DEDUÇÕES",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"COFINS Retida na Fonte por Órgãos, "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Autarquias e Fundações Federais",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"COFINS Retida na Fonte pelas Demais"
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Entidades da Admin. Pública Federal",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"COFINS Retida na Fonte por Pessoas "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Jurídicas de Direito Privado",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"COFINS Retida na Fonte por Órgãos, "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Autarq. e Fund. dos Estados, DF e Mun.",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"COFINS Retida na Fonte por         "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Sociedade Cooperativa",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"COFINS Retida na Fonte por         "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Fabricantes de Veículos e Máquinas",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"COFINS Substituição pela não       "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"ocorrência do Fato Gerador Presumido",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Crédito Presumido - Medicamentos      "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Créditos Admitidos no Regime Cumulat. "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"COFINS paga pelo Substituto        "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Tributário",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"Outras Deduções                       "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"Mercado Interno",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"CONTRIBUIÇÃO PARA O COFINS A PAGAR "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"DE SCP",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	"CONTRIBUIÇAO PARA O COFINS A PAGAR "
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,"@E 9,99,999,999.99",2,2,,,15})
aAdd(aPaineis[nPos][3],{1,"RETIDA DE COOPERADOS",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
















Static Function Wiz_IMNC(aPaineis,nPos,cTitObj1,nCampo)













aAdd(aPaineis,{})
nPos :=	Len(aPaineis)
aAdd(aPaineis[nPos],"Assistente de parametrização")
aAdd(aPaineis[nPos],If( cPaisLoc $ "ANG|PTG", "Apuramento dos créditos para o PIS/PASEP(Alíq.1,65%) e COFINS(Alíq.7,6%) - importação - não cumulativo", "Apuracao dos Creditos para o Pis/Pasep(Aliq.1,65%) e Cofins(Aliq.7,6%) - Importação - Não Cumulativo" ))
aAdd(aPaineis[nPos],{})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Base De Cálculo Dos Créditos", "BASE DE CÁLCULO DOS CRÉDITOS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "01.bens Para Revenda", "01.Bens para Revenda" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "02.bens Utilizados Como Recursos", "02.Bens Utilizados como Insumos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "03.serviços Utilizados Como Recursos", "03.Serviços Utilizados como Insumos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "04.despesas De Energia Eléctrica", "04.Despesas de Energia Elétrica" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "05.Despesas de aluguéres de prédios", "05.Despesas de Aluguéis de Prédios" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "06.Bens activo imob. - Encargos depreciação", "06.Bens Ativo Imob. - Encargos Depreciação" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "07.Bens activo imob. - Valor de aquisição", "07.Bens Ativo Imob. - Valor de Aquisição" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "08.Outras operações com direito a crédito", "08.Outras Operações com Direito a Crédito" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})


cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "Apuração De Outros Créditos", "APURAÇÃO DE OUTROS CRÉDITOS" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "11.Créd. Calc. a Alíq. Diferenciadas", "11.Cred. Calc. a Aliq. Diferenciadas" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "12.Créd. Calc. por Un. de Medida de Artigo", "12.Cred. Calc. por Un. de Medida de Produto" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "13.Créd. Activ. Imobiliária", "13.Cred. Ativ. Imabiliaria" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "14.Outros créditos a descontar", "14.Outros Créditos a Descontar" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "15.Ajustes positivos de créditos", "15.Ajustes Positivos de Créditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< não disponível >>", "<< Não Disponível >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

cTitObj1 :=	If( cPaisLoc $ "ANG|PTG", "17.(-)Ajustes Negativos de Créditos", "17.(-)Ajustes Negativos de Creditos" )
aAdd(aPaineis[nPos][3],{1,cTitObj1,,,,,,})
aAdd(aPaineis[nPos][3],{2,,Replicate("X",nCampo),1,,,,nCampo,{ .T. ,If( cPaisLoc $ "ANG|PTG", "<< processamento automático >>", "<< Processamento Automático >>" )}})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})
aAdd(aPaineis[nPos][3],{0,"",,,,,,})

Return Nil















Function ProcDacon(nVDeprAt,nTotVlMI,nTotVlEX,nBsCrdAqI,nBsCrdAqE,nPercInt,nPercExt,nOutRecN,nOutRecC,nPosMes,lRet,nNTrib,aRecAuf,nRecVen,nVAgrDes,aMercado)

Local aAtivo    := {}
Local aAtAqu    := {}
Local aRelImp2  := MaFisRelImp("MT100",{ "SD2" })
Local aStruSE5  := {}
Local aMes		:= {}
Local aWizard	:= {}
Local lQuery	:= .F. 
Local lProcessa := .F. 
Local lAliqDif	:= .F. 
Local lValido	:= .F. 
Local lConsCmp	:= .F. 
Local lApurac	:= (SF4->(FieldPos("F4_PISFISC")) > 0)
Local lTpRec    := (SF4->(FieldPos("F4_RECDAC")) > 0) .And.  !(Empty(SF4->F4_RECDAC))
Local lTpDes    := (SED->(FieldPos("ED_RECDAC")) > 0)
Local lRegCaixa := SuperGetMv("MV_RGCAIXA", .F. , .F. )
Local cProdAgro := ""
Local cCampoAgro := GetNewPar("MV_PRODAGR","")
Local nX		:= 0
Local nX1		:= 0
Local nBaseCred	:= 0
Local nItemValCont := 0
Local nRegEmp 	:= SM0->(RecNo())
Local nTPReg	:= SuperGetMV("MV_M996TPR",,"")
Local cRegCam	:= Iif(nTPReg == 2,"SB1->B1_TPREG",Iif(nTPReg == 1,"SF4->F4_TPREG","SA1->A1_TPREG"))
Local nTpRegPrd := Iif(nTPReg == 2,SB1->(FieldPos("B1_TPREG")),Iif(nTPReg == 1,SF4->(FieldPos("F4_TPREG")),SA1->(FieldPos("A1_TPREG"))))
Local nPPis		:= 0
Local nPCofins	:= 0
Local nX2       := 0
Local nBasPisPas := 0
Local nPsVlPisSa := 0
Local nPsBsPisSa := 0
Local nPsBsCofSa := 0
Local nBasPisDev := 0
Local nBasCofDev := 0
Local nBasPisCof := 0
Local nValIpiDev := 0
Local nValIcmDev := 0
Local nPag		 := 0
Local nTotAbat   := 0
Local nTamTit	 := TamSX3("E1_PREFIXO")[1]+TamSX3("E1_NUM")[1]+TamSX3("E1_PARCELA")[1]+1
Local nDevol 	 := 0
Local nF		 := 0
Local nI		 := 0
Local nY		 := 0
Local nAlDifCof  := 0
Local nAlDifPis  := 0
Local nScanPis   := 0
Local nScanCof   := 0
Local cCfop01 := cCfop02 := cCfop03 := cCfop04 := cCfop05 := cCfop06 := ""
Local cCfop07 := cCfop08 := cCfop09 := cCfop10 := cCfop11 := cCfop12 := ""
Local cCfop13 := cCfop14 := cCfop15 := cCfop16 := cCfop17 := cCfop18 := ""
Local cCfop22 := cCfop23 := cCfop24 := cCfop25 := cCfop26 := cCfop27 := ""
Local cCfop28 := cCfop29 := cCfop30 := cCfop31 := cCfop32 := cCfop33 := ""
Local cCfop34 := cCfop35 := cCfop36 := cCfop37 := cCfop38 := cCfop39 := ""
Local cCfop40 := cCfop41 := cCfop42 := cCfop43 := cCfop44 := cCfop45 := cCfop46 := ""
Local cChaveF3	:= ""
Local cCFOP   	:= ""
Local cCondicao := ""
Local cAliasSF3 := "SF3"
Local cFilDe    := mv_par04
Local cFilAte   := mv_par05
Local cMVCALC   :=	""
Local cMVCALCAD	:=	""
Local cMVAPUR   :=	""
Local cDebSTCOF := SuperGetMv("MV_DBSTCOF", .F. ,"1")
Local cDebSTPIS := SuperGetMv("MV_DBSTPIS", .F. ,"1")
Local cDebDBCOF := SuperGetMv("MV_DEDBCOF", .F. ,"N")
Local cDebDBPIS := SuperGetMv("MV_DEDBPIS", .F. ,"N")
Local cMVOutRec := SuperGetMv("MV_OUTREC", .F. ,"")
Local cMvRecVen := LeparSeq("MV_RECVEN","")
Local cMVRecAl05 := SuperGetMv("MV_RECALZ1", .F. ,"")
Local cMVRecAl06 := SuperGetMv("MV_RECALZ2", .F. ,"")
Local cMVRecAl07 := SuperGetMv("MV_RECALZ3", .F. ,"")
Local cMVRecAl08 := SuperGetMv("MV_RECALZ4", .F. ,"")
Local cMVRecAl09 := SuperGetMv("MV_RECALZ5", .F. ,"")
Local cMVRecAl10 := SuperGetMv("MV_RECALZ6", .F. ,"")
Local cMVRecAl11 := SuperGetMv("MV_RECALZ7", .F. ,"")
Local cMVRecAl12 := SuperGetMv("MV_RECALZ8", .F. ,"")
Local cMVenergia := SuperGetMv("MV_ENERGIA", .F. ,"")
Local cMValupred := SuperGetMv("MV_ALUPRED", .F. ,"")
Local cMValumaqu := SuperGetMv("MV_ALUMAQU", .F. ,"")

Local cChaveAnt := ""
Local cChaveSe1 := ""
Local cQuery	:= ""
Local cAliasSE5	:= "SE5"
Local cAliasSE1	:= "SE1"
Local cAliasSD2 := "SD2"
Local cAliasSD1 := "SD1"
Local cAliasSF2	:= "SF2"
Local cAliasSF4	:= "SF4"
Local cAliasSB1	:= "SB1"
Local cAliasSA1	:= "SA1"
Local cIndex    := ""
Local cFiltro   := ""
Local cFatura   := ""
Local cCliente  := ""
Local cTpFatura := ""
Local cPrefAnt  := ""
Local cNumAnt   := ""
Local cParcAnt  := ""
Local cTpAnt    := ""
Local cClAnt    := ""
Local cLjAnt    := ""
Local cCpBsPisSa:= ""
Local cCpBsCofSa:= ""
Local cNota		:= ""
Local nValorAbat := 0
Local lFoundD1:= .F. 
Local dDtIni    := mv_par01
Local dDtFin    := mv_par02
Local dDtIDep   := CTOD("  /  /  ")
Local dDtFDep   := CTOD("  /  /  ")
Local dDtFAq    := CTOD("  /  /  ")
Local dDtIAq    := CTOD("  /  /  ")
Local nPainel	:= 0
Local lDacTit	:= GetNewPar("MV_DACTIT", .T. )
Local lPisJaFol := .F. 
Local nValFolSal:= 0
Local aInfFolSal  := {}
Local cDataRefFol := ""
Local aOutrec	:={}
Local nOut 		:= 0
Local cOutRec	:= ""
Local aFilial   := {}
Local nPainel10A	:=0
Local cCampos	:= ""
Local cWhere	:= ""
Local cOrderBy	:= ""
Local cAliasSE2	:= "SE2"
Local cAliasSED	:= "SED"
Local nIndex 	:= 0
Local lTop		:= .T. 


	If TcSrvType() <> "AS/400"
		lTop 	:= .T. 
	Endif





If mv_par06 == 1
	cRegime		:=	"C"
	lRet		:=	Wiz_Cum(@nPainel10A)



	xMagLeWiz("MTR971C",@aWizard, .T. )
	aCumVlrs 	:= aClone(aWizard)
Elseif mv_par06 == 2
	cRegime		:=	"NC"
	lRet		:=	Wiz_NCum(@nPainel10A)



	xMagLeWiz("MTR971",@aWizard, .T. )
	aNCumVlr 	:= aClone(aWizard)
Else
	cRegime		:=	"AMB"
	lRet		:=	Wiz_Ambos(@nPainel10A)



	xMagLeWiz("MTR971A",@aWizard, .T. )
	aNCumVlr 	:= aClone(aWizard)
Endif

If Empty(cFilDe) .And.  Empty(cFilAte)
	cFilDe := cFilAnt
	cFilAte:= cFilAnt
Endif




GeraTmp()



GeraT01()

If lRet




	If mv_par06 ==2



		cCfop01 := Alltrim(aWizard[01][01])
		cCfop02 := Alltrim(aWizard[01][02])
		cCfop03 := Alltrim(aWizard[01][03])
		cCfop04 := Alltrim(aWizard[01][04])
		cCfop05 := Alltrim(aWizard[01][05])
		cCfop06 := Alltrim(aWizard[01][06])
		cCfop07 := Alltrim(aWizard[01][07])
		cCfop08 := Alltrim(aWizard[01][13])
		cCfop15 := Alltrim(aWizard[01][14])
		cCfop46 := Alltrim(aWizard[01][22])



		cCfop09 := Alltrim(aWizard[02][01])
		cCfop10 := Alltrim(aWizard[02][02])
		cCfop36 := Alltrim(aWizard[02][03])
		cCfop37 := Alltrim(aWizard[02][04])
		cCfop38 := Alltrim(aWizard[02][05])
		cCfop40 := Alltrim(aWizard[02][07])
		cCfop41 := Alltrim(aWizard[02][08])
		cCfop42 := Alltrim(aWizard[02][09])
		cCfop43 := Alltrim(aWizard[02][10])
		cCfop22 := Alltrim(aWizard[02][12])
		cCfop12 := Alltrim(aWizard[02][13])
		cCfop13 := Alltrim(aWizard[02][14])
		cCfop14 := Alltrim(aWizard[02][15])
		cCfop17 := Alltrim(aWizard[02][16])
		cCfop16 := Alltrim(aWizard[02][17])
		cCfop44 := Alltrim(aWizard[02][18])



		nPainel := 3
		If mv_par09 ==2



			cCfopB01 := Alltrim(aWizard[nPainel][01])
			cCfopB02 := Alltrim(aWizard[nPainel][02])
			cCfopB03 := Alltrim(aWizard[nPainel][03])
			cCfopB04 := Alltrim(aWizard[nPainel][04])
			cCfopB05 := Alltrim(aWizard[nPainel][05])
			cCfopB08 := Alltrim(aWizard[nPainel][08])
			cCfopB15 := Alltrim(aWizard[nPainel][09])
			nPainel := 4
		EndIf




		If mv_par07 == 2
			cCfop18 := Alltrim(aWizard[nPainel][01])
			cCfop11 := Alltrim(aWizard[nPainel][02])
			if mv_par09 == 2
				nPainel := 5
			EndIf
			if mv_par09 == 1 .and.  mv_par12 == 1
				nPainel := 3
			EndIf
		Endif

		If mv_par12 == 2
			cCfop45 := Alltrim(aWizard[nPainel10A][01])
		Endif





	Elseif mv_par06 ==3



		cCfop01 := Alltrim(aWizard[01][01])
		cCfop02 := Alltrim(aWizard[01][02])
		cCfop03 := Alltrim(aWizard[01][03])
		cCfop04 := Alltrim(aWizard[01][04])
		cCfop05 := Alltrim(aWizard[01][05])
		cCfop06 := Alltrim(aWizard[01][06])
		cCfop07 := Alltrim(aWizard[01][07])
		cCfop08 := Alltrim(aWizard[01][13])
		cCfop15 := Alltrim(aWizard[01][14])




		cCfop23 := Alltrim(aWizard[02][01])
		cCfop24 := Alltrim(aWizard[02][02])

		cCfop25 := Alltrim(aWizard[02][03])
		cCfop26 := Alltrim(aWizard[02][04])
		cCfop35 := Alltrim(aWizard[02][03])

		cCfop36 := Alltrim(aWizard[02][06])
		cCfop37 := Alltrim(aWizard[02][07])
		cCfop38 := Alltrim(aWizard[02][08])
		cCfop39 := Alltrim(aWizard[02][09])
		cCfop40 := Alltrim(aWizard[02][10])
		cCfop41 := Alltrim(aWizard[02][11])
		cCfop42 := Alltrim(aWizard[02][12])
		cCfop43 := Alltrim(aWizard[02][13])

		cCfop27 := Alltrim(aWizard[02][15])
		cCfop28 := Alltrim(aWizard[02][16])
		cCfop29 := Alltrim(aWizard[02][17])
		cCfop30 := Alltrim(aWizard[02][18])

		cCfop31 := Alltrim(aWizard[02][19])
		cCfop32 := Alltrim(aWizard[02][20])
		cCfop33 := Alltrim(aWizard[02][21])
		cCfop34 := Alltrim(aWizard[02][22])

		cCfop17 := Alltrim(aWizard[02][23])
		cCfop16 := Alltrim(aWizard[02][24])
		cCfop44 := Alltrim(aWizard[02][25])



		nPainel := 3
		If mv_par09 ==2



			cCfopB01 := Alltrim(aWizard[nPainel][01])
			cCfopB02 := Alltrim(aWizard[nPainel][02])
			cCfopB03 := Alltrim(aWizard[nPainel][03])
			cCfopB04 := Alltrim(aWizard[nPainel][04])
			cCfopB05 := Alltrim(aWizard[nPainel][05])
			cCfopB08 := Alltrim(aWizard[nPainel][08])
			cCfopB15 := Alltrim(aWizard[nPainel][09])
			nPainel := 4
		EndIf



		If mv_par07 == 2
			cCfop18 := Alltrim(aWizard[nPainel][01])
			cCfop11 := Alltrim(aWizard[nPainel][02])
			if mv_par09 == 2
				nPainel := 5
			EndIf
			if mv_par09 == 1 .and.  mv_par12 == 1
				nPainel := 3
			EndIf
		Endif

		If mv_par12 == 2
			cCfop45 := Alltrim(aWizard[nPainel10A][01])
		Endif
	Else






		cCfop09 := Alltrim(aWizard[01][01])
		cCfop10 := Alltrim(aWizard[01][02])
		cCfop35 := Alltrim(aWizard[01][03])
		cCfop36 := Alltrim(aWizard[01][04])
		cCfop37 := Alltrim(aWizard[01][05])
		cCfop38 := Alltrim(aWizard[01][06])
		cCfop39 := Alltrim(aWizard[01][07])
		cCfop40 := Alltrim(aWizard[01][08])
		cCfop41 := Alltrim(aWizard[01][09])
		cCfop42 := Alltrim(aWizard[01][10])
		cCfop43 := Alltrim(aWizard[01][11])
		cCfop22 := Alltrim(aWizard[01][13])
		cCfop12 := Alltrim(aWizard[01][14])
		cCfop13 := Alltrim(aWizard[01][15])
		cCfop14 := Alltrim(aWizard[01][16])



		nPainel := 2
		If mv_par09 ==2



			cCfopB01 := Alltrim(aWizard[nPainel][01])
			cCfopB02 := Alltrim(aWizard[nPainel][02])
			cCfopB03 := Alltrim(aWizard[nPainel][03])
			cCfopB04 := Alltrim(aWizard[nPainel][04])
			cCfopB05 := Alltrim(aWizard[nPainel][05])
			cCfopB08 := Alltrim(aWizard[nPainel][08])
			cCfopB15 := Alltrim(aWizard[nPainel][09])
			nPainel := 3
		EndIf



		If mv_par07 == 2
			cCfop18 := Alltrim(aWizard[nPainel][01])
			cCfop11 := Alltrim(aWizard[nPainel][02])
			if mv_par09 == 2
				nPainel := 4
			EndIf
			if mv_par09 == 1 .and.  mv_par12 == 1
				nPainel := 2
			EndIf
		Endif
		If mv_par12 == 2
			cCfop45 := Alltrim(aWizard[nPainel10A][01])
		Endif
	Endif

	dbSelectArea("SM0")
	dbSeek(cEmpAnt+cFilDe, .T. )
	while !Eof() .And. FWGrpCompany()==cEmpAnt .and. FWCodFil()<=cFilAte

		cAliasSE5	:= "SE5"
		cAliasSE1	:= "SE1"
		cAliasSD2 	:= "SD2"
		cAliasSD1 	:= "SD1"
		cAliasSF2	:= "SF2"
		cAliasSF4	:= "SF4"
		cAliasSB1	:= "SB1"
		cAliasSA1	:= "SA1"
		cAliasSF3	:=	"SF3"

		DbSelectArea("SX6")
		SX6->(DbSetOrder(1))



		bCond	:=	{|| xFilial("SX6")==SX6->X6_FIL .And.  "MV_CALC97"$SX6->X6_VAR}
		If !SX6->(DbSeek(xFilial("SX6")+"MV_CALC97"))
			SX6->(DbSeek(Space(FWSizeFilial())+"MV_CALC97"))
			bCond	:=	{|| Space(FWSizeFilial())==SX6->X6_FIL .And.  "MV_CALC97"$SX6->X6_VAR}
		EndIf
		while !SX6->(Eof()) .And. Eval(bCond)
			cMVCALC	+=	AllTrim (SX6->X6_CONTEUD)
			SX6->(DbSkip())
		EndDo



		bCond	:=	{|| xFilial("SX6")==SX6->X6_FIL .And.  "MV_APUR97"$SX6->X6_VAR}
		If !SX6->(DbSeek(xFilial("SX6")+"MV_APUR97"))
			SX6->(DbSeek(Space(FWSizeFilial())+"MV_APUR97"))
			bCond	:=	{|| Space(FWSizeFilial())==SX6->X6_FIL .And.  "MV_APUR97"$SX6->X6_VAR}
		EndIf
		while !SX6->(Eof()) .And. Eval(bCond)
			cMVAPUR	+=	AllTrim (SX6->X6_CONTEUD)
			SX6->(DbSkip())
		EndDo



		bCond	:=	{|| xFilial("SX6")==SX6->X6_FIL .And.  "MV_CALCAD"$SX6->X6_VAR}
		If !SX6->(DbSeek(xFilial("SX6")+"MV_CALCAD"))
			SX6->(DbSeek(Space(FWSizeFilial())+"MV_CALCAD"))
			bCond	:=	{|| Space(FWSizeFilial())==SX6->X6_FIL .And.  "MV_CALCAD"$SX6->X6_VAR}
		EndIf
		while !SX6->(Eof()) .And. Eval(bCond)
			cMVCALCAD	+=	AllTrim (SX6->X6_CONTEUD)
			SX6->(DbSkip())
		EndDo

		If !lRegCaixa
			cFilAnt	:=	FWCodFil()

			dbSelectArea("SF3")
			dbSetOrder(1)


			    If TcSrvType()<>"AS/400"
				    lQuery := .T. 
					cAliasSF3 := "QRYSF3"
					aStruSF3  := SF3->(dbStruct())
					cQuery := "SELECT * "
					cQuery += "FROM "+RetSqlName("SF3")+" "
					cQuery += "WHERE F3_FILIAL='"+xFilial("SF3")+"' AND "
					cQuery += "F3_ENTRADA>='"+Dtos(dDtIni)+"' AND "
					cQuery += "F3_ENTRADA<='"+Dtos(dDtFin)+"' AND "
					cQuery += "F3_TIPO <>'P' AND "
					cQuery += "D_E_L_E_T_ = ' ' "


					If !((Empty (MV_PAR03)) .Or.  ("*"$MV_PAR03))
						cQuery += " AND F3_NRLIVRO='"+MV_PAR03+"' "
					EndIf

					cQuery += "ORDER BY "+SqlOrder(SF3->(IndexKey()))

					cQuery := ChangeQuery(cQuery)
					dbUseArea( .T. ,"TOPCONN",TcGenQry(,,cQuery),cAliasSF3)

					For nX := 1 To len(aStruSF3)
						If aStruSF3[nX][2] <> "C" .And.  FieldPos(aStruSF3[nX][1])<>0
							TcSetField(cAliasSF3,aStruSF3[nX][1],aStruSF3[nX][2],aStruSF3[nX][3],aStruSF3[nX][4])
						EndIf
					next
					dbSelectArea(cAliasSF3)
				Else

			    cIndex    := CriaTrab(NIL, .F. )
			    cCondicao := 'F3_FILIAL="'+xFilial("SF3")+'" .And. '
			   	cCondicao += 'DTOS(F3_ENTRADA)>="'+DTOS(dDtIni)+'".And.DTOS(F3_ENTRADA)<="'+DTOS(dDtFin)+'" '
				cCondicao += '.And. F3_TIPO <> "P" '


				If !((Empty (MV_PAR03)) .Or.  ("*"$MV_PAR03))
					cCondicao += ' .AND. F3_NRLIVRO=="'+MV_PAR03+'" '
				EndIf

			    IndRegua(cAliasSF3,cIndex,SF3->(IndexKey()),,cCondicao)
			    nIndex := RetIndex("SF3")



				dbSelectArea("SF3")
			    dbSetOrder(nIndex+1)

			    dbSelectArea(cAliasSF3)
			    ProcRegua(LastRec())
			    dbGoTop()

				Endif


			dbSelectArea(cAliasSF3)
			If !EOF()
				AADD(aFilial,cFilAnt)
			Endif
			while !Eof()
				nPosMes	:=	aScan (aMes, {|aX| aX[1]==Month((cAliasSF3)->F3_ENTRADA)})
				If nPosMes==0
					aAdd (aMes, {Month((cAliasSF3)->F3_ENTRADA), {},{},{}})
					nPosMes	:=	aScan(aMes, {|aX| aX[1]==Month((cAliasSF3)->F3_ENTRADA)})





					For nI := 1 To 52
						aAdd(aMes[nPosMes][2],{0,0,0})
						aAdd(aMes[nPosMes][3],{0,0,0})
					next
				EndIf

			   	while !Eof() .And. aMes[nPosMes][1]==Month((cAliasSF3)->F3_ENTRADA)
			   		lAliqDif := .F. 



			        If Substr((cAliasSF3)->F3_CFO,1,1) <> Substr(cCFOP,1,1) .And.  cCFOP <> ""
			        	cChaveF3 := ""
			        Endif
					If cChaveF3 <> (cAliasSF3)->F3_NFISCAL+(cAliasSF3)->F3_SERIE+(cAliasSF3)->F3_CLIEFOR+(cAliasSF3)->F3_LOJA
						cChaveF3 := (cAliasSF3)->F3_NFISCAL+(cAliasSF3)->F3_SERIE+(cAliasSF3)->F3_CLIEFOR+(cAliasSF3)->F3_LOJA
				         cCFOP    := (cAliasSF3)->F3_CFO

						If Substr((cAliasSF3)->F3_CFO,1,1) < "5"
						    dbSelectArea("SD1")
						    dbSetOrder(1)
						    If dbSeek(xFilial("SD1")+(cAliasSF3)->F3_NFISCAL+(cAliasSF3)->F3_SERIE+(cAliasSF3)->F3_CLIEFOR+(cAliasSF3)->F3_LOJA)

						        While !Eof() .And.  (cAliasSF3)->F3_NFISCAL+(cAliasSF3)->F3_SERIE+(cAliasSF3)->F3_CLIEFOR+(cAliasSF3)->F3_LOJA == SD1->D1_DOC+SD1->D1_SERIE+SD1->D1_FORNECE+SD1->D1_LOJA
						            dbSelectArea("SB1")
						            dbSeek(xFilial("SB1")+SD1->D1_COD)



										SF4->(dbSetOrder(1))
										If ! SF4->(dbSeek(xFilial("SF4")+SD1->D1_TES)) .Or.  SF4->F4_PISCOF == "4" .Or.  AllTrim (SD1->D1_TIPO)$"I"
											dbSelectArea("SD1")
								        	dbSkip()
								        	Loop
										Endif



										If (SF4->F4_PISBRUT=="1" .Or.  SF4->F4_COFBRUT=="1")
											nVAgrDes:=SD1->D1_VALDESC
										Endif







										nItemValCont := 	iif(SD1->D1_BASIMP6>0,SD1->D1_BASIMP6,SD1->D1_TOTAL) + IIF(cDebDBCOF$"SI" .And.  cDebDBPIS$"SI",0,SD1->D1_ICMSRET) + IIf(SF4->F4_AGREG$"I/B",SD1->D1_VALICM,0) - Iif(SD1->D1_BASIMP6>0,0,SD1->D1_VALDESC)










										If (SD1->D1_ICMSRET>0)
											If (SF4->F4_PISCRED<>"3") .And.  (SF4->F4_PISCOF$"23")




												If (cDebSTCOF=="6") .Or.  (SF4->F4_CREDST=="1" .And.  cDebSTCOF=="2") .Or.  (SF4->F4_CREDST=="2" .And.  cDebSTCOF=="3") .Or.  (SF4->F4_CREDICM=="S" .And.  cDebSTCOF=="4") .Or.  (SF4->F4_CREDICM=="N" .And.  cDebSTCOF=="5")
													nItemValCont -= SD1->D1_ICMSRET
												Endif
											Else
											If (SF4->F4_PISCRED<>"3") .And.  (SF4->F4_PISCOF$"13")




												If (cDebSTPIS=="6") .Or.  (SF4->F4_CREDST=="1" .And.  cDebSTPIS=="2") .Or.  (SF4->F4_CREDST=="2" .And.  cDebSTPIS=="3") .Or.  (SF4->F4_CREDICM=="S" .And.  cDebSTPIS=="4") .Or.  (SF4->F4_CREDICM=="N" .And.  cDebSTPIS=="5")
													nItemValCont -= SD1->D1_ICMSRET
												EndIf
											Endif
										EndIf
									EndIf





									If SB1->B1_PPIS <> 1.65 .And.  SB1->B1_PPIS > 0 .And.  SB1->B1_PCOFINS <> 7.6 .And.  SB1->B1_PCOFINS > 0
										lProcessa := .F. 
										nAlDifPis := SB1->B1_PPIS
										nAlDifCof := SB1->B1_PCOFINS
										If mv_par09==2
											If (AllTrim(SD1->D1_CF)$cCfopB15) .And.  Substr(SD1->D1_CF,1,1) == "3"
												aMes[nPosMes][3][1][1]	+=	((nItemValCont*nAlDifPis)/100)
												aMes[nPosMes][3][2][1]	+=	((nItemValCont*nAlDifCof)/100)
								    	    	SD1->(dbSkip())
								        		Loop
											EndIf
										EndIf
										If mv_par06 ==2 .Or.  mv_par06 ==3
											If (AllTrim(SD1->D1_CF)$cCfop15) .Or.  "16-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR
												lProcessa := .T. 
											Endif
											If lProcessa
												If Substr(SD1->D1_CF,1,1) == "3"
													aMes[nPosMes][2][1][2]	+=	((nItemValCont*nAlDifPis)/100)
													aMes[nPosMes][2][2][2]	+=	((nItemValCont*nAlDifCof)/100)
												ElseIf Substr(SD1->D1_CF,1,1) == "1"
													aMes[nPosMes][2][1][1]	+=	((nItemValCont*nAlDifPis)/100)
													aMes[nPosMes][2][2][1]	+=	((nItemValCont*nAlDifCof)/100)
												Else
													aMes[nPosMes][2][1][3]	+=	((nItemValCont*nAlDifPis)/100)
													aMes[nPosMes][2][2][3]	+=	((nItemValCont*nAlDifCof)/100)
												Endif
												dbSelectArea("SD1")
								    	    	dbSkip()
								        		Loop
									    	Endif
									    Endif
									Endif

									If mv_par09 ==2

				            			If ! SD1->D1_TIPO $ "DB" .And.  Substr(SD1->D1_CF,1,1) == "3"

											If (AllTrim(SD1->D1_CF)$cCfopB01)
												aMes[nPosMes][3][3][1]	+=	nItemValCont
											Endif

											If (AllTrim(SD1->D1_CF)$cCfopB02)
												aMes[nPosMes][3][4][1]	+=	nItemValCont
											Endif

											If (AllTrim(SD1->D1_CF)$cCfopB03)
												aMes[nPosMes][3][6][1]	+=	nItemValCont
											Endif

											If (AllTrim(SD1->D1_CF)$cCfopB04)
												aMes[nPosMes][3][5][1]	+=	nItemValCont
											Endif

											If (AllTrim(SD1->D1_CF)$cCfopB05)
												aMes[nPosMes][3][20][1] +=	nItemValCont
											Endif

											If (AllTrim(SD1->D1_CF)$cCfopB08)
												aMes[nPosMes][3][22][1] +=	nItemValCont
											Endif
			    	                    Endif
					          		EndIf
									If mv_par06 ==2 .Or.  mv_par06 ==3
				            			If ! SD1->D1_TIPO $ "DB"

				                           lProcessa := .F. 
											If (AllTrim(SD1->D1_CF)$cCfop01) .Or.  "01-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR
												lProcessa := .T. 
											Endif
					                        If lProcessa
					                           	If lTpRec
                	                               If SF4->F4_RECDAC=="1"
                    	                           		aMes[nPosMes][2][3][1]	+=	nItemValCont
	                                               Elseif SF4->F4_RECDAC=="2"
		                                                aMes[nPosMes][2][3][3]	+=	nItemValCont
        	                                       Elseif SF4->F4_RECDAC=="3"
	            	                               		aMes[nPosMes][2][3][2]	+=	nItemValCont
                    	                           Endif
                        	                    Else
			 										If Substr(SD1->D1_CF,1,1) == "3"
													   	aMes[nPosMes][2][3][2]	+=	nItemValCont
													ElseIf Substr(SD1->D1_CF,1,1) == "2"
													   	aMes[nPosMes][2][3][3]	+=	nItemValCont
													Else
														aMes[nPosMes][2][3][1]	+=	nItemValCont
													Endif
												Endif
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD1->D1_CF)$cCfop02) .Or.  "02-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR
												lProcessa := .T. 
											Endif
										   If lProcessa
					                           	If lTpRec
                	                               If SF4->F4_RECDAC=="1"
                    	                           		aMes[nPosMes][2][4][1]	+=	nItemValCont
	                                               Elseif SF4->F4_RECDAC=="2"
		                                                aMes[nPosMes][2][4][3]	+=	nItemValCont
        	                                       Elseif SF4->F4_RECDAC=="3"
	            	                               		aMes[nPosMes][2][4][2]	+=	nItemValCont
                    	                           Endif
                        	                    Else
			 										If Substr(SD1->D1_CF,1,1) == "3"
													   	aMes[nPosMes][2][4][2]	+=	nItemValCont
													ElseIf Substr(SD1->D1_CF,1,1) == "2"
													   	aMes[nPosMes][2][4][3]	+=	nItemValCont
													Else
														aMes[nPosMes][2][4][1]	+=	nItemValCont
													Endif
												Endif
										   Endif

					                        lProcessa := .F. 
											If ((AllTrim(SD1->D1_CF)$cCfop03) .Or.  "03-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR)
												lProcessa := .T. 
											Endif
										   If lProcessa
					                           	If lTpRec
                	                               If SF4->F4_RECDAC=="1"
                    	                           		aMes[nPosMes][2][6][1]	+=	nItemValCont
	                                               Elseif SF4->F4_RECDAC=="2"
		                                                aMes[nPosMes][2][6][3]	+=	nItemValCont
        	                                       Elseif SF4->F4_RECDAC=="3"
	            	                               		aMes[nPosMes][2][6][2]	+=	nItemValCont
                    	                           Endif
                        	                    Else
			 										If Substr(SD1->D1_CF,1,1) == "3"
													   	aMes[nPosMes][2][6][2]	+=	nItemValCont
													ElseIf Substr(SD1->D1_CF,1,1) == "2"
													   	aMes[nPosMes][2][6][3]	+=	nItemValCont
													Else
														aMes[nPosMes][2][6][1]	+=	nItemValCont
													Endif
												Endif
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD1->D1_CF)$cCfop04) .Or.  "04-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR
												lProcessa := .T. 
											Endif
										   If lProcessa
					                           	If lTpRec
                	                               If SF4->F4_RECDAC=="1"
                    	                           		aMes[nPosMes][2][5][1]	+=	nItemValCont
	                                               Elseif SF4->F4_RECDAC=="2"
		                                                aMes[nPosMes][2][5][3]	+=	nItemValCont
        	                                       Elseif SF4->F4_RECDAC=="3"
	            	                               		aMes[nPosMes][2][5][2]	+=	nItemValCont
                    	                           Endif
                        	                    Else
			 										If Substr(SD1->D1_CF,1,1) == "3"
													   	aMes[nPosMes][2][5][2]	+=	nItemValCont
													ElseIf Substr(SD1->D1_CF,1,1) == "2"
													   	aMes[nPosMes][2][5][3]	+=	nItemValCont
													Else
														aMes[nPosMes][2][5][1]	+=	nItemValCont
													Endif
												Endif
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD1->D1_CF)$cCfop05) .Or.  "05-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR
												lProcessa := .T. 
											Endif
										   If lProcessa
					                           	If lTpRec
                	                               If SF4->F4_RECDAC=="1"
                    	                           		aMes[nPosMes][2][20][1]	+=	nItemValCont
	                                               Elseif SF4->F4_RECDAC=="2"
		                                                aMes[nPosMes][2][20][3]	+=	nItemValCont
        	                                       Elseif SF4->F4_RECDAC=="3"
	            	                               		aMes[nPosMes][2][20][2]	+=	nItemValCont
                    	                           Endif
                        	                    Else
			 										If Substr(SD1->D1_CF,1,1) == "3"
													   	aMes[nPosMes][2][20][2]	+=	nItemValCont
													ElseIf Substr(SD1->D1_CF,1,1) == "2"
													   	aMes[nPosMes][2][20][3]	+=	nItemValCont
													Else
														aMes[nPosMes][2][20][1]	+=	nItemValCont
													Endif
												Endif
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD1->D1_CF)$cCfop06) .Or.  "06-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR
												lProcessa := .T. 
											Endif
										   If lProcessa
					                           	If lTpRec
                	                               If SF4->F4_RECDAC=="1"
                    	                           		aMes[nPosMes][2][21][1]	+=	nItemValCont
	                                               Elseif SF4->F4_RECDAC=="2"
		                                                aMes[nPosMes][2][21][3]	+=	nItemValCont
        	                                       Elseif SF4->F4_RECDAC=="3"
	            	                               		aMes[nPosMes][2][21][2]	+=	nItemValCont
                    	                           Endif
                        	                    Else
			 										If Substr(SD1->D1_CF,1,1) == "3"
													   	aMes[nPosMes][2][21][2]	+=	nItemValCont
													ElseIf Substr(SD1->D1_CF,1,1) == "2"
													   	aMes[nPosMes][2][21][3]	+=	nItemValCont
													Else
														aMes[nPosMes][2][21][1]	+=	nItemValCont
													Endif
												Endif
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD1->D1_CF)$cCfop07) .Or.  "07-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR
												lProcessa := .T. 
											Endif
										   If lProcessa
					                           	If lTpRec
                	                               If SF4->F4_RECDAC=="1"
                    	                           		aMes[nPosMes][2][23][1]	+=	nItemValCont
	                                               Elseif SF4->F4_RECDAC=="2"
		                                                aMes[nPosMes][2][23][3]	+=	nItemValCont
        	                                       Elseif SF4->F4_RECDAC=="3"
	            	                               		aMes[nPosMes][2][23][2]	+=	nItemValCont
                    	                           Endif
                        	                    Else
			 										If Substr(SD1->D1_CF,1,1) == "3"
													   	aMes[nPosMes][2][23][2]	+=	nItemValCont
													ElseIf Substr(SD1->D1_CF,1,1) == "2"
													   	aMes[nPosMes][2][23][3]	+=	nItemValCont
													Else
														aMes[nPosMes][2][23][1]	+=	nItemValCont
													Endif
												Endif
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD1->D1_CF)$cCfop08) .Or.  "13-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR
												lProcessa := .T. 
											Endif
										   If lProcessa
					                           	If lTpRec
                	                               If SF4->F4_RECDAC=="1"
                    	                           		aMes[nPosMes][2][22][1]	+=	nItemValCont
	                                               Elseif SF4->F4_RECDAC=="2"
		                                                aMes[nPosMes][2][22][3]	+=	nItemValCont
        	                                       Elseif SF4->F4_RECDAC=="3"
	            	                               		aMes[nPosMes][2][22][2]	+=	nItemValCont
                    	                           Endif
                        	                    Else
			 										If Substr(SD1->D1_CF,1,1) == "3"
													   	aMes[nPosMes][2][22][2]	+=	nItemValCont
													ElseIf Substr(SD1->D1_CF,1,1) == "2"
													   	aMes[nPosMes][2][22][3]	+=	nItemValCont
													Else
														aMes[nPosMes][2][22][1]	+=	nItemValCont
													Endif
												Endif
										   Endif

			                                lProcessa := .F. 
											If (AllTrim(SD1->D1_CF)$cCfop46) .Or.  "25-"+AllTrim(SD1->D1_TES)+"-"+AllTrim(SD1->D1_CF)$cMVAPUR
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												If SB1->(FieldPos(cCampoAgro)) > 0
		   								   			cProdAgro := SB1->&(cCampoAgro)
													If cProdAgro == "1"
														If Substr(SD1->D1_CF,1,1) == "3"
													    	aMes[nPosMes][2][52][2]	+=	nItemValCont
													    Else
														    aMes[nPosMes][2][52][1]	+=	nItemValCont
														Endif
													Endif
												Endif
										    Endif

										Elseif SD1->D1_TIPO == "D"
											If Substr(SD1->D1_CF,1,1) == "3"
									    		aMes[nPosMes][2][7][2]	+=	nItemValCont
										    Else
										    	If lTpRec
                	                               If SF4->F4_RECDAC=="1"
                    	                           		aMes[nPosMes][2][7][1]	+=	nItemValCont
	                                               Elseif SF4->F4_RECDAC=="2"
		                                                aMes[nPosMes][2][7][2]	+=	nItemValCont
        	                                       Elseif SF4->F4_RECDAC=="3"
	        	                                   		nNTrib 	+=	nItemValCont
	            	                               		aMes[nPosMes][2][50][3] +=	nItemValCont
                    	                           Endif
                        	                    Else
													aMes[nPosMes][2][7][1]	+=	nItemValCont
	                                            Endif
										    Endif
				                        Endif
				                    Endif
							        dbSelectArea("SD1")
						          	dbSkip()
								Enddo
							Endif
						Else

						    dbSelectArea("SD2")
						    dbSetOrder(3)
						    If dbSeek(xFilial("SD2")+(cAliasSF3)->F3_NFISCAL+(cAliasSF3)->F3_SERIE+(cAliasSF3)->F3_CLIEFOR+(cAliasSF3)->F3_LOJA)

						        While !Eof() .And.  (cAliasSF3)->F3_NFISCAL+(cAliasSF3)->F3_SERIE+(cAliasSF3)->F3_CLIEFOR+(cAliasSF3)->F3_LOJA == SD2->D2_DOC+SD2->D2_SERIE+SD2->D2_CLIENTE+SD2->D2_LOJA




									nPPis	:= 0
									nPCofins:= 0
									SB1->(dbSetOrder(1))
									If SB1->(dbSeek(xFilial("SB1")+SD2->D2_COD))


										IF SB1->B1_VLR_PIS > 0 .OR.  SB1->B1_VLR_COF > 0
											nPPis	:= SB1->B1_VLR_PIS
											nPCofins:= SB1->B1_VLR_COF
										Else
											nPPis	:= SB1->B1_PPIS
											nPCofins:= SB1->B1_PCOFINS
											If (nPPis <> 1.65 .And.  nPPis > 0) .Or.  (nPCofins <> 7.6 .And.  nPCofins > 0)
												lAliqDif := .T. 
											Endif
										EndIF
									Endif



									SF4->(dbSetOrder(1))
									If !SF4->(dbSeek(xFilial("SF4")+SD2->D2_TES)) .Or.  (SF4->F4_PISCOF == "4" .And.  !(Left (AllTrim (SD2->D2_CF), 1)=="7"))
								        dbSelectArea("SD2")
							        	dbSkip()
						    	    	Loop
									Endif
									lFoundD1:= .F. 
									If cNota == SD2->D2_DOC
										dbSelectArea(cAliasSD1)
			  							dbgotop()
									else

									    If TcSrvType()<>"AS/400"
										   lQuery := .T. 
											cAliasSD1 := GetNextAlias()
											aStruSD1  := SD1->(dbStruct())
											cQuery := "SELECT * "
											cQuery += "FROM "+RetSqlName("SD1")+" "
											cQuery += "WHERE D1_FILIAL='"+xFilial("SD1")+"' AND "
											cQuery += "D1_EMISSAO>='"+Dtos(SD2->D2_EMISSAO)+"' AND "
											cQuery += "D1_EMISSAO<='"+Dtos(SD2->D2_EMISSAO)+"' AND "
											cQuery += "D1_TIPO ='D' AND "
											cQuery += "D1_NFORI='"+SD2->D2_DOC+"' AND "
											cQuery += "D1_SERIORI='"+SD2->D2_SERIE+"' AND "
											cQuery += "D_E_L_E_T_ = ' ' "
											cQuery += "ORDER BY "+SqlOrder(SD1->(IndexKey()))

											cQuery := ChangeQuery(cQuery)
											dbUseArea( .T. ,"TOPCONN",TcGenQry(,,cQuery),cAliasSD1)
											cNota := SD2->D2_DOC
											dbSelectArea(cAliasSD1)
											dbgotop()
										Else

											cIndex    := CriaTrab(NIL, .F. )
										    cCondicao := 'D1_FILIAL="'+xFilial("SD1")+'" .And. '
											cCondicao += 'Dtos(D1_EMISSAO)>="'+Dtos(SD2->D2_EMISSAO) + '".And.'
										   	cCondicao += 'DTOS(D1_EMISSAO)<="'+DTOS(SD2->D2_EMISSAO)+'".And.'
											cCondicao += 'D1_TIPO = "D".And.'
											cCondicao += 'D1_NFORI="'+SD2->D2_DOC+'".And.'
											cCondicao += 'D1_SERIORI="'+SD2->D2_SERIE+'" '

										    IndRegua(cAliasSD1,cIndex,SD1->(IndexKey()),,cCondicao)
										    nIndex := RetIndex("SD1")



											dbSelectArea("SD1")
										    dbSetOrder(nIndex+1)

										    dbSelectArea(cAliasSD1)
										    ProcRegua(LastRec())
										    dbGoTop()


										Endif


		   							EndIf

								   While !((cAliasSD1)->(Eof()))
										If (StrZero (Val(SD2->D2_ITEM), 2, 0)==StrZero (Val ((cAliasSD1)->D1_ITEMORI), 2, 0))
											lFoundD1   := .T. 
											nValorAbat := SD2->D2_BASEICM - (cAliasSD1)->D1_BASEICM
										Endif
										(cAliasSD1)->(DbSkip())
									EndDo













									nItemValCont := 	SD2->D2_TOTAL + SD2->D2_VALFRE + SD2->D2_SEGURO + SD2->D2_DESPESA + IIF(cDebDBCOF$"SI" .And.  cDebDBPIS$"SI",0,SD2->D2_ICMSRET) + IIf(SF4->F4_AGREG$"I/B",SD2->D2_VALICM,0) + Iif(SD2->D2_BASIMP6>0,0,SD2->D2_DESCON) + SD2->D2_DESCZFR

							      If mv_par06 <> 3



									If !SD2->D2_TIPO $ "DB"

	                                	lProcessa := .F. 
										If (AllTrim(SD2->D2_CF)$cCfop09) .Or.  "01-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
											lProcessa := .T. 
										Endif
	        	                        If lProcessa
									     	If SF4->F4_TPREG=="1"
									     		If lFoundD1
									     			aMes[nPosMes][2][8][1]	+= nValorAbat
									     		Else
									     			aMes[nPosMes][2][8][1]	+= nItemValCont
									     		Endif
									     	else
									       		If lFoundD1
									       			aMes[nPosMes][2][8][2]	+= nValorAbat
									       		else
									       			aMes[nPosMes][2][8][2]	+= nItemValCont
									       		Endif
									   		endif
									    Endif


		                                lProcessa := .F. 
										If (AllTrim(SD2->D2_CF)$cCfop10) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
											lProcessa := .T. 
										Endif
	            	                    If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][9][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][9][2]	+= nItemValCont
									        EndIf
									    Endif

		                                lProcessa := .F. 

										If (AllTrim(SD2->D2_CF)$cCfop35) .Or.  ("02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 1)
											lProcessa := .T. 
										Endif
			            	            If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][28][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][28][2]	+= nItemValCont
									        EndIf
									    Endif

		    		                    lProcessa := .F. 


										If (AllTrim(SD2->D2_CF)$cCfop36) .Or.  ("05-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 1) .Or.  ("04-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 2)
											lProcessa := .T. 
										Endif
		        	                     If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][29][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][29][2]	+= nItemValCont
									      EndIf
									   Endif

				                        lProcessa := .F. 


										If (AllTrim(SD2->D2_CF)$cCfop37) .Or.  ("06-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 1) .Or.  ("05-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 2)
											lProcessa := .T. 
										Endif
	            			            If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][30][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][30][2]	+= nItemValCont
									      EndIf
									   Endif

		                    		    lProcessa := .F. 


										If (AllTrim(SD2->D2_CF)$cCfop38) .Or.  ("07-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 1) .Or.  ("06-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 2)
											lProcessa := .T. 
										Endif
	            	                    If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][31][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][31][2]	+= nItemValCont
									        EndIf
									    Endif

		                                lProcessa := .F. 


										If (AllTrim(SD2->D2_CF)$cCfop39) .Or.  (AllTrim(SD2->D2_CF)$cCfop16) .Or.  ("08-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 1) .Or.  ("07-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 2)
											lProcessa := .T. 
										Endif
	            	                    If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][27][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][27][2]	+= nItemValCont
									        EndIf
									    Endif

		                                lProcessa := .F. 


										If (AllTrim(SD2->D2_CF)$cCfop40) .Or.  ("09-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 1) .Or.  ("08-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 2)
											lProcessa := .T. 
										Endif
	            	                    If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][32][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][32][2]	+= nItemValCont
									        EndIf
									    Endif

		                                lProcessa := .F. 


										If (AllTrim(SD2->D2_CF)$cCfop41) .Or.  ("10-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 1) .Or.  ("09-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 2)
											lProcessa := .T. 
										Endif
	            	                    If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][33][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][33][2]	+= nItemValCont
									        EndIf
									    Endif

		                                lProcessa := .F. 


										If (AllTrim(SD2->D2_CF)$cCfop42) .Or.  ("11-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 1) .Or.  ("10-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 2)
											lProcessa := .T. 
										Endif
	            	                    If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][34][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][34][2]	+= nItemValCont
									        EndIf
									    Endif

		                                lProcessa := .F. 


										If (AllTrim(SD2->D2_CF)$cCfop43) .Or.  ("12-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 1) .Or.  ("11-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC .And.  mv_par06 == 2)
											lProcessa := .T. 
										Endif
	            	                    If lProcessa
											If SF4->F4_TPREG=="1"
												aMes[nPosMes][2][35][1]	+= nItemValCont
											Else
												aMes[nPosMes][2][35][2]	+= nItemValCont
									        EndIf
									    Endif

									    If lPisFolha .And.  !lPisJaFol
									        nValFolSal := Execblock("MTR971F")
									        aMes[nPosMes][2][36][2]	+= nValFolSal
									        lPisJaFol := .T. 
									    EndIf

									ElseIf (SD2->D2_TIPO$"D")


								        If !Empty(SD2->D2_NFORI)
											If Substr(SD2->D2_CF,1,1) == "7"
									    		aMes[nPosMes][2][10][2]	+=	nItemValCont
										    Else
											    aMes[nPosMes][2][10][1]	+=	nItemValCont
										    Endif
	                                    Endif
								    Endif




	            	                lProcessa := .F. 
									If ((AllTrim(SD2->D2_CF)$cCfop12) .Or.  "14-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  SD2->D2_VALIPI+SD2->D2_ICMSRET > 0
										lProcessa := .T. 
									Endif
	       							If lProcessa
										If SF4->F4_TPREG=="1"
										    If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
												aMes[nPosMes][2][15][1]+=	SD2->D2_VALIPI
											Else
												aMes[nPosMes][2][15][1]+=	SD2->D2_VALIPI + SD2->D2_ICMSRET
											Endif
										Else
											If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
												aMes[nPosMes][2][15][2]+=	SD2->D2_VALIPI
											Else
												aMes[nPosMes][2][15][2]+=	SD2->D2_VALIPI + SD2->D2_ICMSRET
											Endif
								        EndIf
								    Endif

	               	                lProcessa := .F. 
									If ((AllTrim(SD2->D2_CF)$cCfop14) .Or.  "16-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  SD2->D2_VALIPI+SD2->D2_ICMSRET > 0
										lProcessa := .T. 
									Endif
	       							If lProcessa
										If SF4->F4_TPREG=="1"
										    If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
												aMes[nPosMes][2][16][1]+=	SD2->D2_VALIPI
											Else
												aMes[nPosMes][2][16][1]+=	SD2->D2_VALIPI + SD2->D2_ICMSRET
											Endif
										Else
											If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
												aMes[nPosMes][2][16][2]+=	SD2->D2_VALIPI
											Else
												aMes[nPosMes][2][16][2]+=	SD2->D2_VALIPI + SD2->D2_ICMSRET
											Endif
								        EndIf
								    Endif
							    Elseif mv_par06== 3











                                	If &(cRegCam) == "3" .And.  SubStr(cRegCam,1,3)=="SF4"
                                		cRegCam := "SB1->B1_TPREG"
                                	EndIf
                                	If nTpRegPrd <> 0 .And.  (&(cRegCam)=="1")
										If !SD2->D2_TIPO $ "DB"

				                           lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop23) .Or.  "01-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		        	    	               If lProcessa
										      aMes[nPosMes][2][8][1]	+= nItemValCont
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop24) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
	        		    		            If lProcessa
												aMes[nPosMes][2][9][1]	+= nItemValCont
									    	Endif

			            		            lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop35) .Or.  "06-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            		    	        If lProcessa
												aMes[nPosMes][2][28][1]	+= nItemValCont
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop36) .Or.  "08-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
				            	            If lProcessa
												aMes[nPosMes][2][29][1]	+= nItemValCont
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop37) .Or.  "09-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
				            	            If lProcessa
												aMes[nPosMes][2][30][1]	+= nItemValCont
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop38) .Or.  "10-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		        		    	            If lProcessa
												aMes[nPosMes][2][31][1]	+= nItemValCont
										   Endif

			            		            lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop39) .Or.  "11-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	        		    If lProcessa
												aMes[nPosMes][2][27][1]	+= nItemValCont
										   Endif

					                        lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop40) .Or.  "12-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][32][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop41) .Or.  "13-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][33][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop42) .Or.  "14-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][34][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop43) .Or.  "15-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][35][1]	+= nItemValCont
										    Endif


									        If lPisFolha .And.  !lPisJaFol
									            nValFolSal := Execblock("MTR971F")
									            aMes[nPosMes][2][36][2]	+= nValFolSal
									            lPisJaFol := .T. 
									        EndIf

										ElseIf (SD2->D2_TIPO$"D")


									        If !Empty(SD2->D2_NFORI)
												If Substr(SD2->D2_CF,1,1) == "7"
										    		aMes[nPosMes][2][10][2]	+=	nItemValCont
											    Else
												    aMes[nPosMes][2][10][1]	+=	nItemValCont
											    Endif
	                            	        Endif
                            	        Endif





		            	                lProcessa := .F. 
										If ((AllTrim(SD2->D2_CF)$cCfop28) .Or.  "18-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  SD2->D2_VALIPI+SD2->D2_ICMSRET > 0
											lProcessa := .T. 
										Endif
	       								If lProcessa
										    If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
												aMes[nPosMes][2][15][1]+=	SD2->D2_VALIPI
											Else
												aMes[nPosMes][2][15][1]+=	SD2->D2_VALIPI + SD2->D2_ICMSRET
											Endif
									    Endif


		               	                lProcessa := .F. 
										If ((AllTrim(SD2->D2_CF)$cCfop30) .Or.  "20-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  SD2->D2_VALIPI+SD2->D2_ICMSRET > 0
											lProcessa := .T. 
										Endif
	       								If lProcessa
										    If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
												aMes[nPosMes][2][16][1]+=	SD2->D2_VALIPI
											Else
												aMes[nPosMes][2][16][1]+=	SD2->D2_VALIPI + SD2->D2_ICMSRET
											Endif
									    Endif




                                	Elseif nTpRegPrd <> 0 .And.  (&(cRegCam)=="2")
										If !SD2->D2_TIPO $ "DB"

		                                	lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop25) .Or.  "04-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
	        	    	                    If lProcessa
										   		aMes[nPosMes][2][12][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop26) .Or.  "05-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
	            		                    If lProcessa
												aMes[nPosMes][2][13][1]	+= nItemValCont
										    	Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop35) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][28][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop36) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][29][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop37) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][30][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop38) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][31][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop39) .Or.  (AllTrim(SD2->D2_CF)$cCfop16) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][27][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop40) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][32][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop41) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][33][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop42) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][34][1]	+= nItemValCont
										    Endif

			                                lProcessa := .F. 
											If (AllTrim(SD2->D2_CF)$cCfop43) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
												lProcessa := .T. 
											Endif
		            	                    If lProcessa
												aMes[nPosMes][2][35][1]	+= nItemValCont
										    Endif


 									        If lPisFolha .And.  !lPisJaFol
									            nValFolSal := Execblock("MTR971F")
									            aMes[nPosMes][2][36][2]	+= nValFolSal
									            lPisJaFol := .T. 
									        EndIf

										ElseIf (SD2->D2_TIPO$"D")


									        If !Empty(SD2->D2_NFORI)
												If Substr(SD2->D2_CF,1,1) == "7"
										    		aMes[nPosMes][2][10][2]	+=	nItemValCont
											    Else
												    aMes[nPosMes][2][10][1]	+=	nItemValCont
											    Endif
	                            	        Endif
										Endif





		            	                lProcessa := .F. 
										If ((AllTrim(SD2->D2_CF)$cCfop32) .Or.  "22-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  SD2->D2_VALIPI+SD2->D2_ICMSRET > 0
											lProcessa := .T. 
										Endif
	       								If lProcessa
										    If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
												aMes[nPosMes][2][25][1]+=	SD2->D2_VALIPI
											Else
												aMes[nPosMes][2][25][1]+=	SD2->D2_VALIPI + SD2->D2_ICMSRET
											Endif
									    Endif

		               	                lProcessa := .F. 
										If ((AllTrim(SD2->D2_CF)$cCfop34) .Or.  "24-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  SD2->D2_VALIPI+SD2->D2_ICMSRET > 0
											lProcessa := .T. 
										Endif
	       								If lProcessa
										    If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
												aMes[nPosMes][2][26][1]+=	SD2->D2_VALIPI
											Else
												aMes[nPosMes][2][26][1]+=	SD2->D2_VALIPI + SD2->D2_ICMSRET
											Endif
									    Endif
                                	Endif
                 				Endif




								If lAliqDif .And. (SD2->D2_VALIPI+SD2->D2_ICMSRET) > 0
									Gravaf09(Month((cAliasSF3)->F3_ENTRADA),"03",nPPis,nPCofins,SD2->D2_ICMSRET+SD2->D2_VALIPI)
								Endif




								If lAliqDif .And.  (AllTrim(SD2->D2_CF)$cCfop18 .Or.  "01-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALCAD)
									Gravaf09(Month((cAliasSF3)->F3_ENTRADA),"01",nPPis,nPCofins)
								Endif




								If lTpRec
									If AllTrim(SD2->D2_CF)$cCfop17 .And.  SF4->F4_RECDAC=="1"
										aMes[nPosMes][2][17][1]+=nItemValCont
									ElseIf AllTrim(SD2->D2_CF)$cCfop16 .And.  SF4->F4_RECDAC=="2"
										aMes[nPosMes][2][18][1]+=nItemValCont
									ElseIf AllTrim(SD2->D2_CF)$cCfop44 .And.  SF4->F4_RECDAC=="3"
										aMes[nPosMes][2][36][1]+=nItemValCont
									Endif
								Else
									If AllTrim(SD2->D2_CF)$cCfop17
									aMes[nPosMes][2][17][1]+=nItemValCont
								ElseIf AllTrim(SD2->D2_CF)$cCfop16
										aMes[nPosMes][2][18][1]+=nItemValCont
									Endif
								Endif




								If (AllTrim(SD2->D2_CF)$cCfop45) .And.  !SF4->F4_SITTRIB$"10/30/60/70"
									Gravaf10(Month((cAliasSF3)->F3_ENTRADA),"01",nPPis,nPCofins)
								Endif

							    dbSelectArea("SD2")
							    dbSkip()



							    cRegCam	:= Iif(nTPReg == 2,"SB1->B1_TPREG",Iif(nTPReg == 1,"SF4->F4_TPREG","SA1->A1_TPREG"))
	        	           Enddo
	            	    Endif

					    dbSelectArea("SF2")
					    dbSetOrder(1)
					    If dbSeek(xFilial("SF2")+(cAliasSF3)->F3_NFISCAL+(cAliasSF3)->F3_SERIE+(cAliasSF3)->F3_CLIEFOR+(cAliasSF3)->F3_LOJA)
						    dbSelectArea("SD2")
						    dbSetOrder(3)
					    	dbSeek(xFilial("SD2")+(cAliasSF3)->F3_NFISCAL+(cAliasSF3)->F3_SERIE+(cAliasSF3)->F3_CLIEFOR+(cAliasSF3)->F3_LOJA)

							If mv_par06 <> 3



					    		If SF2->F2_DESCONT > 0 .Or.  SD2->D2_DESCZFR > 0

						    		lProcessa := .F. 
									If (AllTrim(SD2->D2_CF)$cCfop22) .Or.  "13-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
										lProcessa := .T. 
									Endif
						            If lProcessa
				   				    	If SF4->F4_TPREG=="1"
									    	aMes[nPosMes][2][19][1] +=	SF2->F2_DESCONT + SD2->D2_DESCZFR
								    	Else
									    	aMes[nPosMes][2][19][2] +=	SF2->F2_DESCONT + SD2->D2_DESCZFR
								    	Endif
							    	Endif


						    		lProcessa := .F. 
									If (AllTrim(SD2->D2_CF)$cCfop13) .Or.  "15-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
										lProcessa := .T. 
									Endif
						            If lProcessa
				   				    	If SF4->F4_TPREG=="1"
									    	aMes[nPosMes][2][11][1] +=	SF2->F2_DESCONT + SD2->D2_DESCZFR
								    	Else
									    	aMes[nPosMes][2][11][2] +=	SF2->F2_DESCONT	 + SD2->D2_DESCZFR
								    	Endif
							    	Endif
							    Endif
						    Elseif mv_par06 == 3






                               	If nTpRegPrd <> 0 .And.  (&(cRegCam)=="1")
						    		If SF2->F2_DESCONT > 0 .Or.  SD2->D2_DESCZFR > 0

							    		lProcessa := .F. 
										If (AllTrim(SD2->D2_CF)$cCfop27) .Or.  "17-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
											lProcessa := .T. 
										Endif
							            If lProcessa
									    	aMes[nPosMes][2][19][1] +=	SF2->F2_DESCONT + SD2->D2_DESCZFR
								    	Endif


							    		lProcessa := .F. 
										If (AllTrim(SD2->D2_CF)$cCfop29) .Or.  "19-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
											lProcessa := .T. 
										Endif
							            If lProcessa
									    	aMes[nPosMes][2][11][1] +=	SF2->F2_DESCONT + SD2->D2_DESCZFR
								    	Endif
								    Endif



                               	Elseif nTpRegPrd <> 0 .And.  (&(cRegCam)=="2")
						    		If SF2->F2_DESCONT > 0

							    		lProcessa := .F. 
										If (AllTrim(SD2->D2_CF)$cCfop31) .Or.  "21-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
											lProcessa := .T. 
										Endif
							            If lProcessa
									    	aMes[nPosMes][2][14][1] +=	SF2->F2_DESCONT + SD2->D2_DESCZFR
								    	Endif


							    		lProcessa := .F. 
										If (AllTrim(SD2->D2_CF)$cCfop33) .Or.  "23-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
											lProcessa := .T. 
										Endif
							            If lProcessa
									    	aMes[nPosMes][2][24][1] +=	SF2->F2_DESCONT + SD2->D2_DESCZFR
								    	Endif
								    Endif
								Endif




						    	If lAliqDif .And.  (AllTrim(SD2->D2_CF)$cCfop11 .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALCAD)
									Gravaf09(Month((cAliasSF3)->F3_ENTRADA),"02",nPPis,nPCofins,SF2->F2_DESCONT)
								Endif
							Endif
						Endif
					Endif
			    Endif


			   If cAliasSd1 <> "SD1" .and.  Select(cAliasSd1) > 0
			      (cAliasSd1)->(DbClosearea())
			   Endif

				dbSelectArea(cAliasSF3)
				dbSkip()
			EndDo
		Enddo

		If lQuery
			dbSelectArea(cAliasSF3)
			dbCloseArea()
		Else
		  	dbSelectArea("SF3")
			RetIndex("SF3")
			dbClearFilter()
			Ferase(cIndex+OrdBagExt())
		EndIf

	    dbSelectArea ("SM0")
	    dbSkip()

	Else







		If !Empty( nScanPis := aScan(aRelImp2,{|x| x[1]=="SD2" .And.  x[3]=="IT_BASEPS2"} ) )
			cCpBsPisSa := aRelImp2[nScanPis,2]
			nPsBsPisSa := SD2->(FieldPos(cCpBsPisSa))
		EndIf



		If !Empty( nScanCof := aScan(aRelImp2,{|x| x[1]=="SD2" .And.  x[3]=="IT_BASECF2"} ) )
			cCpBsCofSa := aRelImp2[nScanCof,2]
			nPsBsCofSa := SD2->(FieldPos(cCpBsCofSa))
		EndIf

		cFilAnt	:=	FWCodFil()

		dBSelectArea("SE5")
		(dbSetOrder(1))


			If TcSrvType()<>"AS/400"
				lQuery := .T. 
				cAliasSE5 := "a996AMontSE5"
				aStruSE5  := SE5->(dbStruct())

				cQuery 	:= "SELECT "
				cQuery  += "E5_FILIAL,E5_NUMERO, E5_DATA, E5_VALOR, E5_RECPAG, E5_TIPODOC, E5_PREFIXO, E5_PARCELA, E5_MOTBX, "
				cQuery  +=	"E5_BANCO, E5_AGENCIA, E5_CONTA, E5_NUMCHEQ, E5_TIPO, E5_CLIFOR, E5_LOJA, E5_SEQ, E5_DOCUMEN "
				cQuery 	+= "FROM "+RetSqlName("SE5")+" SE5 "
				cQuery 	+= "WHERE E5_FILIAL='"+xFilial("SE5")+"' AND "
				cQuery 	+= "E5_DATA>='"+Dtos(dDtIni)+"' AND "
				cQuery 	+= "E5_DATA<='"+Dtos(dDtFin)+"' AND "
				cQuery  += "E5_RECPAG = 'R'  AND "
				cQuery  += "E5_TIPODOC IN ('BA','CP','VL','V2','LJ','ES') AND "
				cQuery  += "E5_MOTBX <> 'FAT'  AND "
				cQuery  += "SE5.D_E_L_E_T_ = ' ' "
				cQuery += "ORDER BY "+SqlOrder(SE5->(IndexKey()))

				cQuery := ChangeQuery(cQuery)
				dbUseArea( .T. ,"TOPCONN",TcGenQry(,,cQuery),cAliasSE5, .T. , .T. )

				For nX2 := 1 To len(aStruSE5)
					If aStruSE5[nX2][2] <> "C" .And.  FieldPos(aStruSE5[nX2][1])<>0
						TcSetField(cAliasSE5,aStruSE5[nX2][1],aStruSE5[nX2][2],aStruSE5[nX2][3],aStruSE5[nX2][4])
					EndIf
				next

				dbSelectArea(cAliasSE5)
				dbSelectArea(cAliasSD2)
				nPsBsPisSa := ( cAliasSD2 )->( FieldPos( cCpBsPisSa ) )
				nPsBsCOfSa := ( cAliasSD2 )->( FieldPos( cCpBsCofSa ) )
			Else

				cIndex    := CriaTrab(NIL, .F. )
				cFiltro := "E5_FILIAL=='"+xFilial("SE5")+"'.And."
				cFiltro += "Dtos(E5_DATA)>='" + Dtos(dDtIni) + "'.And."
				cFiltro += "Dtos(E5_DATA)<='" + Dtos(dDtFin) + "'.And."
				cFiltro += "E5_TIPODOC $('BA,CP,VL,V2,LJ,ES') .And. "
				cFiltro += "E5_MOTBX != 'FAT' .And."
				cFiltro += "E5_RECPAG=='R' "

			    IndRegua(cAliasSE5,cIndex,SE5->(IndexKey()),,cFiltro)
				nIndex := RetIndex("SE5")



				dbSelectArea("SE5")
			    dbSetOrder(nIndex+1)

			    dbSelectArea(cAliasSE5)
			    ProcRegua(LastRec())
			    dbGoTop()

			Endif


		dbSelectArea(cAliasSE5)
		If !EOF()
			AADD(aFilial,cFilAnt)
		Endif
		While (cAliasSE5)->(!Eof())
			nPosMes	:= aScan (aMes, {|aX| aX[1]==Month((cAliasSE5)->E5_DATA)})
			If nPosMes==0
				aAdd (aMes, {Month((cAliasSE5)->E5_DATA), {}})
				nPosMes	:=	aScan(aMes, {|aX| aX[1]==Month((cAliasSE5)->E5_DATA)})
				For nI := 1 To 52
					aAdd (aMes[nPosMes][2], {0,0})
				next
			EndIf

	        while (cAliasSE5)->(!Eof()) .And. aMes[nPosMes][1]==Month((cAliasSE5)->E5_DATA)
				lValido := .T. 

			 	If TemBxCanc((cAliasSE5)->E5_PREFIXO+(cAliasSE5)->E5_NUMERO+(cAliasSE5)->E5_PARCELA+(cAliasSE5)->E5_TIPO+(cAliasSE5)->E5_CLIFOR+(cAliasSE5)->E5_LOJA+(cAliasSE5)->E5_SEQ)
					(cAliasSE5)->(dbskip())
					Loop
				EndIf

			    lConsCmp:= .F. 


				If (((cAliasSE5)->E5_MOTBX == "CMP" .And.  SUBSTR((cAliasSE5)->E5_DOCUMEN,nTamTit,3)$MVRECANT)) .Or.  ((cAliasSE5)->E5_MOTBX == "LIQ") .OR.  ((cAliasSE5)->E5_TIPO$MV_CRNEG) .And.  ((cAliasSE5)->E5_MOTBX == "CMP")
		   			lConsCmp := .T. 
				Endif

				If !(cAliasSE5)->E5_MOTBX == "CEC"
					If !lConsCmp .And.  !MovBcoBx((cAliasSE5)->E5_MOTBX, .T. )
						(cAliasSE5)->(dbskip())
						Loop
					Endif
				Endif

				cChaveAnt   :=	(cAliasSE5)->E5_NUMERO+(cAliasSE5)->E5_PREFIXO+(cAliasSE5)->E5_CLIFOR+(cAliasSE5)->E5_LOJA
				cChaveSe1   :=	(cAliasSE5)->E5_CLIFOR+(cAliasSE5)->E5_LOJA+(cAliasSE5)->E5_PREFIXO+(cAliasSE5)->E5_NUMERO+(cAliasSE5)->E5_PARCELA+(cAliasSE5)->E5_TIPO
				cClAnt		:=	(cAliasSE5)->E5_CLIFOR
				cLjAnt		:=	(cAliasSE5)->E5_LOJA

				If ((cAliasSE5)->E5_TIPO$MV_CRNEG) .And.  ((cAliasSE5)->E5_MOTBX == "CMP")
					DbSelectArea("SE1")
					SE1->(dbSetOrder(2))
					SE1->(MsSeek(xFilial("SE1")+(cAliasSE5)->E5_CLIFOR+(cAliasSE5)->E5_LOJA+(cAliasSE5)->E5_PREFIXO+(cAliasSE5)->E5_NUMERO+(cAliasSE5)->E5_PARCELA+(cAliasSE5)->E5_TIPO))
					cChaveSD1   := Iif(lDacTit,(cAliasSE1)->E1_NUM,(cAliasSE1)->E1_NUMNOTA)+(cAliasSE1)->E1_SERIE+(cAliasSE1)->E1_CLIENTE+(cAliasSE1)->E1_LOJA

				    DbSelectArea("SD1")
				    SD1->(dbSetOrder(1))
				    SD1->(MsSeek(xFilial("SD1")+cChaveSD1))



		    		While !((cAliasSD1)->(Eof())) .And.  xFilial("SD1") == (cAliasSD1)->D1_FILIAL .And.  (cAliasSD1)->(D1_DOC+D1_SERIE+D1_FORNECE+D1_LOJA)==cChaveSD1 .And.  (cAliasSD1)->D1_TIPO =="D"
						SF4->(dbSetOrder(1))
						SF4->(MsSeek(xFilial("SF4")+(cAliasSD1)->D1_TES))
							If (cAliasSF4)->F4_AGREG <> "N" .And.  (cAliasSF4)->F4_DUPLIC == "S"
								If (cAliasSF4)->F4_PISCOF <> "4"
									nDevol += (cAliasSD1)->D1_TOTAL
									cChaveAnt:=	(cAliasSD1)->D1_NFORI+(cAliasSD1)->D1_SERIE+(cAliasSD1)->D1_FORNECE+(cAliasSD1)->D1_LOJA
								Endif
							Endif
						(cAliasSD1)->(dbskip())
						Loop
					Enddo
				Endif

				If ((cAliasSE5)->E5_TIPO$MVNOTAFIS)
					nPag 	+= (cAliasSE5)->E5_VALOR
				EndIf
				SE1->(dbSetOrder(2))
				SE1->(MsSeek(xFilial("SE1")+(cAliasSE5)->E5_CLIFOR+(cAliasSE5)->E5_LOJA+(cAliasSE5)->E5_PREFIXO+(cAliasSE5)->E5_NUMERO+(cAliasSE5)->E5_PARCELA+(cAliasSE5)->E5_TIPO))
				nTotAbat  := SumAbatRec((cAliasSE1)->E1_PREFIXO,(cAliasSE1)->E1_NUM,(cAliasSE1)->E1_PARCELA,(cAliasSE1)->E1_MOEDA,"V",(cAliasSE1)->E1_BAIXA)
				nPag += nTotAbat

				If (cAliasSE1)->(E1_CLIENTE+E1_LOJA+E1_PREFIXO+E1_NUM+E1_PARCELA+E1_TIPO)==cChaveSe1



					If (AllTrim ((cAliasSE1)->E1_FATURA)=="NOTFAT")
						cFatura    := (cAliasSE1)->E1_PREFIXO+(cAliasSE1)->E1_NUM
						cCliente   := (cAliasSE1)->E1_CLIENTE+(cAliasSE1)->E1_LOJA
						cTpFatura  := (cAliasSE1)->E1_TIPO



						dbSelectArea("SE1")
						dbSetOrder(10)
						MsSeek(xFilial("SE1")+cCliente+cFatura, .F. )

						While ( !Eof() .And.  xFilial("SE1")==(cAliasSE1)->E1_FILIAL .And.  (cAliasSE1)->E1_CLIENTE+(cAliasSE1)->E1_LOJA+(cAliasSE1)->E1_FATPREF+(cAliasSE1)->E1_FATURA==cCliente+cFatura)
								cChaveAnt:= (cAliasSE1)->E1_NUM+(cAliasSE1)->E1_PREFIXO+(cAliasSE1)->E1_CLIENTE+(cAliasSE1)->E1_LOJA
								cChaveSe1:= (cAliasSE1)->E1_CLIENTE+(cAliasSE1)->E1_LOJA+(cAliasSE1)->E1_PREFIXO+(cAliasSE1)->E1_NUM+(cAliasSE1)->E1_PARCELA+(cAliasSE1)->E1_TIPO
							SE1->(dbSkip())
						EndDo
					EndIf
				EndIf
				cChaveSd2:= cChaveAnt
				If !lDacTit
					cChaveSd2:= (cAliasSE1)->E1_NUMNOTA+(cAliasSE1)->E1_SERIE+(cAliasSE1)->E1_CLIENTE+(cAliasSE1)->E1_LOJA
				Endif
				SD2->(dbSetOrder(3))
				SD2->(MsSeek(xFilial("SD2")+cChaveSd2))
				SF2->(dbSetOrder(1))
				SF2->(MsSeek(xFilial("SF2")+cChaveSd2))
			 	SA1->(dbSetOrder(1))
				SA1->(MsSeek(xFilial("SA1")+cClAnt+cLjAnt))

				While !((cAliasSD2)->(Eof())) .And.  xFilial("SD2") == (cAliasSD2)->D2_FILIAL .And.  (cAliasSD2)->(D2_DOC+D2_SERIE+D2_CLIENTE+D2_LOJA)==cChaveSd2
					SF4->(dbSetOrder(1))
					SF4->(MsSeek(xFilial("SF4")+(cAliasSD2)->D2_TES))
					SB1->(dbSetOrder(1))
					SB1->(MsSeek(xFilial("SB1")+(cAliasSD2)->D2_COD))
					If lApurac
						lValido := (cAliasSF4)->F4_PISFISC<>"2"
					Endif






					If lValido
						If (cAliasSF4)->F4_AGREG <> "N"
							If (cAliasSF4)->F4_PISCOF <> "4"
								If !Empty(nPsBsPisSa) .Or.  !Empty(nPsBsCofSa)
									nBasPisPas := (nPag*(cAliasSD2)->(FieldGet(nPsBsPisSa)))/(cAliasSF2)->F2_VALFAT
									nBasCofins := (nPag*(cAliasSD2)->(FieldGet(nPsBsCofSa)))/(cAliasSF2)->F2_VALFAT
									nValIpi    := (nPag*((cAliasSD2)->D2_VALIPI)/(cAliasSF2)->F2_VALFAT)
									nValIcm    := (nPag*((cAliasSD2)->D2_ICMSRET)/(cAliasSF2)->F2_VALFAT)

									nBasPisDev := (nDevol*(cAliasSD2)->(FieldGet(nPsBsPisSa)))/(cAliasSF2)->F2_VALFAT
									nBasCofDev := (nDevol*(cAliasSD2)->(FieldGet(nPsBsCofSa)))/(cAliasSF2)->F2_VALFAT
									nValIpiDev := (nDevol*((cAliasSD2)->D2_VALIPI)/(cAliasSF2)->F2_VALFAT)
									nValIcmDev := (nDevol*((cAliasSD2)->D2_ICMSRET)/(cAliasSF2)->F2_VALFAT)



									If (cAliasSF4)->F4_PISCOF =="3"
										nBasCofins := 0
										nBasCofDev := 0
									Endif
 									If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
										nItemValCont := nBasPisPas+nBasCofins+nValIpi+nBasPisDev+nBasCofDev+nValIpiDev
									Else
										nItemValCont := nBasPisPas+nBasCofins+nValIpi+nValIcm+nBasPisDev+nBasCofDev+nValIpiDev+nValIcmDev
                                    Endif
								EndIf

								If !(SD2->D2_TIPO $ "DB")

	        	                    lProcessa := .F. 
									If ((AllTrim(SD2->D2_CF)$cCfop09) .Or.  "01-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  Empty((cAliasSD2)->D2_CODISS)
										lProcessa := .T. 
									Endif
	                                If lProcessa
										If SF4->F4_TPREG=="2"
											aMes[nPosMes][2][8][2]	+= nItemValCont
								        EndIf
								    Endif

		                            lProcessa := .F. 
									If ((AllTrim(SD2->D2_CF)$cCfop10) .Or.  "02-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  Empty((cAliasSD2)->D2_CODISS)
										lProcessa := .T. 
									Endif
		                            If lProcessa
										If SF4->F4_TPREG=="2"
											aMes[nPosMes][2][9][2]+=	nItemValCont
								        EndIf
								    Endif


				                    lProcessa := .F. 
									If (AllTrim(SD2->D2_CF)$cCfop22) .Or.  "14-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
										lProcessa := .T. 
									Endif
									If lProcessa
										If SF4->F4_TPREG=="2"
											If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
										 		aMes[nPosMes][2][19][2]+=	nBasPisDev+nValIpiDev
										 	Else
												aMes[nPosMes][2][19][2]+=	nBasPisDev+nValIpiDev+nValIcmDev
										 	Endif
										Endif
									Endif

				                    lProcessa := .F. 
									If (AllTrim(SD2->D2_CF)$cCfop13) .Or.  "16-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC
										lProcessa := .T. 
									Endif
									If lProcessa
										If SF4->F4_TPREG=="2"
											If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
										 		aMes[nPosMes][2][11][2]+=	nBasPisDev+nValIpiDev
										 	Else
												aMes[nPosMes][2][11][2]+=	nBasPisDev+nValIpiDev+nValIcmDev
										 	Endif
										Endif
									Endif
								Endif




		                        lProcessa := .F. 
								If ((AllTrim(SD2->D2_CF)$cCfop12) .Or.  "15-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  SD2->D2_VALIPI+SD2->D2_ICMSRET > 0
									lProcessa := .T. 
								Endif
		       					If lProcessa
									If SF4->F4_TPREG=="2"
										If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
											aMes[nPosMes][2][15][2]+=	nValIpi
										Else
											aMes[nPosMes][2][15][2]+=	nValIpi+nValIcm
										Endif
								    EndIf
							    Endif

		                        lProcessa := .F. 
								If ((AllTrim(SD2->D2_CF)$cCfop14) .Or.  "17-"+AllTrim(SD2->D2_TES)+"-"+AllTrim(SD2->D2_CF)$cMVCALC) .And.  SD2->D2_VALIPI+SD2->D2_ICMSRET > 0
									lProcessa := .T. 
								Endif
		       					If lProcessa
									If SF4->F4_TPREG=="2"
										If (cDebSTCOF=="1") .And.  (cDebSTPIS=="1")
											aMes[nPosMes][2][16][2]+=	nValIpi
										Else
											aMes[nPosMes][2][16][2]+=	nValIpi+nValIcm
										Endif
								    EndIf
								Endif
							Endif
						EndIf
					Endif
				(cAliasSd2)->(dbSkip())
				EndDo
				nPag:=0
				nDevol:=0
			(cAliasSE5)->(dbSkip())
			EndDo
		EndDo
		If lQuery
			dbSelectArea(cAliasSE5)
			dbCloseArea()
		Else
			dbSelectArea("SE5")
			RetIndex("SE5")
			dbClearFilter()
			FErase(cIndex+OrdBagExt())
		EndIf
	    dbSelectArea ("SM0")
	    dbSkip()
	Endif

	Enddo

	SM0->(dbGoTo(nRegEmp))
	cFilAnt := FWCodFil()





	nValFolSal := 0
    If lPisFolSN
	    nValFolSal := Execblock("MTR971S")
	    If ValType(nValFolSal) == "N" .And.  nValFolSal > 0
			nPosMes	:=	aScan (aMes, {|aX| aX[1]==Month(dDtFin)})
			If nPosMes==0
				aAdd (aMes, {Month(dDtFin), {},{}})
				nPosMes	:=	aScan(aMes, {|aX| aX[1]==Month(dDtFin)})
				For nI := 1 To 52
					aAdd(aMes[nPosMes][2],{0,0,0})
					aAdd(aMes[nPosMes][3],{0,0})
				next
			EndIf
			aMes[nPosMes][2][36][2]	+= nValFolSal
	    EndIf
    EndIf

	nX1			:= 0
	nBsCrdAqI	:= 0
	nBsCrdAqE	:= 0
	aRecAuf := {0,0,0,0,0,0,0,0}
	For nF:=1 to Len(aFilial)
		For nY := 1 To Len (aMes)
	        cFilAnt := aFilial[nF]
			dDtIDep	:=	CtoD ("01/"+StrZero(aMes[nY][1],2)+"/"+StrZero(Year(mv_par02),4))



			dDtFDep		:= CtoD (Str(F_UltDia(dDtIDep), 2)+"/"+StrZero (Month (dDtIDep), 2)+"/"+StrZero(Year(mv_par02),4))
		    nX			:= 0
		    nBaseCred	:= 0
			aAtivo 		:= DeprecAtivo(dDtIDep,dDtFDep, .T. ,,,,,,cFilAnt)

			If (ValType(aAtivo)=="A")
				nX        := aAtivo[1]
				nBaseCred := aAtivo[2]
			Else
				nX        := aAtivo
				nBaseCred := 0
			EndIf

			If (nX>0)
				nVDeprAt			+= nX
				aMes[nY][2][49][1] += nX
			Else
				nVDeprAt            += nBaseCred
				aMes[nY][2][49][1] += nBaseCred
			Endif



		 	dDtIAq	:=	CtoD ("01/"+StrZero(aMes[nY][1],2)+"/"+StrZero(Year(mv_par02),4))
			dDtFAq 	:=  CtoD(Str(F_UltDia(dDtIAq),2)+"/"+StrZero(Month(dDtIAq),2)+"/"+StrZero(Year(mv_par02),4))
			aAtAqu  := DeprecAtivo(dDtIAq,dDtFAq, .T. , .T. ,,,,,cFilAnt)
			If Substr(SD1->D1_CF,1,1) == "3"
				If (ValType (aAtAqu)=="A")
					nX1			        += aAtAqu[1]
					nBsCrdAqE  			+= aAtAqu[2]
					aMes[nY][2][37][1] += aAtAqu[2]
				Else
					nX1        += aAtAqu
					nBsCrdAqE  := 0
				EndIf
			Else
				If (ValType (aAtAqu)=="A")
					nX1        			+= aAtAqu[1]
					nBsCrdAqI  			+= aAtAqu[2]
					aMes[nY][2][40][1] += aAtAqu[2]
				Else
					nX1        += aAtAqu
					nBsCrdAqI  := 0
				EndIf
			EndIf




		 	dDtIRec		:=	CtoD ("01/"+StrZero(aMes[nY][1],2)+"/"+StrZero(Year(mv_par02),4))
			dDtFRec		:=	CtoD(Str(F_UltDia(dDtIRec), 2)+"/"+StrZero(Month(dDtIRec), 2)+"/"+StrZero(Year(mv_par02),4))
			nOutRecN	:=	0
			nOutRecC	:=	0
			nRecVen		:=	0
			aOutrec		:=	SEPARA(cMVOutRec,"/")
			dbSelectArea("SE1")
			dbSetOrder(6)
			dbSeek(xFilial("SE1")+DTOS(dDtIRec), .T. )
			While SE1->(E1_EMISSAO)>= dDtIRec .And.  SE1->(E1_EMISSAO) <= dDtFRec .And.  !Eof()
		   		nScan := aScan(aOutrec,{|x| x==Alltrim(SE1->E1_NATUREZ)} )
				If (nScan>0 .And.  !Empty(Alltrim(aOutrec[nScan])))
		  			If mv_par06 <> 3
						If SF4->F4_TPREG=="1"
							nOutRecN			+=	SE1->(E1_VALOR)
						 	aMes[nY][2][38][1]	+=	SE1->(E1_VALOR)
						Else
							nOutRecC			+=	SE1->(E1_VALOR)
						 	aMes[nY][2][39][1]	+=	SE1->(E1_VALOR)
						EndIf
					Else
	                	If nTpRegPrd <> 0 .And.  (&(cRegCam)=="1")
							nOutRecN			+=	SE1->(E1_VALOR)
	   						aMes[nY][2][38][1]	+=	SE1->(E1_VALOR)
						Else
							nOutRecC			+=	SE1->(E1_VALOR)
	   						aMes[nY][2][39][1]	+=	SE1->(E1_VALOR)
						Endif
	                Endif
	            EndIf
				If (AllTrim(SE1->E1_NATUREZ)$cMvRecVen)
		        	nRecVen				+=	SE1->(E1_VALOR)
					aMes[nY][2][51][1] +=	SE1->(E1_VALOR)
				Endif
				SE1->(DbSkip())
		    Enddo



		  	dDtIRec	:=	CtoD("01/"+StrZero(aMes[nY][1],2)+"/"+StrZero(Year(mv_par02),4))
			dDtFRec :=  CtoD(Str(F_UltDia(dDtIRec), 2)+"/"+StrZero(Month(dDtIRec), 2)+"/"+StrZero(Year(mv_par02),4))
			dbSelectArea("SE5")
			dbSetOrder(1)
			dbSeek(xFilial("SE5")+DTOS(dDtIRec), .T. )
 			While SE5->E5_DATA>= dDtIRec .And.  SE5->E5_DATA <= dDtFRec .And.  SE5->E5_FILORIG == cFilAnt .And.  !Eof()
	        	nOut := 0
        	 	If TemBxCanc(SE5->E5_PREFIXO+SE5->E5_NUMERO+SE5->E5_PARCELA+SE5->E5_TIPO+SE5->E5_CLIFOR+SE5->E5_LOJA+SE5->E5_SEQ)
					(cAliasSE5)->( dbskip())
					loop
				EndIf
				For nOut := 1 to Len(aOutrec)
			   		cOutRec	:= aOutrec[nOut]
		        	If mv_par06 == 2
		        		If (AllTrim(SE5->E5_NATUREZ)==cOutRec) .And.  !Empty(cOutRec)
						     nOutRecN				+=	SE5->(E5_VALOR)
						     aMes[nY][2][38][1]	+=	SE5->(E5_VALOR)
						EndIf
					Else
						If (AllTrim(SE5->E5_NATUREZ)==cOutRec) .And.  !Empty(cOutRec)
						     nOutRecC				+=	SE5->(E5_VALOR)
						     aMes[nY][2][39][1]	+=	SE5->(E5_VALOR)
						EndIf
					EndIf
				Next
				If (AllTrim(SE5->E5_NATUREZ)$cMvRecVen) .And.  nRecVen == 0
	                nRecVen				+=	SE5->(E5_VALOR)
				    aMes[nY][2][51][1] +=	SE5->(E5_VALOR)
			    Endif



				If (AllTrim(SE5->E5_NATUREZ)$cMVRecAl05) .and.  SF4->F4_TPREG=="1"
					aRecAuf[1]         += SE5->(E5_VALOR)
	       		   aMes[nY][2][29][1] += SE5->(E5_VALOR)
				Endif



				If (AllTrim(SE5->E5_NATUREZ)$cMVRecAl05)
					DbSelectArea("SE1")
					SE1->(dbSetOrder(2))
					SE1->(MsSeek(xFilial("SE1")+SE5->E5_CLIFOR+SE5->E5_LOJA+SE5->E5_PREFIXO+SE5->E5_NUMERO+SE5->E5_PARCELA+SE5->E5_TIPO))
	         		If !SE1->(Eof())
	         		   aRecAuf[1]			+= SE5->(E5_VALOR)
	         		   aMes[nY][2][41][1]	+= SE5->(E5_VALOR)
					Else

						aRecAuf[1]         += SE5->(E5_VALOR)
		        		aMes[nY][2][41][1] += SE5->(E5_VALOR)
		    		EndIf
			    Endif



				If (AllTrim(SE5->E5_NATUREZ)$cMVRecAl06)
					DbSelectArea("SE1")
					SE1->(dbSetOrder(2))
					SE1->(MsSeek(xFilial("SE1")+SE5->E5_CLIFOR+SE5->E5_LOJA+SE5->E5_PREFIXO+SE5->E5_NUMERO+SE5->E5_PARCELA+SE5->E5_TIPO))
	         		If !SE1->(Eof())
	                   	aRecAuf[2]+=SE5->(E5_VALOR)
	                   	aMes[nY][2][42][1] +=SE5->(E5_VALOR)
				    Else

						aRecAuf[2]			+= SE5->(E5_VALOR)
						aMes[nY][2][42][1] += SE5->(E5_VALOR)
					EndIf
				Endif



				If (AllTrim(SE5->E5_NATUREZ)$cMVRecAl07)
					DbSelectArea("SE1")
					SE1->(dbSetOrder(2))
					SE1->(MsSeek(xFilial("SE1")+SE5->E5_CLIFOR+SE5->E5_LOJA+SE5->E5_PREFIXO+SE5->E5_NUMERO+SE5->E5_PARCELA+SE5->E5_TIPO))
	         		If !SE1->(Eof())
				  		aRecAuf[3] +=SE5->(E5_VALOR)
				  		aMes[nY][2][43][1] +=SE5->(E5_VALOR)
	                Else

						aRecAuf[3]			+= SE5->(E5_VALOR)
						aMes[nY][2][43][1] += SE5->(E5_VALOR)
					EndIf
			    Endif



			    If (AllTrim(SE5->E5_NATUREZ)$cMVRecAl08)
					DbSelectArea("SE1")
					SE1->(dbSetOrder(2))
					SE1->(MsSeek(xFilial("SE1")+SE5->E5_CLIFOR+SE5->E5_LOJA+SE5->E5_PREFIXO+SE5->E5_NUMERO+SE5->E5_PARCELA+SE5->E5_TIPO))
	         		If !SE1->(Eof())
			    		aRecAuf[4]			+= SE5->(E5_VALOR)
			    		aMes[nY][2][44][1] += SE5->(E5_VALOR)
					Else

						aRecAuf[4]			+= SE5->(E5_VALOR)
						aMes[nY][2][44][1] += SE5->(E5_VALOR)
					EndIf
			    Endif



				If (AllTrim(SE5->E5_NATUREZ)$cMVRecAl09)
					DbSelectArea("SE1")
					SE1->(dbSetOrder(2))
					SE1->(MsSeek(xFilial("SE1")+SE5->E5_CLIFOR+SE5->E5_LOJA+SE5->E5_PREFIXO+SE5->E5_NUMERO+SE5->E5_PARCELA+SE5->E5_TIPO))
	         		If !SE1->(Eof())
	         			aRecAuf[5]			+= SE5->(E5_VALOR)
	         			aMes[nY][2][45][1] += SE5->(E5_VALOR)
					Else

		       			aRecAuf[5]			+= SE5->(E5_VALOR)
		       			aMes[nY][2][45][1] += SE5->(E5_VALOR)
		   			EndIf
			    Endif



	   			If (AllTrim(SE5->E5_NATUREZ)$cMVRecAl10)
					DbSelectArea("SE1")
					SE1->(dbSetOrder(2))
					SE1->(MsSeek(xFilial("SE1")+SE5->E5_CLIFOR+SE5->E5_LOJA+SE5->E5_PREFIXO+SE5->E5_NUMERO+SE5->E5_PARCELA+SE5->E5_TIPO))
	         		If !SE1->(Eof())
				  		aRecAuf[6]			+= SE5->(E5_VALOR)
				  		aMes[nY][2][46][1] += SE5->(E5_VALOR)
	                Else

						aRecAuf[6]			+= SE5->(E5_VALOR)
						aMes[nY][2][46][1] += SE5->(E5_VALOR)
					EndIf
			    Endif



			    If (AllTrim(SE5->E5_NATUREZ)$cMVRecAl11)
					DbSelectArea("SE1")
					SE1->(dbSetOrder(2))
					SE1->(MsSeek(xFilial("SE1")+SE5->E5_CLIFOR+SE5->E5_LOJA+SE5->E5_PREFIXO+SE5->E5_NUMERO+SE5->E5_PARCELA+SE5->E5_TIPO))
	         		If !SE1->(Eof())
						aRecAuf[7]			+= SE5->(E5_VALOR)
						aMes[nY][2][47][1] += SE5->(E5_VALOR)
	                Else

						aRecAuf[7]			+= SE5->(E5_VALOR)
						aMes[nY][2][47][1] += SE5->(E5_VALOR)
					EndIf
			    Endif



			    If (AllTrim(SE5->E5_NATUREZ)$cMVRecAl12)
					DbSelectArea("SE1")
					SE1->(dbSetOrder(2))
					SE1->(MsSeek(xFilial("SE1")+SE5->E5_CLIFOR+SE5->E5_LOJA+SE5->E5_PREFIXO+SE5->E5_NUMERO+SE5->E5_PARCELA+SE5->E5_TIPO))
	         		If !SE1->(Eof())
					 	aRecAuf[8] +=SE5->(E5_VALOR)
					 	aMes[nY][2][48][1] +=SE5->(E5_VALOR)
	                Else

						aRecAuf[8]         += SE5->(E5_VALOR)
						aMes[nY][2][47][1] += SE5->(E5_VALOR)
					EndIf
			    Endif
				dbSelectArea("SE5")
				DbSkip()
		    Enddo





			dDtIDe	:=	CtoD ("01/"+StrZero(aMes[nY][1],2)+"/"+StrZero(Year(mv_par02),4))
		   	dDtFDe 	:=  CtoD(Str(F_UltDia(dDtIDe),2)+"/"+StrZero(Month(dDtIDe),2)+"/"+StrZero(Year(mv_par02),4))
			dbSelectArea("SE2")
			dbSetOrder(3)


            IF (mv_par06 == 2 .Or.  mv_par06 == 3) .AND.  lTpDes


					If TcSrvType()<>"AS/400"

						cCampos := "%"
						cWhere 	:= "%"

						cCampos		+= "SE2.E2_VENCREA, SE2.E2_EMISSAO,SE2.E2_NATUREZ,SE2.E2_VALOR,SED.ED_RECDAC "

				   		If !Empty(xFilial("SE2"))
							cWhere+= "SE2.E2_FILIAL = '"+ cFilAnt + "' AND "
						Else
							cWhere+= "SE2.E2_FILIAL= '"+ xFilial("SE2") + "' AND "
							cWhere+= "SE2.E2_FILORIG= '"+ cFilAnt + "' AND "
						EndIf

						cWhere += " SE2.E2_VENCREA >= '" +dTos(dDtIDe)+"' AND"
						cWhere += " SE2.E2_EMISSAO >= '" +dTos(dDtIDe)+"' AND"
						cWhere += " SE2.E2_EMISSAO <= '" +dTos(dDtFDe)+"' AND"
						cWhere += " SED.ED_RECDAC <> '' AND "

						cCampos += "%"
						cWhere  += "%"
						cOrderBy  :=	"%ORDER BY 1,2,3%"
						cAliasSE2 :=	GetNextAlias()















__execSql(cAliasSE2," SELECT  "+___SQLGetValue(CCAMPOS)+" FROM  "+RetSqlName('SE2')+" SE2 INNER JOIN  "+RetSqlName('SED')+" SED ON(SED.ED_FILIAL= '" +xFilial('SED')+"'  AND SED.ED_CODIGO=SE2.E2_NATUREZ AND SED.D_E_L_E_T_= ' ') WHERE  "+___SQLGetValue(CWHERE)+" SE2.D_E_L_E_T_= ' '  "+___SQLGetValue(CORDERBY),{{"E2_EMISSAO","D",8,0},{"E2_VENCREA","D",8,0}},.F.)
					Else

						cIndex	:= CriaTrab(NIL, .F. )
						cFiltro	:= 'DToS(E2_VENCREA)>="'+DToS(dDtIDe)+'" .AND. DToS(E2_EMISSAO)>="'+DToS(dDtIDe)+'" '
						cFiltro += ' .AND. DToS(E2_EMISSAO)<="'+DToS(dDtFDe)+'"'
						If !Empty(xFilial("SE2"))
							cFiltro += ' .AND. E2_FILIAL=="'+cFilAnt+'" '
						Else
							cFiltro += ' .AND. E2_FILIAL=="'+xFilial("SE2") + '" '
							cFiltro += ' .AND. E2_FILORIG=="'+cFilAnt+'" '
						EndIf

					    IndRegua (cAliasSE2, cIndex, SE2->(IndexKey ()),, cFiltro)
					    nIndex := RetIndex(cAliasSE2)





						DbSelectArea (cAliasSE2)
		    			DbSetOrder (nIndex+1)


					Endif


		 		While (cAliasSE2)->(!Eof())
		 		    IF lTop
		 		    	cAliasSED:=cAliasSE2
		 		    Else
		 		    	dbSelectArea("SED")
						SED->(dbSetOrder(1))
						SED->(MsSeek(xFilial("SED")+(cAliasSE2)->E2_NATUREZ))
		 		    EndIF

         	   		If (AllTrim((cAliasSE2)->E2_NATUREZ)$cMVenergia)
           				If (cAliasSED)->ED_RECDAC=="1"
                       	   	aMercado[01][01] += (cAliasSE2)->(E2_VALOR)
                        Elseif (cAliasSED)->ED_RECDAC=="2"
                			aMercado[01][02] += (cAliasSE2)->(E2_VALOR)
                        Elseif (cAliasSED)->ED_RECDAC=="3"
                        	aMercado[01][03] += (cAliasSE2)->(E2_VALOR)
                        Endif
                   	Elseif(AllTrim((cAliasSE2)->E2_NATUREZ)$cMValupred)
                   		If (cAliasSED)->ED_RECDAC=="1"
                       	   	aMercado[02][01] += (cAliasSE2)->(E2_VALOR)
                        Elseif (cAliasSED)->ED_RECDAC=="2"
                			aMercado[02][02] += (cAliasSE2)->(E2_VALOR)
                        Elseif (cAliasSED)->ED_RECDAC=="3"
                        	aMercado[02][03] += (cAliasSE2)->(E2_VALOR)
                        Endif
                   	Elseif (AllTrim((cAliasSE2)->E2_NATUREZ)$cMValumaqu)
                   		If (cAliasSED)->ED_RECDAC=="1"
                       	   	aMercado[03][01] += (cAliasSE2)->(E2_VALOR)
                        Elseif (cAliasSED)->ED_RECDAC=="2"
                			aMercado[03][02] += (cAliasSE2)->(E2_VALOR)
                        Elseif (cAliasSED)->ED_RECDAC=="3"
                        	aMercado[03][03] += (cAliasSE2)->(E2_VALOR)
                        Endif
                	Endif

					(cAliasSE2)->( DBSKIP())
				EndDo


					If (TcSrvType ()<>"AS/400")
						DbSelectArea (cAliasSE2)
						(cAliasSE2)->(DbCloseArea ())
					EndIF

			EndIF

		Next
	Next

	SM0->(dbGoTo(nRegEmp))
	cFilAnt := FWCodFil()
Endif

Return(aMes)














Static Function ImpDacon(lEnd,wnrel,cString,Tamanho,nPagina,cRegime,Titulo,nomeprog,aMes,aMercado)

Local li      	:= 100
Local cCabec1 	:= ""
Local cCabec2 	:= ""
Local cCabec3 	:= ""
Local cCabec4 	:= ""
Local cCabec5 	:= ""
Local cValid	:= ""
Local dDtIni  	:= mv_par01
Local dDtFin  	:= mv_par02
Local nToCreMI 	:= 0
Local nToCreEX 	:= 0
Local nToCreNT 	:= 0
Local nI		:= 0
Local nY		:= 0
Local nVDeprAt	:= 0
Local nTotVlMI 	:= 0
Local nTotVlEX 	:= 0
Local nBsCrdAqI	:= 0
Local nBsCrdAqE	:= 0
Local nPercInt  := 0
Local nPercExt  := 0
Local nPercNTr  := 0
Local nOutRecN  := 0
Local nOutRecC  := 0
Local nCont1	:= 0
Local nCont2	:= 0
Local nCont3    := 0
Local nAjusMI	:= 0
Local nAjusEX	:= 0
Local aRecAuf   := {}
Local nAjusNT	:= 0
Local nNTrib	:= 0
Local nPis		:= 0
Local nCof		:= 0
Local nItem1	:= 0
Local nItem2	:= 0
Local nItem3	:= 0
Local nQuant	:= 0
Local n09A_15   := 0
Local n09A_25   := 0
Local n10A_15   := 0
Local n10A_25   := 0
Local nVlrTot   := 0
Local nTotVlNTr := 0



aMercado := If( aMercado == nil, {}, aMercado ) ;

aMercado  := {{0,0,0},{0,0,0},{0,0,0}}




aMes:= ProcDacon(@nVDeprAt,@nTotVlMI,@nTotVlEX,@nBsCrdAqI,@nBsCrdAqE,@nPercInt,@nPercExt,@nOutRecN,@nOutRecC,,,@nNTrib,@aRecAuf,,@nVAgrDes,@aMercado)



If mv_par08 == 1
	cValid := "Dacon Mensal " + mv_par10
Elseif mv_par08 ==	2
	cValid := "Dacon Semestral " + mv_par10
Else
	cValid := "Dacon Mensal-Semestral " +mv_par10
Endif

cCabec1 := If( cPaisLoc $ "ANG|PTG", "Nr. contribuinte.: ", "CNPJ.: " )+TRANSFORM(SM0->M0_CGC,"@R 99.999.999/9999-99")+"  -  "+cValid+Space(05)+"Periodo: "+DtoC(dDtIni)+" a "+DtoC(dDtFin)
cCabec2 := If( cPaisLoc $ "ANG|PTG", "Discriminação                                                                    Trib.mer.interno   Não Trib.merc.interno  Exportação", "Discriminacao                                                                    Trib.Mer.Interno   Não Trib.Merc.Interno  Exportação" )
cCabec3 := cCabec1
cCabec4 := If( cPaisLoc $ "ANG|PTG", "Discriminação                                                                          receita     base de cálculo    contribuição ", "Discriminação                                                                          Receita     Base de Cálculo    Contribuição " )
cCabec5 := cCabec2
cCabec6 := "Discriminação                                                                                                           Valor "




For nI := 1 To Len (aMes)




	nTotVlMI :=0
	nTotVlMI += aMes[nI][2][3][1] + aMes[nI][2][4][1]+aMes[nI][2][6][1]+aMes[nI][2][5][1]+aMes[nI][2][20][1]+aMes[nI][2][21][1]+aMes[nI][2][22][1]+aMes[nI][2][23][1]+nBsCrdAqI+nVDeprAt
	nTotVlEX :=0
	nTotVlEX += aMes[nI][2][3][2]+aMes[nI][2][4][2]+aMes[nI][2][6][2]+aMes[nI][2][5][2]+aMes[nI][2][20][2]+aMes[nI][2][21][2]+aMes[nI][2][22][2]+aMes[nI][2][23][2]+nBsCrdAqE+nVDeprAt
    nTotVlNTr:=0
    nTotVlNTr += aMes[nI][2][3][3]





	If aMes[nI][2][17][1] <> 0 .Or.  aMes[nI][2][18][1] <> 0 .Or.  aMes[nI][2][36][1] <> 0
		nPercInt := aMes[nI][2][17][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
		nPercExt := aMes[nI][2][18][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
		nPercNTr := aMes[nI][2][36][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
	Else
       	nPercInt := 1
       	nPercNTr := 1
	Endif




	If mv_par06 ==2
		For nY:= 1 To 4
			If nY == 3 .Or.  nY == 1
				cCabec1:= cCabec3+" - "+Alltrim(MesExtenso(aMes[nI][1]))+Space(10)+"Vinculados à Receita"
				cCabec2:= cCabec5
			ElseIf nY == 2 .Or.  nY == 4
				cCabec1:= cCabec3+" - "+Alltrim(MesExtenso(aMes[nI][1]))
				cCabec2:= If( cPaisLoc $ "ANG|PTG", "Discriminação                                                                          receita     base de cálculo    contribuição ", "Discriminação                                                                          Receita     Base de Cálculo    Contribuição " )
			Endif

			li := cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
			li++

			If nY == 1 .Or.  nY == 3
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","Ficha 06a - Apuramento Dos Créditos De Pis/pasep – Aquisições No Mercado Interno - Regime Não Cumulativo","Ficha 06A - Apuração dos Créditos de PIS/PASEP - Aquisições no Mercado Interno - Regime Não Cumulativo"),If(cPaisLoc$"ANG|PTG","Ficha 16a - Apuramento Dos Créditos Da Cofins - Aquisições No Mercado Interno - Regime Não Cumulativo","Ficha 16A - Apuração dos Créditos da COFINS - Aquisições no Mercado Interno - Regime Não Cumulativo")),,)
			ElseIf nY == 2 .Or.  nY == 4
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","Ficha 07a - Cálculo Da Contribuição Para O Pis/pasep - Regime Não Cumulativo","Ficha 07A - Cálculo da Contribuição para o PIS/PASEP - Regime Não Cumulativo"),If(cPaisLoc$"ANG|PTG","Ficha 17a - Cálculo Da Cofins - Regime Não Cumulativo","Ficha 17A - Cálculo da Cofins - Regime Não Cumulativo")),,)
			Endif
			li++
			PrintOut(Li,000,Repli("-",Limite),,)
			li++




			If (nY ==1 .Or.  nY ==3)
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE")+" 1,65%",If(cPaisLoc$"ANG|PTG","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE")+" 7,6%"),,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","01.bens Para Revenda","01.Bens para Revenda"),,)
				PrintOut(Li,080,(aMes[nI][2][3][1]+aMes[nI][2][3][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,aMes[nI][2][3][3],"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][3][1]+aMes[nI][2][3][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","02.bens Utilizados Como Recursos","02.Bens Utilizados como Insumos"),,)
				PrintOut(Li,080,(aMes[nI][2][4][1]+aMes[nI][2][4][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][4][3]+aMes[nI][2][4][2])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][4][1]+aMes[nI][2][4][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","03.serviços Utilizados Como Recursos","03.Serviços Utilizados como Insumos"),,)
				PrintOut(Li,080,(aMes[nI][2][6][1]+aMes[nI][2][6][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][6][3]+aMes[nI][2][6][2])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][6][1]+aMes[nI][2][6][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","04.despesas De Energia Eléctrica","04.Despesas de Energia Elétrica"),,)
				PrintOut(Li,080,(aMes[nI][2][5][1]+aMes[nI][2][5][2])*nPercInt+aMercado[01][01],"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][5][3]+aMes[nI][2][5][2])*nPercNTr+aMercado[01][02],"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][5][1]+aMes[nI][2][5][2])*nPercExt+aMercado[01][03],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","05.despesas De Alugueres De Prédios Arrendados De Pessoas Jurídicas","05.Despesas de Aluguéis de Prédios Locados de Pessoas Jurídicas"),,)
				PrintOut(Li,080,(aMes[nI][2][20][1]+aMes[nI][2][20][2])*nPercInt+aMercado[02][01],"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][20][3]+aMes[nI][2][20][2])*nPercNTr+aMercado[02][02],"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][20][1]+aMes[nI][2][20][2])*nPercExt+aMercado[02][03],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","06.Despesas De Alugueres De Máquinas E Equipamentos Arrendados De Pessoas Jurídicas","06.Despesas de Aluguéis de Máquinas e Equipamentos Locados de Pessoas Jurídicas"),,)
				PrintOut(Li,080,(aMes[nI][2][21][1]+aMes[nI][2][21][2])*nPercInt+aMercado[03][01],"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][21][3]+aMes[nI][2][21][2])*nPercNTr+aMercado[03][02],"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][21][1]+aMes[nI][2][21][2])*nPercExt+aMercado[03][03],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","07.Despesas De Armazenamento De Mercadoria E Serviço Na Operação De Venda","07.Despesas de Armazenagem de Mercadoria e Frete na Operação de Venda"),,)
				PrintOut(Li,080,(aMes[nI][2][23][1]+aMes[nI][2][23][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][23][3]+aMes[nI][2][23][2])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][23][1]+aMes[nI][2][23][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","08.Despesas De Contraprestações De Arrendamento Mercantil","08.Despesas de Contraprestações de Arrendamento Mercantil"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","09.sobre Bens Do Activo Imobilizado(com Base Nas Categorias De Desvalorização)","09.Sobre Bens do Ativo Imobilizado(Com Base nos Encargos de Depreciação)"),,)
				PrintOut(Li,080,nVDeprAt*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,115,nVDeprAt*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","10.sobre Bens Do Activo Imobilizado(com Base No Valor De Aquisição)","10.Sobre Bens do Ativo Imobilizado(Com Base no Valor de Aquisição)"),,)
				PrintOut(Li,080,nBsCrdAqI*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,nBsCrdAqI*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,nBsCrdAqE*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","11.encategorias De Amortização De Edificações E Benfeitorias","11.Encargos de Amortização de Edificações e Benfeitorias"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","12.Devolução de vendas sujeitas a aliquota de ","12.Devolução de Vendas Sujeitas a Alíquota de ")+"1,65%",If(cPaisLoc$"ANG|PTG","12.Devolução de vendas sujeitas a aliquota de ","12.Devolução de Vendas Sujeitas a Alíquota de ")+"7,6%"),,)
				PrintOut(Li,080,aMes[nI][2][7][1],"@E 99,999,999,999.99",)
				PrintOut(Li,097,nNTrib,"@E 99,999,999,999.99",)
				PrintOut(Li,115,aMes[nI][2][7][2],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","13.Outras Operações Com Direito A Crédito","13.Outras Operações com Direito a Crédito"),,)
				PrintOut(Li,080,(aMes[nI][2][22][1]+aMes[nI][2][22][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][22][3]+aMes[nI][2][22][2])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][22][1]+aMes[nI][2][22][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","14.base De Cálculo Dos Créditos","14.BASE DE CÁLCULO DOS CRÉDITOS"),,)
				PrintOut(Li,080,((nTotVlMI+nVAgrDes)*nPercInt)+aMes[nI][2][7][1],"@E 99,999,999,999.99",)
				PrintOut(Li,097,((nTotVlNTr+nVAgrDes)*nPercNTr)+nNTrib,"@E 99,999,999,999.99",)
				PrintOut(Li,115,((nTotVlEX+nVAgrDes)*nPercExt)+aMes[nI][2][7][2],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","15.Créditos A Descontar","15.Créditos a Descontar")+" à Alíquota de 1,65%",If(cPaisLoc$"ANG|PTG","15.Créditos A Descontar","15.Créditos a Descontar")+" à Alíquota de 7,6%"),,)
				PrintOut(Li,080,(((nTotVlMI+nVAgrDes)*nPercInt)+aMes[nI][2][7][1])*(IIF(nY==1,0.0165,0.076)),"@E 99,999,999,999.99",)
				PrintOut(Li,097,(((nVAgrDes+nTotVlNTr)*nPercNTr)+nNTrib)*(IIF(nY==1,0.0165,0.076)),"@E 99,999,999,999.99",)
				PrintOut(Li,115,(((nTotVlEX+nVAgrDes)*nPercExt)+aMes[nI][2][7][2])*(IIF(nY==1,0.0165,0.076)),"@E 99,999,999,999.99",)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Apuração De Outros Créditos","APURAÇÃO DE OUTROS CRÉDITOS"),,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","16.Créditos Calculados A Aliquotas Diferenciadas","16.Créditos Calculados a Alíquotas Diferenciadas"),,)
				If nY ==1
					PrintOut(Li,080,(aMes[nI][2][1][1])*nPercInt,"@E 99,999,999,999.99",)
					PrintOut(Li,097,(aMes[nI][2][1][3])*nPercNTr,"@E 99,999,999,999.99",)
					PrintOut(Li,115,(aMes[nI][2][1][2])*nPercExt,"@E 99,999,999,999.99",)
				Else
					PrintOut(Li,080,(aMes[nI][2][2][1])*nPercInt,"@E 99,999,999,999.99",)
					PrintOut(Li,097,(aMes[nI][2][2][3])*nPercNTr,"@E 99,999,999,999.99",)
					PrintOut(Li,115,(aMes[nI][2][2][2])*nPercExt,"@E 99,999,999,999.99",)
				Endif
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","17.créditos Calculados Por Unidade De Medida De Artigo","17.Créditos Calculados por Unidade de Medida de Produto"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","18.créditos Da Actividade De Transporte De Cargas - Subcontr.serviços","18.Créditos da Atividade de Transporte de Cargas - Subcontr.Serviços"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","19.Crédito Calculado Relativo A Stock De Abertura","19.Crédito Presumido Relativo a Estoque de Abertura"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","20.créditos Da Actividade Imobiliária","20.Créditos da Atividade Imobiliária"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","21.outros Créditos A Descontar","21.Outros Créditos a Descontar"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","22.acordos Positivos De Créditos","22.Ajustes Positivos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				nAjusMI	:= ((aMes[nI][2][10][1]+aMes[nI][2][21][2])*nPercInt)*(IIF(nY==1,0.0165,0.076))
				nAjusNT := ((aMes[nI][2][10][3]+aMes[nI][2][21][2])*nPercNTr)*(IIF(nY==1,0.0165,0.076))
				nAjusEX	:= ((aMes[nI][2][10][1]+aMes[nI][2][21][2])*nPercExt)*(IIF(nY==1,0.0165,0.076))
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","23.(-)acordos Negativos De Créditos","23.(-)Ajustes Negativos de Créditos"),,)
				PrintOut(Li,080,nAjusMI,"@E 99,999,999,999.99",)
				PrintOut(Li,097,nAjusNT,"@E 99,999,999,999.99",)
				PrintOut(Li,115,nAjusEX,"@E 99,999,999,999.99",)
				li++

		        If nY ==1
					nToCreMI := (((((nTotVlMI)*nPercInt)+aMes[nI][2][7][1])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][1][1]))-nAjusMI
					nToCreNT := (((((nTotVlNTr)*nPercNTr)+nNTrib) *(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][1][1]))-nAjusNT
					nToCreEX := (((((nTotVlEX)*nPercExt)+aMes[nI][2][7][2])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][1][2]))-nAjusEX
				Else
					nToCreMI := (((((nTotVlMI)*nPercInt)+aMes[nI][2][7][1])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][2][1]))-nAjusMI
					nToCreNT := (((((nTotVlNTr)*nPercNTr)+nNTrib) *(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][2][1]))-nAjusNT
					nToCreEX := (((((nTotVlEX)*nPercExt)+aMes[nI][2][7][2])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][2][2]))-nAjusEX
				Endif

				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","24.total De Créditos Apurados Após Acordos","24.TOTAL DE CRÉDITOS APURADOS APÓS AJUSTES"),,)
				PrintOut(Li,080,nToCreMI,"@E 99,999,999,999.99",)
				PrintOut(Li,097,nToCreNT,"@E 99,999,999,999.99",)
				PrintOut(Li,115,nToCreEX,"@E 99,999,999,999.99",)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Créditos Presumidos - Actividades Agro-industriais","CRÉDITOS PRESUMIDOS - ATIVIDADES AGROINDUSTRIAIS"),,)
				li++
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","25.calculados à taxa de 0,9900%","25.Calculados a Alíquota de 0,9900%"),If(cPaisLoc$"ANG|PTG","25.calculados à taxa de 4,56%","25.Calculados a Alíquota de 4,56%")),,)
				PrintOut(Li,080,((aMes[nI][2][52][1]+aMes[nI][2][52][2])*nPercInt)*(IIF(nY==1,0.0099,0.0456)),"@E 99,999,999,999.99",)
				PrintOut(Li,097,((aMes[nI][2][52][3]+aMes[nI][2][52][2])*nPercNTr)*(IIF(nY==1,0.0099,0.0456)),"@E 99,999,999,999.99",)
				PrintOut(Li,115,((aMes[nI][2][52][1]+aMes[nI][2][52][2])*nPercExt)*(IIF(nY==1,0.0099,0.0456)),"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","26.calculados à taxa de 0,5775%","26.Calculados a Alíquota de 0,5775%"),If(cPaisLoc$"ANG|PTG","26.calculados à taxa de 2,66%","26.Calculados a Alíquota de 2,66%")),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","27.acordos Positivos De Créditos","27.Ajustes Positivos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","28.(-)acordos Negativos De Créditos","28.(-)Ajustes Negativos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","29.total De Créditos Presumidos - Actividades Agro-industriais, Após Acordos","29.TOTAL DE CRÉDITOS PRESUMIDOS - ATIVIDADES AGROINDUSTRIAIS, APÓS AJUSTES"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Créditos Decorrentes Da Aquisição De Embalagens Para Revenda","CRÉDITOS DECORRENTES DA AQUISIÇÃO DE EMBALAGENS PARA REVENDA"),,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","30.créditos Apurados","30.Créditos Apurados"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","31.acordos Positivos De Créditos","31.Ajustes Positivos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","32.(-)acordos Negativos De Créditos","32.(-)Ajustes Negativos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","33.total De Créditos Decorrentes Da Aquisição De Embalagens Para Revenda, Após Acordos","33.TOTAL DE CRÉDITOS DECORRENTES DA AQUISIÇÃO DE EMBALAGENS PARA REVENDA, APÓS AJUSTES"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++



			Elseif (nY ==2 .Or.  nY ==4)
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","Apuramento Da Contribuição Para O Pis/pasep","APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP"),If(cPaisLoc$"ANG|PTG","Apuramento Da Cofins","APURAÇÃO DA COFINS")),,)
				li++
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","01.receita de vendas de bens e serviços - taxa 1,65%","01.Receita de Vendas de Bens e Serviços - Alíq. 1,65%"),If(cPaisLoc$"ANG|PTG","01.receita de vendas de bens e serviços - taxa 7,6%","01.Receita de Vendas de Bens e Serviços - Alíq. 7,6%")),,)
				PrintOut(Li,078,aMes[nI][2][8][1],"@E 99,999,999,999.99",)
				PrintOut(Li,095,(aMes[nI][2][8][1]-(aMes[nI][2][19][1]+aMes[nI][2][15][1])),"@E 99,999,999,999.99",)
				PrintOut(Li,112,((aMes[nI][2][8][1]-(aMes[nI][2][19][1]+aMes[nI][2][15][1])))*IIF(nY==2,0.0165,0.076),"@E 99,999,999,999.99",)
               	nCont1 := ((aMes[nI][2][8][1]-(aMes[nI][2][19][1]+aMes[nI][2][15][1])))*IIF(nY==2,0.0165,0.076)
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","02.demais receitas - taxa 1,65%","02.Demais Receitas - Alíq. 1,65%"),If(cPaisLoc$"ANG|PTG","02.demais receitas - taxa 7,6%","02.Demais Receitas - Alíq. 7,6%")),,)
				PrintOut(Li,078,aMes[nI][2][9][1]+nOutRecN,"@E 99,999,999,999.99",)
				PrintOut(Li,095,(aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]),"@E 99,999,999,999.99",)
				PrintOut(Li,112,((aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==2,0.0165,0.076),"@E 99,999,999,999.99",)
                nCont2 := ((aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==2,0.0165,0.076)
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","03.total da contribuição para o pis/pasep apurada à taxa de 1,65%","03.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 1,65%"),If(cPaisLoc$"ANG|PTG","03.total da cofins apurada à taxa de 7,6%","03.TOTAL DA COFINS APURADA A ALÍQUOTA DE 7,6%")),,)
				PrintOut(Li,112,nCont1+nCont2,"@E 99,999,999,999.99",)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Outras Receitas Aferidas","OUTRAS RECEITAS AUFERIDAS"),,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","04.receita Tributada à Taxa Zero","04.Receita Tributada a Alíquota Zero"),,)
				PrintOut(Li,078,aMes[nI][2][29][1]+aRecAuf[1],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","05.receita Tributada à Taxa Zero-revenda Prod. Sujeitos Trib. Monof.","05.Receita Tributada a Alíquota Zero-Revenda Prod. Sujeitos Trib. Monof."),,)
				PrintOut(Li,078,aMes[nI][2][30][1]+aRecAuf[2],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","06.receita De Vendas De Bens Do Activo Permanente","06.Receita de Vendas de Bens do Ativo Permanente"),,)
				PrintOut(Li,078,aMes[nI][2][31][1]+aRecAuf[3],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","07.receita Sem Incidência Da Contribuição - Exportação","07.Receita sem Incidência da Contribuição - Exportação"),,)
				PrintOut(Li,078,aMes[nI][2][27][1]+aRecAuf[4],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","08.receita Isenta E Demais Receitas Sem Incid.contribuição","08.Receita Isenta e Demais Receitas sem Incid.Contribuição"),,)
				PrintOut(Li,078,aMes[nI][2][32][1]+aRecAuf[5],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","09.receita Com Suspensão Da Contribuição","09.Receita com Suspensão da Contribuição"),,)
				PrintOut(Li,078,aMes[nI][2][33][1]+aRecAuf[6],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","10.receita De Revenda Dec.operações Suj.subs.tribut.","10.Receita de Revenda Dec.Operações Suj.Subs.Tribut."),,)
				PrintOut(Li,078,aMes[nI][2][34][1]+aRecAuf[7],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","11.receita Tributada Pelo Ret - Património De Afectação","11.Receita Tributada pelo RET -Patrimônio de Afetação"),,)
				PrintOut(Li,078,aMes[nI][2][35][1]+aRecAuf[8],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				li++
				If nY==2
					PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","12.contribuição Para O Pis/pasep -folha De Salários","12.CONTRIBUIÇÃO PARA O PIS/PASEP -FOLHA DE SALÁRIOS"),,)
					If lPisFolha .Or.  lPisFolSN
   					    PrintOut(Li,078,"    ",,)
					    PrintOut(Li,095,aMes[nI][2][36][2],"@E 99,999,999,999.99",)
					    PrintOut(Li,113,aMes[nI][2][36][2]*0.01,"@E 99,999,999,999.99",)
                    Else
					    PrintOut(Li,091,"    ",,)
					    PrintOut(Li,108,"----",,)
					    PrintOut(Li,125,"----",,)
				    EndIf
				Endif
			Endif
		Next





		If mv_par13 == 2
			For nY:= 1 To 2
				nVlrTot := 0
				cCabec2:= cCabec6
				li := cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
				li++
				If nY == 1
					PrintOut(Li,001,"Ficha 15B - RESUMO - Contribuição para o PIS/Pasep - Regime Não Cumulativo",,)
					nScan := aScan(aWizNCum,{|x| x[2]=="Ficha 15B - RESUMO - Contribuição para o PIS/Pasep - Regime Não Cumulativo" } )
				Else
					PrintOut(Li,001,"Ficha 25B - Cofins - Regime Não-Cumulativo",,)
					nScan := aScan(aWizNCum,{|x| x[2]=="Ficha 25B - Cofins - Regime Não-Cumulativo" } )
				Endif
				li++
				PrintOut(Li,000,Repli("-",Limite),,)
				li++
				PrintOut(Li,001,IIF(nY==1,"CONTRIBUIÇÃO PARA PIS/PASEP - RESUMO","CONTRIBUIÇÃO PARA COFINS - RESUMO"),,)
				li++
				li++
				PrintOut(Li,001,IIF(nY==1,"01. Contribuição para o PIS/Pasep Apurada","01. Cofins Apurada"),,)



				PrintOut(Li,108,((aMes[nI][2][8][1]+aMes[nI][2][51][1])-(aMes[nI][2][19][1]+aMes[nI][2][15][1]))*IIF(nY==1,0.0165,0.076)+((aMes[nI][2][9][1]+aMes[nI][2][38][1])-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==1,0.0165,0.076)+(((aMes[nI][2][12][1]+aMes[nI][2][51][1])-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*IIF(nY==1,0.0065,0.076)+((aMes[nI][2][13][1]+aMes[nI][2][39][1])-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*IIF(nY==1,0.0065,0.076),"@E 99,999,999,999.99",)



				nCont1 := ((aMes[nI][2][8][1]+aMes[nI][2][51][1])-(aMes[nI][2][19][1]+aMes[nI][2][15][1]))*IIF(nY==1,0.0165,0.076)+ ((aMes[nI][2][9][1]+aMes[nI][2][38][1])-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==1,0.0165,0.076) + (((aMes[nI][2][12][1]+aMes[nI][2][51][1])-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*IIF(nY==1,0.0065,0.076) + ((aMes[nI][2][13][1]+aMes[nI][2][39][1])-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*IIF(nY==1,0.0065,0.076)
				nVlrTot+=nCont1
				li++
				dbSelectArea("TMP")
				cMes :=	StrZero(aMes[nI,1],2)
				If dbSeek(cMes)
					If nY == 1
						nPis := TMP->PIS
						cCod := TMP->CODIGO
						While !Eof() .And.  TMP->MES == cMes
							While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
								Do Case
									Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
									Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
									Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
								EndCase
								dbSelectArea("TMP")
								dbSkip()
							Enddo
							cMes :=	StrZero(aMes[nI,1],2)
							n09A_15 += (nItem1+nItem2+nItem3) * nPis / 100
							nPis 	:= TMP->PIS
							cCod 	:= TMP->CODIGO
							nItem1	:= 0
							nItem2	:= 0
							nItem3	:= 0
						Enddo
					Else
						nCof := TMP->COFINS
						cCod := TMP->CODIGO
						While !Eof() .And.  TMP->MES == cMes
							While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
								Do Case
									Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
									Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
									Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
								EndCase
								dbSelectArea("TMP")
								dbSkip()
							Enddo
							cMes :=	StrZero(aMes[nI,1],2)
							n09A_25 += (nItem1+nItem2+nItem3) * nCof / 100
							nCof 	:= TMP->COFINS
							cCod 	:= TMP->CODIGO
							nItem1	:= 0
							nItem2	:= 0
							nItem3	:= 0
						Enddo
					Endif
				Endif
				PrintOut(Li,001,IIF(nY==1,"02. Contribuição para o PIS/Pasep Apurada - Alíquotas Diferenciadas","02. Cofins Apurada - Alíquotas Diferenciadas"),,)
				PrintOut(Li,108,IIF(nY==1,n09A_15,n09A_25),"@E 99,999,999,999.99",)
				IIF(nY==1,nCont1:=n09A_15,nCont1:=n09A_25)
				nVlrTot+=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"03. Contribuição para o PIS/Pasep - Alíquotas Diferenciadas - Substituto Tributário","03. Cofins Apurada – Alíquotas Diferenciadas – Sunstituto Tributário"),,)
				PrintOut(Li,120,"----",,)
				li++
				dbSelectArea("T01")
				cMes :=	StrZero(aMes[nI,1],2)
				If dbSeek(cMes)
					If nY == 1
						nPis := T01->PIS
						cCod := T01->CODIGO
						While !Eof() .And.  T01->MES == cMes
							While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
								nItem1 += T01->VALOR
								nQuant += T01->QUANT
								dbSelectArea("T01")
								dbSkip()
							Enddo
							cMes :=	StrZero(aMes[nI,1],2)
							n10A_15 += nQuant * nPis
							nPis 	:= T01->PIS
							cCod 	:= T01->CODIGO
							nItem1	:= 0
							nQuant  := 0
						Enddo
				  	Else
				   	   	nCof := T01->COFINS
						cCod := T01->CODIGO
						While !Eof() .And.  T01->MES == cMes
							While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
								nItem1 += T01->VALOR
								nQuant += T01->QUANT
								dbSelectArea("T01")
								dbSkip()
							Enddo
							cMes :=	StrZero(aMes[nI,1],2)
							n10A_25 += nQuant * nCof
							nCof 	:= T01->COFINS
							cCod 	:= T01->CODIGO
							nItem1	:= 0
							nQuant  := 0
						Enddo
					Endif
				Endif
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Artigo","04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Produto"),"04. Cofins Apurada – Alíquotas por Unidade de Medida de Produto"),,)
				PrintOut(Li,108,IIF(nY==1,n10A_15,n10A_25),"@E 99,999,999,999.99",)
				IIF(nY==1,nCont1:=n10A_15,nCont1:=n10A_25)
				nVlrTot+=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Artigo - ST","05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Produto - ST"),"05. Cofins Apurada – Alíquotas por Unidade de Medida de Produto – Substituto Tributário"),,)
				PrintOut(Li,120,"----",,)
				li++
				PrintOut(Li,001,IIF(nY==1,"06. Contribuição Diferida em meses anteriores","06. Cofins Diferida em Meses Anteriores"),,)
				PrintOut(Li,120,"----",,)
				li++
				PrintOut(Li,001,IIF(nY==1,"07. (-) Contribuição Diferida no Mês","07. (-) Cofins Diferida no Mês"),,)
				PrintOut(Li,120,"----",,)
				li++
				PrintOut(Li,001,IIF(nY==1,"08. TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA NO MÊS","08. TOTAL DA COFINS APURADA NO MÊS"),,)
			    PrintOut(Li,108,nVlrTot,"@E 99,999,999,999.99",)
				li++
				li++
				PrintOut(Li,001,"CRÉDITOS DESCONTADOS REFERENTES A AQUISIÇÕES NO MERCADO INTERNO",,)
				li++
				li++
				PrintOut(Li,001,"09. (-) Vinculados à Receita Tributada no Mercado Interno",,)
			    PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][1]),nCont1:=Val(aNCumVlr[nScan][1])),"@E 99,999,999,999.99",)
			    nVlrTot-=nCont1
				li++
				PrintOut(Li,001,"10. (-) Vinculados à Receita Não Tributada no Mercado Interno",,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][2]),nCont1:=Val(aNCumVlr[nScan][2])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,"11. (-) Vinculados à Receita de Exportação",,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][3]),nCont1:=Val(aNCumVlr[nScan][3])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","12. (-) Presumido - Actividades Agroindustriais","12. (-) Presumido - Atividades Agroindustriais"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][4]),nCont1:=Val(aNCumVlr[nScan][4])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,"13. (-) Vinculados a Embalagens para Revenda",,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][5]),nCont1:=Val(aNCumVlr[nScan][5])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				li++
				PrintOut(Li,001,"CRÉDITOS DESCONTADOS REFERENTES A IMPORTAÇÕES",,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","14. (-) Vinculados à Receita Tributada no Mercado Interno","14. (-) Vinculados a Receita Tributada no Mercado Interno"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][6]),nCont1:=Val(aNCumVlr[nScan][6])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","15. (-) Vinculados à Receita Não Tributada no Mercado Interno","15. (-) Vinculados a Receita não Tributada no Mercado Interno"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][7]),nCont1:=Val(aNCumVlr[nScan][7])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","16. (-) Vinculados à Receita de Exportação","16. (-) Vinculados a Receita de Exportação"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][8]),nCont1:=Val(aNCumVlr[nScan][8])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"17. TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP DEVIDA NO MÊS","17. TOTAL DA CONTRIBUIÇÃO DEVIDA NO MÊS"),,)
				PrintOut(Li,108,nVlrTot,"@E 99,999,999,999.99",)
				li++
				li++
				PrintOut(Li,001,"DEDUÇÕES",,)
				li++
				li++
				PrintOut(Li,001,IIF(nY==1,"18. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações Federais","18. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações Federais"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][9]),nCont1:=Val(aNCumVlr[nScan][9])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"19. (-) PIS/Pasep Retida na Fonte pelas Demais Entidades da Administração Pública Federal","19. (-) Cofins Retida na Fonte pelas Demais Entidades da Administração Pública Federal"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][10]),nCont1:=Val(aNCumVlr[nScan][10])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"20. (-) PIS/Pasep Retida na Fonte por Pessoas Jurídicas de Direito Privado","20. (-) Cofins Retida na Fonte por Pessoas Jurídicas de Direito Privado"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][11]),nCont1:=Val(aNCumVlr[nScan][11])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"21. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações dos Estados, DF e Municípios","21. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações dos Estados, DF e Municípios"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][12]),nCont1:=Val(aNCumVlr[nScan][12])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"22. (-) PIS/Pasep Retida na Fonte por Sociedade Cooperativa","22. (-) Cofins Retida na Fonte por Sociedade Cooperativa"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][13]),nCont1:=Val(aNCumVlr[nScan][13])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"23. (-) PIS/Pasep Retida na Fonte por Fabricantes de Veículos e Máquinas","23. (-) Cofins Retida na Fonte por Fabricantes de Veículos e Máquinas"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][14]),nCont1:=Val(aNCumVlr[nScan][14])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","24. (-) PIS/Pasep Substituição pela Não Ocorrência do Facto Gerador Presumido","24. (-) PIS/Pasep Substituição pela não ocorrência do Fato Gerador Presumido"),"24. (-) Cofins Substituição pela não Ocorrência do Fato Gerador Presumido"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][15]),nCont1:=Val(aNCumVlr[nScan][15])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"25. (-) Crédito Presumido - Medicamentos","25. (-) Crédito Presumido – Medicamentos"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][16]),nCont1:=Val(aNCumVlr[nScan][16])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"26. (-) Créditos Admitidos no Regime Cumulativo","26. (-) Créditos Admitidos no Regime Cumulativo"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][17]),nCont1:=Val(aNCumVlr[nScan][17])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"27. (-) PIS/Pasep paga pelo Substituto Tributário","27. (-) Cofins Paga pelo Substituto Tributário"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][18]),nCont1:=Val(aNCumVlr[nScan][18])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,"28. (-) Outras Deduções","28. (-) Outras Deduções"),,)
				PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][19]),nCont1:=Val(aNCumVlr[nScan][19])),"@E 99,999,999,999.99",)
				nVlrTot-=nCont1
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","29. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FACTURAÇÃO","29. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FATURAMENTO"),"29. COFINS A PAGAR – FATURAMENTO"),,)
				PrintOut(Li,108,nVlrTot,"@E 99,999,999,999.99",)
				li++
		 		PrintOut(Li,001,IIF(nY==1,"30. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FOLHA DE SALÁRIOS","30. COFINS A PAGAR DE SCP"),,)
				PrintOut(Li,108,IIF(nY==1,Val(aNCumVlr[nScan][20]),Val(aNCumVlr[nScan][20])),"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,IIF(nY==1,"31. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR DE SCP","31. COFINS A PAGAR RETIDA DE COOPERADOS"),,)
				PrintOut(Li,108,IIF(nY==1,Val(aNCumVlr[nScan][21]),Val(aNCumVlr[nScan][21])),"@E 99,999,999,999.99",)
				li++
				IF nY == 1
					PrintOut(Li,001,"32. CONTRIBUIÇAO PARA O PIS/PASEP A PAGAR RETIDA DE COOPERADOS",,)
					PrintOut(Li,108,Val(aNCumVlr[nScan][22]),"@E 99,999,999,999.99",)
				EndIf
				li++
			Next
		EndIf



	Elseif mv_par06 ==1
		cCabec1:= cCabec3+" - "+Alltrim(MesExtenso(aMes[nI][1]))




		For nY:= 1 To 2
			cCabec2:= cCabec4
			li := cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
			li++
			If nY == 1
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Ficha 08a - Cálculo Da Contribuição Para O Segurança Social - Regime Cumulativo","Ficha 08A - Cálculo da Contribuição para o PIS/Pasep - Regime Cumulativo"),,)
			Else
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Ficha 18a - Cálculo Da Cofins - Regime Cumulativo","Ficha 18A - Cálculo da Cofins - Regime Cumulativo"),,)
			Endif
			li++
			PrintOut(Li,000,Repli("-",Limite),,)
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","Apuramento Da Contribuição Para O Pis/pasep","APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP"),If(cPaisLoc$"ANG|PTG","Apuramento Da Cofins","APURAÇÃO DA COFINS")),,)
			li++
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","01.receita de vendas de bens e serviços - taxa 0,65%","01.Receita de Vendas de Bens e Serviços - Aliq. 0,65%"),If(cPaisLoc$"ANG|PTG","01.receita De Vendas De Bens E Serviços - Taxa Cumulativa","01.Receita de Vendas de Bens e Serviços - Aliq. Cumulativa")),,)
			PrintOut(Li,078,aMes[nI][2][8][2],"@E 99,999,999,999.99",)
			PrintOut(Li,095,(aMes[nI][2][8][2]-(aMes[nI][2][19][2]+aMes[nI][2][15][2])),"@E 99,999,999,999.99",)
			PrintOut(Li,113,((aMes[nI][2][8][2]-(aMes[nI][2][19][2]+aMes[nI][2][15][2])))*IIF(nY==1,0.0065,0.03),"@E 99,999,999,999.99",)
            nCont1 := ((aMes[nI][2][8][2]-(aMes[nI][2][19][2]+aMes[nI][2][15][2])))*IIF(nY==1,0.0065,0.03)
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","02.demais receitas - taxa 0,65%","02.Demais Receitas - Alíq. 0,65%"),If(cPaisLoc$"ANG|PTG","02.demais Receitas - Taxa Cumulativa","02.Demais Receitas - Alíq. Cumulativa")),,)
			PrintOut(Li,078,aMes[nI][2][9][2]+nOutRecC,"@E 99,999,999,999.99",)
			PrintOut(Li,095,(aMes[nI][2][9][2]+nOutRecC)-(aMes[nI][2][11][2]+aMes[nI][2][16][2]),"@E 99,999,999,999.99",)
			PrintOut(Li,113,((aMes[nI][2][9][2]+nOutRecC)-(aMes[nI][2][11][2]+aMes[nI][2][16][2]))*IIF(nY==1,0.0065,0.03),"@E 99,999,999,999.99",)
            nCont2 := ((aMes[nI][2][9][2]+nOutRecC)-(aMes[nI][2][11][2]+aMes[nI][2][16][2]))*IIF(nY==1,0.0065,0.03)
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","03.receita Tributada No Regime De Substituição Tributária – Taxa 0,65%","03.Receita Tributada no Regime de Substituição Tributária - Aliq.0,65%"),If(cPaisLoc$"ANG|PTG","03.receita tributada no regime de substituição tributária - taxa 3%","03.Receita Tributada no Regime de Substituição Tributária - Aliq. 3%")),,)
			PrintOut(Li,091,"----",,)
			PrintOut(Li,108,"----",,)
			PrintOut(Li,125,"----",,)
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","04.total da contribuição para o pis/pasep apurado à taxa de 0,65%","04.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 0,65%"),If(cPaisLoc$"ANG|PTG","04.total Da Cofins Apurada - Taxa Cumulativa","04.TOTAL DA COFINS APURADA - ALÍQUOTA CUMULATIVA")),,)
			PrintOut(Li,113,nCont1+nCont2,"@E 99,999,999,999.99",)
			li++
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Outras Receitas Aferidas","OUTRAS RECEITAS AUFERIDAS"),,)
			li++
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","05.receita Tributada à Taxa Zero","05.Receita Tributada a Alíquota Zero"),,)
			PrintOut(Li,078,aMes[nI][2][29][2]+aRecAuf[1],"@E 99,999,999,999.99",)
			PrintOut(Li,108,"----",,)
			PrintOut(Li,125,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","06.receita Tributada à Taxa Zero-revenda Prod. Sujeitos Trib. Monof.","06.Receita Tributada a Alíqota Zero-Revenda Prod. Sujeitos Trib. Monof."),,)
			PrintOut(Li,078,aMes[nI][2][30][2]+aRecAuf[2],"@E 99,999,999,999.99",)
			PrintOut(Li,108,"----",,)
			PrintOut(Li,125,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","07.receita De Vendas De Bens Do Activo Permanente","07.Receita de Vendas de Bens do Ativo Permanente"),,)
			PrintOut(Li,078,aMes[nI][2][31][2]+aRecAuf[3],"@E 99,999,999,999.99",)
			PrintOut(Li,108,"----",,)
			PrintOut(Li,125,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","08.receita Sem Incidência Da Contribuição - Exportação","08.Receita sem Incidência da Contribuição - Exportação"),,)
			PrintOut(Li,078,aMes[nI][2][27][2]+aRecAuf[4],"@E 99,999,999,999.99",)
			PrintOut(Li,108,"----",,)
			PrintOut(Li,125,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","09.receita Isenta E Demais Receitas Sem Incid.contribuição","09.Receita Isenta e Demais Receitas sem Incid.Contribuição"),,)
			PrintOut(Li,078,aMes[nI][2][32][2]+aRecAuf[5],"@E 99,999,999,999.99",)
			PrintOut(Li,108,"----",,)
			PrintOut(Li,125,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","10.receita Com Suspensão Da Contribuição","10.Receita com Suspensao da Contribuição"),,)
			PrintOut(Li,078,aMes[nI][2][33][2]+aRecAuf[6],"@E 99,999,999,999.99",)
			PrintOut(Li,108,"----",,)
			PrintOut(Li,125,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","11.receita De Revenda Dec.operações Suj.subs.tribut.","11.Receita de Revenda Dec.Operações Suj.Subs.Tribut."),,)
			PrintOut(Li,078,aMes[nI][2][34][2]+aRecAuf[7],"@E 99,999,999,999.99",)
			PrintOut(Li,108,"----",,)
			PrintOut(Li,125,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","12.receita Tributada Pelo Ret - Património De Afectação","12.Receita Tributada pelo RET -Patrimônio de Afetação"),,)
			PrintOut(Li,078,aMes[nI][2][35][2]+aRecAuf[8],"@E 99,999,999,999.99",)
			PrintOut(Li,108,"----",,)
			PrintOut(Li,125,"----",,)
			li++
			li++
			If nY==1
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","13.contribuição Pis/pasep -folha De Salários","13.CONTRIBUIÇÃO PIS/PASEP -FOLHA DE SALÁRIOS"),,)
				If lPisFolha .Or.  lPisFolSN
				    PrintOut(Li,078,"    ",,)
				    PrintOut(Li,095,aMes[nI][2][36][2],"@E 99,999,999,999.99",)
				    PrintOut(Li,113,aMes[nI][2][36][2]*0.01,"@E 99,999,999,999.99",)
				Else
				    PrintOut(Li,091,"    ",,)
				    PrintOut(Li,108,"----",,)
				    PrintOut(Li,125,"----",,)
			    EndIf
			Endif
		Next






		For nY:= 1 To 2
			nVlrTot := 0
			cCabec2:= cCabec6
			li := cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
			li++
			If nY == 1
				PrintOut(Li,001,"Ficha 15A - RESUMO - Contribuição para PIS/Pasep - Regime Cumulativo",,)
				nScan := aScan(aWizCum,{|x| x[2]=="Ficha 15A - RESUMO - Contribuição para PIS/Pasep - Regime Cumulativo" } )
			Else
				PrintOut(Li,001,"Ficha 25A - RESUMO - Cofins - Regime Cumulativo",,)
				nScan := aScan(aWizCum,{|x| x[2]=="Ficha 25A - RESUMO - Cofins - Regime Cumulativo" } )
			Endif
			li++
			PrintOut(Li,000,Repli("-",Limite),,)
			li++
			PrintOut(Li,001,IIF(nY==1,"CONTRIBUIÇÃO PARA PIS/PASEP - RESUMO","CONTRIBUIÇÃO PARA COFINS - RESUMO"),,)
			li++
			li++
			PrintOut(Li,001,IIF(nY==1,"01. Contribuição para o PIS/Pasep Apurada","01. Cofins Apurada"),,)
			PrintOut(Li,108,((((aMes[nI][2][8][2]+aMes[nI][2][51][1])-(aMes[nI][2][19][2]+aMes[nI][2][15][2])))+((aMes[nI][2][9][2]+aMes[nI][2][39][1])-(aMes[nI][2][11][2]+aMes[nI][2][16][2])))*IIF(nY==1,0.0065,0.03),"@E 99,999,999,999.99",)
			nCont1 := ((((aMes[nI][2][8][2]+aMes[nI][2][51][1])-(aMes[nI][2][19][2]+aMes[nI][2][15][2])))+((aMes[nI][2][9][2]+aMes[nI][2][39][1])-(aMes[nI][2][11][2]+aMes[nI][2][16][2])))*IIF(nY==1,0.0065,0.03)
			nVlrTot+=nCont1
			li++
			dbSelectArea("TMP")
			cMes :=	StrZero(aMes[nI,1],2)
			If dbSeek(cMes)
				If nY == 1
					nPis := TMP->PIS
					cCod := TMP->CODIGO
					While !Eof() .And.  TMP->MES == cMes
						While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
							Do Case
								Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
								Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
								Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
							EndCase
							dbSelectArea("TMP")
							dbSkip()
						Enddo
						cMes :=	StrZero(aMes[nI,1],2)
						n09A_15 += (nItem1+nItem2+nItem3) * nPis / 100
						nPis 	:= TMP->PIS
						cCod 	:= TMP->CODIGO
						nItem1	:= 0
						nItem2	:= 0
						nItem3	:= 0
					Enddo
				Else
					nCof := TMP->COFINS
					cCod := TMP->CODIGO
					While !Eof() .And.  TMP->MES == cMes
						While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
							Do Case
								Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
								Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
								Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
							EndCase
							dbSelectArea("TMP")
							dbSkip()
						Enddo
						cMes :=	StrZero(aMes[nI,1],2)
						n09A_25 += (nItem1+nItem2+nItem3) * nCof / 100
						nCof 	:= TMP->COFINS
						cCod 	:= TMP->CODIGO
						nItem1	:= 0
						nItem2	:= 0
						nItem3	:= 0
					Enddo
				Endif
			Endif
			PrintOut(Li,001,IIF(nY==1,"02. Contribuição para o PIS/Pasep Apurada - Alíquotas Diferenciadas","02. Cofins Apurada - Alíquotas Diferenciadas"),,)
			PrintOut(Li,108,IIF(nY==1,n09A_15,n09A_25),"@E 99,999,999,999.99",)
			IIF(nY==1,nCont1:=n09A_15,nCont1:=n09A_25)
			nVlrTot+=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"03. Contribuição para o PIS/Pasep - Alíquotas Diferenciadas - Substituto Tributário","03. Cofins Apurada – Alíquotas Diferenciadas – Sunstituto Tributário"),,)
			PrintOut(Li,120,"----",,)
			li++




			dbSelectArea("T01")
			cMes :=	StrZero(aMes[nI,1],2)
			If dbSeek(cMes)



				If nY == 1
					nPis := T01->PIS
					cCod := T01->CODIGO
					While !Eof() .And.  T01->MES == cMes
						While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
							nItem1 += T01->VALOR
							nQuant += T01->QUANT
							dbSelectArea("T01")
							dbSkip()
						Enddo
						cMes :=	StrZero(aMes[nI,1],2)

						n10A_15 += nQuant * nPis
						nPis 	:= T01->PIS
						cCod 	:= T01->CODIGO
						nItem1	:= 0
						nQuant  := 0
					Enddo
			  	Else



			   	   	nCof := T01->COFINS
					cCod := T01->CODIGO
					While !Eof() .And.  T01->MES == cMes
						While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
								nItem1 += T01->VALOR
								nQuant += T01->QUANT
							dbSelectArea("T01")
							dbSkip()
						Enddo
						cMes :=	StrZero(aMes[nI,1],2)
						n10A_25 += nQuant * nCof
						nCof 	:= T01->COFINS
						cCod 	:= T01->CODIGO
						nItem1	:= 0
						nQuant  := 0
					Enddo
				Endif
			Endif
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Artigo","04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Produto"),"04. Cofins Apurada – Alíquotas por Unidade de Medida de Produto"),,)
			PrintOut(Li,108,IIF(nY==1,n10A_15,n10A_25),"@E 99,999,999,999.99",)
			IIF(nY==1,nCont1:=n10A_15,nCont1:=n10A_25)
			nVlrTot+=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Artigo - ST","05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Produto - ST"),"05. Cofins Apurada – Alíquotas por Unidade de Medida de Produto – Substituto Tributário"),,)
			PrintOut(Li,120,"----",,)
			li++
			PrintOut(Li,001,IIF(nY==1,"06. Contribuição Diferida em meses anteriores","06. Cofins Diferida em Meses Anteriores"),,)
			PrintOut(Li,120,"----",,)
			li++
			PrintOut(Li,001,IIF(nY==1,"07. (-) Créditos Diferidos em Meses Anteriores","07. (-) Créditos Diferidos em Meses Anteriores"),,)
			PrintOut(Li,120,"----",,)
			li++
			PrintOut(Li,001,IIF(nY==1,"08. (-) Contribuiçao Diferida no Mês","08. (-) Cofins Diferida no Mês"),,)
		    PrintOut(Li,120,"----",,)
			li++
			PrintOut(Li,001,IIF(nY==1,"09. TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADO NO MÊS","09. TOTAL DA COFINS APURADA NO MÊS"),,)
			PrintOut(Li,108,nVlrTot,"@E 99,999,999,999.99",)
			li++
			li++
			PrintOut(Li,001,"DEDUÇÕES",,)
			li++
			li++
			PrintOut(Li,001,IIF(nY==1,"10. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações Federais","10. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações Federais"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][1]),nCont1:=Val(aCumVlrs[nScan][1])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"11. (-) PIS/Pasep Retida na Fonte pelas demais Entidades da Adm Pública Federal","11. (-) Cofins Retida na Fonte pelas Demais Entidades da Administração Pública Federal"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][2]),nCont1:=Val(aCumVlrs[nScan][2])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"12. (-) PIS/Pasep Retida na Fonte por Pessoas Jurídicas de Direito Privado","12. (-) Cofins Retida na Fonte por Pessoas Jurídicas de Direito Privado"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][3]),nCont1:=Val(aCumVlrs[nScan][3])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"13. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações do Estado, DF e Municípios","13. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações dos Estados, DF e Municípios"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][4]),nCont1:=Val(aCumVlrs[nScan][4])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"14. (-) PIS/Pasep Retida na Fonte por Sociedade Cooperativa","14. (-) Cofins Retida na Fonte por Sociedade Cooperativa"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][5]),nCont1:=Val(aCumVlrs[nScan][5])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"15. (-) PIS/Pasep Retida na Fonte por Fabricantes de Veículos e Máquinas","15. (-) Cofins Retida na Fonte por Fabricantes de Veículos e Máquinas"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][6]),nCont1:=Val(aCumVlrs[nScan][6])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","16. (-) PIS/Pasep Substituição pela Não Ocorrência do Facto Gerador Presumido","16. (-) PIS/Pasep Substituição pela Não Ocorrência do Fato Gerador Presumido"),"16. (-) Cofins Substituição pela não Ocorrência do Fato Gerador Presumido"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][7]),nCont1:=Val(aCumVlrs[nScan][7])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"17. (-) Crédito Presumido - Medicamentos","17. (-) Crédito Presumido – Medicamentos"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][8]),nCont1:=Val(aCumVlrs[nScan][8])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"18. (-) Créditos Admitidos no Regime Cumulativo","18. (-) Créditos Admitidos no Regime Cumulativo"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][9]),nCont1:=Val(aCumVlrs[nScan][9])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"19. (-) PIS/Pasep Paga pelo Substituto Tributário","19. (-) Cofins Paga pelo Substituto Tributário"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][10]),nCont1:=Val(aCumVlrs[nScan][10])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"20. (-) Outras Deduções","20. (-) Outras Deduções"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aCumVlrs[nScan][11]),nCont1:=Val(aCumVlrs[nScan][11])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","21. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FACTURAÇÃO","21. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FATURAMENTO"),"21. COFINS A PAGAR – FATURAMENTO"),,)
			PrintOut(Li,108,nVlrTot,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,IIF(nY==1,"22. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FOLHA DE SALÁRIOS","22. COFINS A PAGAR DE SCP"),,)
			If lPisFolha .Or.  lPisFolSN
				PrintOut(Li,108,IIF(nY==1,aMes[nI][2][36][2]*0.01,Val(aCumVlrs[nScan][12])),"@E 99,999,999,999.99",)
			Else
				PrintOut(Li,108,IIF(nY==1,0,Val(aCumVlrs[nScan][12])),"@E 99,999,999,999.99",)
			EndIf
			li++
			PrintOut(Li,001,IIF(nY==1,"23. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR DE SCP","23. COFINS A PAGAR RETIDA DE COOPERADOS"),,)
			PrintOut(Li,108,IIF(nY==1,Val(aCumVlrs[nScan][12]),Val(aCumVlrs[nScan][13])),"@E 99,999,999,999.99",)
			li++
			IF nY == 1
				PrintOut(Li,001,"24. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR RETIDA DE COOPERADOS",,)
				PrintOut(Li,108,Val(aCumVlrs[nScan][13]),"@E 99,999,999,999.99",)
			EndIf
			li++
		Next
	Else



		For nY:= 1 To 4
			If nY == 3 .Or.  nY == 1
				cCabec1:= cCabec3+" - "+Alltrim(MesExtenso(aMes[nI][1]))+Space(10)+"Vinculados à Receita"
				cCabec2:= cCabec5
			ElseIf nY == 2 .Or.  nY == 4
				cCabec1:= cCabec3+" - "+Alltrim(MesExtenso(aMes[nI][1]))
				cCabec2:= If( cPaisLoc $ "ANG|PTG", "Discriminação                                                                          receita     base de cálculo    contribuição ", "Discriminação                                                                          Receita     Base de Cálculo    Contribuição " )
			Endif

			li := cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
			li++

			If nY == 1 .Or.  nY == 3
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","Ficha 06a - Apuramento Dos Créditos De Pis/pasep – Aquisições No Mercado Interno - Regime Não Cumulativo","Ficha 06A - Apuração dos Créditos de PIS/PASEP - Aquisições no Mercado Interno - Regime Não Cumulativo"),If(cPaisLoc$"ANG|PTG","Ficha 16a - Apuramento Dos Créditos Da Cofins - Aquisições No Mercado Interno - Regime Não Cumulativo","Ficha 16A - Apuração dos Créditos da COFINS - Aquisições no Mercado Interno - Regime Não Cumulativo")),,)
			ElseIf nY == 2 .Or.  nY == 4
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","Ficha 07B - Cálculo da Contribuição para o PIS/PASEP - Regime não cumulativo e cumulativo","Ficha 07B - Cálculo da Contribuição para o PIS/PASEP - Regime Não Cumulativo e Cumulativo"),If(cPaisLoc$"ANG|PTG","Ficha 17b - cálculo da cofins - regime não cumulativo e cumulativo","Ficha 17B - Cálculo da Cofins - Regime Não Cumulativo e Cumulativo")),,)
			Endif
			li++
			PrintOut(Li,000,Repli("-",Limite),,)
			li++



			If (nY ==1 .Or.  nY ==3)
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE")+" 1,65%",If(cPaisLoc$"ANG|PTG","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE")+" 7,6%"),,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","01.bens Para Revenda","01.Bens para Revenda"),,)
				PrintOut(Li,080,(aMes[nI][2][3][1]+aMes[nI][2][3][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,aMes[nI][2][3][3],"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][3][1]+aMes[nI][2][3][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","02.bens Utilizados Como Recursos","02.Bens Utilizados como Insumos"),,)
				PrintOut(Li,080,(aMes[nI][2][4][1]+aMes[nI][2][4][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][4][3]+aMes[nI][2][4][2])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][4][1]+aMes[nI][2][4][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","03.serviços Utilizados Como Recursos","03.Serviços Utilizados como Insumos"),,)
				PrintOut(Li,080,(aMes[nI][2][6][1]+aMes[nI][2][6][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][6][3]+aMes[nI][2][6][2])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][6][1]+aMes[nI][2][6][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","04.despesas De Energia Eléctrica","04.Despesas de Energia Elétrica"),,)
				PrintOut(Li,080,(aMes[nI][2][5][1]+aMes[nI][2][5][2])*nPercInt+aMercado[01][01],"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][5][3]+aMes[nI][2][5][2])*nPercNTr+aMercado[01][02],"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][5][1]+aMes[nI][2][5][2])*nPercExt+aMercado[01][03],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","05.despesas De Alugueres De Prédios Arrendados De Pessoas Jurídicas","05.Despesas de Aluguéis de Prédios Locados de Pessoas Jurídicas"),,)
				PrintOut(Li,080,(aMes[nI][2][20][1]+aMes[nI][2][20][2])*nPercInt+aMercado[02][01],"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][20][3]+aMes[nI][2][20][2])*nPercNTr+aMercado[02][02],"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][20][1]+aMes[nI][2][20][2])*nPercExt+aMercado[02][03],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","06.Despesas De Alugueres De Máquinas E Equipamentos Arrendados De Pessoas Jurídicas","06.Despesas de Aluguéis de Máquinas e Equipamentos Locados de Pessoas Jurídicas"),,)
				PrintOut(Li,080,(aMes[nI][2][21][1]+aMes[nI][2][21][2])*nPercInt+aMercado[03][01],"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][21][3]+aMes[nI][2][21][2])*nPercNTr+aMercado[03][02],"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][21][1]+aMes[nI][2][21][2])*nPercExt+aMercado[03][03],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","07.Despesas De Armazenamento De Mercadoria E Serviço Na Operação De Venda","07.Despesas de Armazenagem de Mercadoria e Frete na Operação de Venda"),,)
				PrintOut(Li,080,(aMes[nI][2][23][1]+aMes[nI][2][23][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][23][3]+aMes[nI][2][23][2])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][23][1]+aMes[nI][2][23][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","08.Despesas De Contraprestações De Arrendamento Mercantil","08.Despesas de Contraprestações de Arrendamento Mercantil"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","09.sobre Bens Do Activo Imobilizado(com Base Nas Categorias De Desvalorização)","09.Sobre Bens do Ativo Imobilizado(Com Base nos Encargos de Depreciação)"),,)
				PrintOut(Li,080,nVDeprAt*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,115,nVDeprAt*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","10.sobre Bens Do Activo Imobilizado(com Base No Valor De Aquisição)","10.Sobre Bens do Ativo Imobilizado(Com Base no Valor de Aquisição)"),,)
				PrintOut(Li,080,nBsCrdAqI*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,nBsCrdAqI*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,nBsCrdAqE*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","11.encategorias De Amortização De Edificações E Benfeitorias","11.Encargos de Amortização de Edificações e Benfeitorias"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","12.Devolução de vendas sujeitas a aliquota de ","12.Devolução de Vendas Sujeitas a Alíquota de ")+"1,65%",If(cPaisLoc$"ANG|PTG","12.Devolução de vendas sujeitas a aliquota de ","12.Devolução de Vendas Sujeitas a Alíquota de ")+"7,6%"),,)
				PrintOut(Li,080,aMes[nI][2][7][1],"@E 99,999,999,999.99",)
				PrintOut(Li,097,nNTrib,"@E 99,999,999,999.99",)
				PrintOut(Li,115,aMes[nI][2][7][2],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","13.Outras Operações Com Direito A Crédito","13.Outras Operações com Direito a Crédito"),,)
				PrintOut(Li,080,(aMes[nI][2][22][1]+aMes[nI][2][22][2])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][2][22][3]+aMes[nI][2][22][2])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][2][22][1]+aMes[nI][2][22][2])*nPercExt,"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","14.base De Cálculo Dos Créditos","14.BASE DE CÁLCULO DOS CRÉDITOS"),,)
				PrintOut(Li,080,((nTotVlMI+nVAgrDes)*nPercInt)+aMes[nI][2][7][1],"@E 99,999,999,999.99",)
				PrintOut(Li,097,((nTotVlNTr+nVAgrDes)*nPercNTr)+nNTrib,"@E 99,999,999,999.99",)
				PrintOut(Li,115,((nTotVlEX+nVAgrDes)*nPercExt)+aMes[nI][2][7][2],"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","15.Créditos A Descontar","15.Créditos a Descontar")+" à Alíquota de 1,65%",If(cPaisLoc$"ANG|PTG","15.Créditos A Descontar","15.Créditos a Descontar")+" à Alíquota de 7,6%"),,)
				PrintOut(Li,080,(((nTotVlMI+nVAgrDes)*nPercInt)+aMes[nI][2][7][1])*(IIF(nY==1,0.0165,0.076)),"@E 99,999,999,999.99",)
				PrintOut(Li,097,(((nTotVlNTr+nVAgrDes)*nPercNTr)+nNTrib)*(IIF(nY==1,0.0165,0.076)),"@E 99,999,999,999.99",)
				PrintOut(Li,115,(((nTotVlEX+nVAgrDes)*nPercExt)+aMes[nI][2][7][2])*(IIF(nY==1,0.0165,0.076)),"@E 99,999,999,999.99",)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Apuração De Outros Créditos","APURAÇÃO DE OUTROS CRÉDITOS"),,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","16.Créditos Calculados A Aliquotas Diferenciadas","16.Créditos Calculados a Alíquotas Diferenciadas"),,)
				If nY ==1
					PrintOut(Li,080,(aMes[nI][2][1][1])*nPercInt,"@E 99,999,999,999.99",)
					PrintOut(Li,097,(aMes[nI][2][1][3])*nPercNTr,"@E 99,999,999,999.99",)
					PrintOut(Li,115,(aMes[nI][2][1][2])*nPercExt,"@E 99,999,999,999.99",)
				Else
					PrintOut(Li,080,(aMes[nI][2][2][1])*nPercInt,"@E 99,999,999,999.99",)
					PrintOut(Li,097,(aMes[nI][2][2][3])*nPercNTr,"@E 99,999,999,999.99",)
					PrintOut(Li,115,(aMes[nI][2][2][2])*nPercExt,"@E 99,999,999,999.99",)
				Endif
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","17.créditos Calculados Por Unidade De Medida De Artigo","17.Créditos Calculados por Unidade de Medida de Produto"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","18.créditos Da Actividade De Transporte De Cargas - Subcontr.serviços","18.Créditos da Atividade de Transporte de Cargas - Subcontr.Serviços"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","19.Crédito Calculado Relativo A Stock De Abertura","19.Crédito Presumido Relativo a Estoque de Abertura"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","20.créditos Da Actividade Imobiliária","20.Créditos da Atividade Imobiliária"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","21.outros Créditos A Descontar","21.Outros Créditos a Descontar"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","22.acordos Positivos De Créditos","22.Ajustes Positivos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				nAjusMI	:= ((aMes[nI][2][10][1]+aMes[nI][2][21][2])*nPercInt)*(IIF(nY==1,0.0165,0.076))
				nAjusEX	:= ((aMes[nI][2][10][3]+aMes[nI][2][21][2])*nPercExt)*(IIF(nY==1,0.0165,0.076))
				nAjusNT := ((aMes[nI][2][10][1]+aMes[nI][2][21][2])*nPercNTr)*(IIF(nY==1,0.0165,0.076))
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","23.(-)acordos Negativos De Créditos","23.(-)Ajustes Negativos de Créditos"),,)
				PrintOut(Li,080,nAjusMI,"@E 99,999,999,999.99",)
				PrintOut(Li,097,nAjusNT,"@E 99,999,999,999.99",)
				PrintOut(Li,115,nAjusEX,"@E 99,999,999,999.99",)
				li++

		        If nY ==1
					nToCreMI := ((((((nTotVlMI+nVAgrDes))*nPercInt)+aMes[nI][2][7][1])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][1][1]))-nAjusMI
					nToCreNT := ((((((nTotVlNTr+nVAgrDes))*nPercNTr)+nNTrib)           *(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][1][1]))-nAjusNT
					nToCreEX := ((((((nTotVlEX+nVAgrDes))*nPercExt)+aMes[nI][2][7][2])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][1][2]))-nAjusEX
				Else
					nToCreMI := ((((((nTotVlMI+nVAgrDes))*nPercInt)+aMes[nI][2][7][1])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][2][1]))-nAjusMI
					nToCreNT := ((((((nTotVlNTr+nVAgrDes))*nPercNTr)+nNTrib)           *(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][2][1]))-nAjusNT
					nToCreEX := ((((((nTotVlEX+nVAgrDes))*nPercExt)+aMes[nI][2][7][2])*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][2][2][2]))-nAjusEX
				Endif

				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","24.total De Créditos Apurados Após Acordos","24.TOTAL DE CRÉDITOS APURADOS APÓS AJUSTES"),,)
				PrintOut(Li,080,nToCreMI,"@E 99,999,999,999.99",)
				PrintOut(Li,097,nToCreNT,"@E 99,999,999,999.99",)
				PrintOut(Li,115,nToCreEX,"@E 99,999,999,999.99",)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Créditos Presumidos - Actividades Agro-industriais","CRÉDITOS PRESUMIDOS - ATIVIDADES AGROINDUSTRIAIS"),,)
				li++
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","25.calculados à taxa de 0,9900%","25.Calculados a Alíquota de 0,9900%"),If(cPaisLoc$"ANG|PTG","25.calculados à taxa de 4,56%","25.Calculados a Alíquota de 4,56%")),,)
				PrintOut(Li,080,((aMes[nI][2][52][1]+aMes[nI][2][52][2])*nPercInt)*(IIF(nY==1,0.0099,0.0456)),"@E 99,999,999,999.99",)
				PrintOut(Li,097,((aMes[nI][2][52][3]+aMes[nI][2][52][2])*nPercNTr)*(IIF(nY==1,0.0099,0.0456)),"@E 99,999,999,999.99",)
				PrintOut(Li,115,((aMes[nI][2][52][1]+aMes[nI][2][52][2])*nPercExt)*(IIF(nY==1,0.0099,0.0456)),"@E 99,999,999,999.99",)
				li++
				PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","26.calculados à taxa de 0,5775%","26.Calculados a Alíquota de 0,5775%"),If(cPaisLoc$"ANG|PTG","26.calculados à taxa de 2,66%","26.Calculados a Alíquota de 2,66%")),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","27.acordos Positivos De Créditos","27.Ajustes Positivos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","28.(-)acordos Negativos De Créditos","28.(-)Ajustes Negativos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","29.total De Créditos Presumidos - Actividades Agro-industriais, Após Acordos","29.TOTAL DE CRÉDITOS PRESUMIDOS - ATIVIDADES AGROINDUSTRIAIS, APÓS AJUSTES"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Créditos Decorrentes Da Aquisição De Embalagens Para Revenda","CRÉDITOS DECORRENTES DA AQUISIÇÃO DE EMBALAGENS PARA REVENDA"),,)
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","30.créditos Apurados","30.Créditos Apurados"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","31.acordos Positivos De Créditos","31.Ajustes Positivos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","32.(-)acordos Negativos De Créditos","32.(-)Ajustes Negativos de Créditos"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","33.total De Créditos Decorrentes Da Aquisição De Embalagens Para Revenda, Após Acordos","33.TOTAL DE CRÉDITOS DECORRENTES DA AQUISIÇÃO DE EMBALAGENS PARA REVENDA, APÓS AJUSTES"),,)
				PrintOut(Li,093,"----",,)
				PrintOut(Li,110,"----",,)
				PrintOut(Li,128,"----",,)
				li++



			Elseif (nY ==2 .Or.  nY ==4)
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","Apuração da contribuição para o pis/pasep - regime não cumulativo","APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP - REGIME NÃO CUMULATIVO"),If(cPaisLoc$"ANG|PTG","Apuração da cofins - regime não cumulativo","APURAÇÃO DA COFINS - REGIME NÃO CUMULATIVO")),,)
				li++



				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","01.receita de vendas de bens e serviços - taxa 1,65%","01.Receita de Vendas de Bens e Serviços - Alíq. 1,65%"),If(cPaisLoc$"ANG|PTG","01.receita de vendas de bens e serviços - taxa 7,6%","01.Receita de Vendas de Bens e Serviços - Alíq. 7,6%")),,)
				PrintOut(Li,078,aMes[nI][2][8][1]+aMes[nI][2][51][1],"@E 99,999,999,999.99",)
				PrintOut(Li,095,(aMes[nI][2][51][1]+aMes[nI][2][8][1]-(aMes[nI][2][19][1]+aMes[nI][2][15][1])),"@E 99,999,999,999.99",)
				PrintOut(Li,112,((aMes[nI][2][51][1]+aMes[nI][2][8][1]-(aMes[nI][2][19][1]+aMes[nI][2][15][1])))*IIF(nY==2,0.0165,0.076),"@E 99,999,999,999.99",)
               	nCont1 := ((aMes[nI][2][51][1]+aMes[nI][2][8][1]-(aMes[nI][2][19][1]+aMes[nI][2][15][1])))*IIF(nY==2,0.0165,0.076)
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","02.demais receitas - taxa 1,65%","02.Demais Receitas - Alíq. 1,65%"),If(cPaisLoc$"ANG|PTG","02.demais receitas - taxa 7,6%","02.Demais Receitas - Alíq. 7,6%")),,)
				PrintOut(Li,078,aMes[nI][2][9][1]+nOutRecN,"@E 99,999,999,999.99",)
				PrintOut(Li,095,(aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]),"@E 99,999,999,999.99",)
				PrintOut(Li,112,((aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==2,0.0165,0.076),"@E 99,999,999,999.99",)
                nCont2 := ((aMes[nI][2][9][1]+nOutRecN)-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==2,0.0165,0.076)
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","03.total da contribuição para o pis/pasep apurada à taxa de 1,65%","03.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 1,65%"),If(cPaisLoc$"ANG|PTG","03.total da cofins apurada à taxa de 7,6%","03.TOTAL DA COFINS APURADA A ALÍQUOTA DE 7,6%")),,)
				PrintOut(Li,112,nCont1+nCont2,"@E 99,999,999,999.99",)
				li++
				li++
				li++
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","Apuro da contribuição para o pis/pasep - regime cumulativo","APURAÇÃO DA CONTRIBUIÇÃO PARA O PIS/PASEP - REGIME CUMULATIVO"),If(cPaisLoc$"ANG|PTG","Apuração da cofins - regime cumulativo","APURAÇÃO DA COFINS - REGIME CUMULATIVO")),,)



				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","04.receita de vendas de bens e serviços - alíq. 0,65%","04.Receita de Vendas de Bens e Serviços - Aliq. 0,65%"),If(cPaisLoc$"ANG|PTG","04.receita de vendas de bens e serviços - aliq. 3%","04.Receita de Vendas de Bens e Serviços - Alíq. 3%")),,)
				PrintOut(Li,078,aMes[nI][2][12][1]+aMes[nI][2][51][1],"@E 99,999,999,999.99",)
				PrintOut(Li,095,(aMes[nI][2][51][1]+aMes[nI][2][12][1]-(aMes[nI][2][14][1]+aMes[nI][2][25][1])),"@E 99,999,999,999.99",)
				PrintOut(Li,112,((aMes[nI][2][51][1]+aMes[nI][2][12][1]-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*IIF(nY==2,0.0065,0.03),"@E 99,999,999,999.99",)
               	nCont1 := ((aMes[nI][2][51][1]+aMes[nI][2][12][1]-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*IIF(nY==2,0.0065,0.03)
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","05.demais receitas - alíq. 0,65%","05.Demais Receitas - Alíq. 0,65%"),If(cPaisLoc$"ANG|PTG","05.demais receitas - aliq. 3%","05.Demais Receitas - Alíq. 3%")),,)
				PrintOut(Li,078,aMes[nI][2][13][1]+nOutRecC,"@E 99,999,999,999.99",)
				PrintOut(Li,095,(aMes[nI][2][13][1]+nOutRecC)-(aMes[nI][2][24][1]+aMes[nI][2][26][1]),"@E 99,999,999,999.99",)
				PrintOut(Li,112,((aMes[nI][2][13][1]+nOutRecC)-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*IIF(nY==2,0.0065,0.03),"@E 99,999,999,999.99",)
                nCont2 := ((aMes[nI][2][13][1]+nOutRecC)-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*IIF(nY==2,0.0065,0.03)
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","06.receita tributada no regime de substituição tributária - alíq.0,65%","06.Receita Tributada no Regime de Substituição Tributária - Aliq.0,65%"),If(cPaisLoc$"ANG|PTG","06.receita tributada no reg.subs.tributária - aliq. 3%","06.Receita Tributada no Reg.Subs.Tributária - Alíq. 3%")),,)
				PrintOut(Li,091,"----",,)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,IIF(nY==2,If(cPaisLoc$"ANG|PTG","07.total da contribuição para o pis/pasep apurada a alíquota de 0,65%","07.TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA A ALÍQUOTA DE 0,65%"),If(cPaisLoc$"ANG|PTG","07.total da cofins apurada a alíquota de 3%","07.TOTAL DA COFINS APURADA A ALÍQUOTA DE 3%")),,)
				PrintOut(Li,112,nCont1+nCont2,"@E 99,999,999,999.99",)
				li++
				li++
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Outras Receitas Aferidas","OUTRAS RECEITAS AUFERIDAS"),,)
				li++
				PrintOut(Li,001,"08.Receita Tributada a Alíquota Zero",,)
				PrintOut(Li,078,aMes[nI][2][29][1]+aRecAuf[1],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","09.receita tributada a alíquota zero-revenda prod. Sujeitos trib. Monof.","09.Receita Tributada a Alíquota Zero-Revenda Prod. Sujeitos Trib. Monof."),,)
				PrintOut(Li,078,aMes[nI][2][30][1]+aRecAuf[2],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","10.receita De Vendas De Bens Do Activo Permanente","10.Receita de Vendas de Bens do Ativo Permanente"),,)
				PrintOut(Li,078,aMes[nI][2][31][1]+aRecAuf[3],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","11.receita sem incidência da contribuição - exportação","11.Receita sem Incidência da Contribuição - Exportação"),,)
				PrintOut(Li,078,aMes[nI][2][27][1]+aRecAuf[4],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","12.receita isenta e demais receitas sem incid.contribuição","12.Receita Isenta e Demais Receitas sem Incid.Contribuição"),,)
				PrintOut(Li,078,aMes[nI][2][32][1]+aRecAuf[5],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","13.receita com suspensão da contribuição","13.Receita com Suspensão da Contribuição"),,)
				PrintOut(Li,078,aMes[nI][2][33][1]+aRecAuf[6],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","14.receita de revenda dec.operações suj.subs.tribut.","14.Receita de Revenda Dec.Operações Suj.Subs.Tribut."),,)
				PrintOut(Li,078,aMes[nI][2][34][1]+aRecAuf[7],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","15.receita tributada pelo ret -património de afectação","15.Receita Tributada pelo RET -Patrimônio de Afetação"),,)
				PrintOut(Li,078,aMes[nI][2][35][1]+aRecAuf[8],"@E 99,999,999,999.99",)
				PrintOut(Li,108,"----",,)
				PrintOut(Li,125,"----",,)
				li++
				li++
				If nY==2
					PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","16.contribuição para o pis/pasep -folha de salários","16.CONTRIBUIÇÃO PARA O PIS/PASEP -FOLHA DE SALÁRIOS"),,)
					If lPisFolha .Or.  lPisFolSN
					    PrintOut(Li,078,"    ",,)
					    PrintOut(Li,095,aMes[nI][2][36][2],"@E 99,999,999,999.99",)
					    PrintOut(Li,113,aMes[nI][2][36][2]*0.01,"@E 99,999,999,999.99",)
					Else
					    PrintOut(Li,091,"    ",,)
					    PrintOut(Li,108,"----",,)
					    PrintOut(Li,125,"----",,)
				    EndIf
				Endif
			Endif
		Next






		For nY:= 1 To 2
			nVlrTot := 0
			cCabec2:= cCabec6
			li := cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
			li++
			If nY == 1
				PrintOut(Li,001,"Ficha 15B - RESUMO - Contribuição para o PIS/Pasep - Regime Não Cumulativo",,)
				nScan := aScan(aWizNCum,{|x| x[2]=="Ficha 15B - RESUMO - Contribuição para o PIS/Pasep - Regime Não Cumulativo" } )
			Else
				PrintOut(Li,001,"Ficha 25B - Cofins - Regime Não-Cumulativo",,)
				nScan := aScan(aWizNCum,{|x| x[2]=="Ficha 25B - Cofins - Regime Não-Cumulativo" } )
			Endif
			li++
			PrintOut(Li,000,Repli("-",Limite),,)
			li++
			PrintOut(Li,001,IIF(nY==1,"CONTRIBUIÇÃO PARA PIS/PASEP - RESUMO","CONTRIBUIÇÃO PARA COFINS - RESUMO"),,)
			li++
			li++
			PrintOut(Li,001,IIF(nY==1,"01. Contribuição para o PIS/Pasep Apurada","01. Cofins Apurada"),,)



			PrintOut(Li,108,((aMes[nI][2][8][1]+aMes[nI][2][51][1])-(aMes[nI][2][19][1]+aMes[nI][2][15][1]))*IIF(nY==1,0.0165,0.076)+((aMes[nI][2][9][1]+aMes[nI][2][38][1])-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==1,0.0165,0.076)+(((aMes[nI][2][12][1]+aMes[nI][2][51][1])-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*IIF(nY==1,0.0065,0.076)+((aMes[nI][2][13][1]+aMes[nI][2][39][1])-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*IIF(nY==1,0.0065,0.076),"@E 99,999,999,999.99",)



			nCont1 := ((aMes[nI][2][8][1]+aMes[nI][2][51][1])-(aMes[nI][2][19][1]+aMes[nI][2][15][1]))*IIF(nY==1,0.0165,0.076)+ ((aMes[nI][2][9][1]+aMes[nI][2][38][1])-(aMes[nI][2][11][1]+aMes[nI][2][16][1]))*IIF(nY==1,0.0165,0.076) + (((aMes[nI][2][12][1]+aMes[nI][2][51][1])-(aMes[nI][2][14][1]+aMes[nI][2][25][1])))*IIF(nY==1,0.0065,0.076) + ((aMes[nI][2][13][1]+aMes[nI][2][39][1])-(aMes[nI][2][24][1]+aMes[nI][2][26][1]))*IIF(nY==1,0.0065,0.076)
			nVlrTot+=nCont1
			li++
			dbSelectArea("TMP")
			cMes :=	StrZero(aMes[nI,1],2)
			If dbSeek(cMes)
				If nY == 1
					nPis := TMP->PIS
					cCod := TMP->CODIGO
					While !Eof() .And.  TMP->MES == cMes
						While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
							Do Case
								Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
								Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
								Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
							EndCase
							dbSelectArea("TMP")
							dbSkip()
						Enddo
						cMes :=	StrZero(aMes[nI,1],2)
						n09A_15 += (nItem1+nItem2+nItem3) * nPis / 100
						nPis 	:= TMP->PIS
						cCod 	:= TMP->CODIGO
						nItem1	:= 0
						nItem2	:= 0
						nItem3	:= 0
					Enddo
				Else
					nCof := TMP->COFINS
					cCod := TMP->CODIGO
					While !Eof() .And.  TMP->MES == cMes
						While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
							Do Case
								Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
								Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
								Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
							EndCase
							dbSelectArea("TMP")
							dbSkip()
						Enddo
						cMes :=	StrZero(aMes[nI,1],2)
						n09A_25 += (nItem1+nItem2+nItem3) * nCof / 100
						nCof 	:= TMP->COFINS
						cCod 	:= TMP->CODIGO
						nItem1	:= 0
						nItem2	:= 0
						nItem3	:= 0
					Enddo
				Endif
			Endif
			PrintOut(Li,001,IIF(nY==1,"02. Contribuição para o PIS/Pasep Apurada - Alíquotas Diferenciadas","02. Cofins Apurada - Alíquotas Diferenciadas"),,)
			PrintOut(Li,108,IIF(nY==1,n09A_15,n09A_25),"@E 99,999,999,999.99",)
			IIF(nY==1,nCont1:=n09A_15,nCont1:=n09A_25)
			nVlrTot+=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"03. Contribuição para o PIS/Pasep - Alíquotas Diferenciadas - Substituto Tributário","03. Cofins Apurada – Alíquotas Diferenciadas – Sunstituto Tributário"),,)
			PrintOut(Li,120,"----",,)
			li++
			dbSelectArea("T01")
			cMes :=	StrZero(aMes[nI,1],2)
			If dbSeek(cMes)
				If nY == 1
					nPis := T01->PIS
					cCod := T01->CODIGO
					While !Eof() .And.  T01->MES == cMes
						While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
							nItem1 += T01->VALOR
							nQuant += T01->QUANT
							dbSelectArea("T01")
							dbSkip()
						Enddo
						cMes :=	StrZero(aMes[nI,1],2)
						n10A_15 += nQuant * nPis
						nPis 	:= T01->PIS
						cCod 	:= T01->CODIGO
						nItem1	:= 0
						nQuant  := 0
					Enddo
			  	Else
			   	   	nCof := T01->COFINS
					cCod := T01->CODIGO
					While !Eof() .And.  T01->MES == cMes
						While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
							nItem1 += T01->VALOR
							nQuant += T01->QUANT
							dbSelectArea("T01")
							dbSkip()
						Enddo
						cMes :=	StrZero(aMes[nI,1],2)
						n10A_25 += nQuant * nCof
						nCof 	:= T01->COFINS
						cCod 	:= T01->CODIGO
						nItem1	:= 0
						nQuant  := 0
					Enddo
				Endif
			Endif
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Artigo","04. Contribuição para o PIS/Pasep Apurada - Alíquotas por Unidade de Medida de Produto"),"04. Cofins Apurada – Alíquotas por Unidade de Medida de Produto"),,)
			PrintOut(Li,108,IIF(nY==1,n10A_15,n10A_25),"@E 99,999,999,999.99",)
			IIF(nY==1,nCont1:=n10A_15,nCont1:=n10A_25)
			nVlrTot+=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Artigo - ST","05. Contribuição para o PIS/pasep - Alíquotas por Unidade de Medida de Produto - ST"),"05. Cofins Apurada – Alíquotas por Unidade de Medida de Produto – Substituto Tributário"),,)
			PrintOut(Li,120,"----",,)
			li++
			PrintOut(Li,001,IIF(nY==1,"06. Contribuição Diferida em meses anteriores","06. Cofins Diferida em Meses Anteriores"),,)
			PrintOut(Li,120,"----",,)
			li++
			PrintOut(Li,001,IIF(nY==1,"07. (-) Contribuição Diferida no Mês","07. (-) Cofins Diferida no Mês"),,)
			PrintOut(Li,120,"----",,)
			li++
			PrintOut(Li,001,IIF(nY==1,"08. TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP APURADA NO MÊS","08. TOTAL DA COFINS APURADA NO MÊS"),,)
		    PrintOut(Li,108,nVlrTot,"@E 99,999,999,999.99",)
			li++
			li++
			PrintOut(Li,001,"CRÉDITOS DESCONTADOS REFERENTES A AQUISIÇÕES NO MERCADO INTERNO",,)
			li++
			li++
			PrintOut(Li,001,"09. (-) Vinculados à Receita Tributada no Mercado Interno",,)
		    PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][1]),nCont1:=Val(aNCumVlr[nScan][1])),"@E 99,999,999,999.99",)
		    nVlrTot-=nCont1
			li++
			PrintOut(Li,001,"10. (-) Vinculados à Receita Não Tributada no Mercado Interno",,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][2]),nCont1:=Val(aNCumVlr[nScan][2])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,"11. (-) Vinculados à Receita de Exportação",,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][3]),nCont1:=Val(aNCumVlr[nScan][3])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","12. (-) Presumido - Actividades Agroindustriais","12. (-) Presumido - Atividades Agroindustriais"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][4]),nCont1:=Val(aNCumVlr[nScan][4])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,"13. (-) Vinculados a Embalagens para Revenda",,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][5]),nCont1:=Val(aNCumVlr[nScan][5])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			li++
			PrintOut(Li,001,"CRÉDITOS DESCONTADOS REFERENTES A IMPORTAÇÕES",,)
			li++
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","14. (-) Vinculados à Receita Tributada no Mercado Interno","14. (-) Vinculados a Receita Tributada no Mercado Interno"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][6]),nCont1:=Val(aNCumVlr[nScan][6])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","15. (-) Vinculados à Receita Não Tributada no Mercado Interno","15. (-) Vinculados a Receita não Tributada no Mercado Interno"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][7]),nCont1:=Val(aNCumVlr[nScan][7])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","16. (-) Vinculados à Receita de Exportação","16. (-) Vinculados a Receita de Exportação"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][8]),nCont1:=Val(aNCumVlr[nScan][8])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"17. TOTAL DA CONTRIBUIÇÃO PARA O PIS/PASEP DEVIDA NO MÊS","17. TOTAL DA CONTRIBUIÇÃO DEVIDA NO MÊS"),,)
			PrintOut(Li,108,nVlrTot,"@E 99,999,999,999.99",)
			li++
			li++
			PrintOut(Li,001,"DEDUÇÕES",,)
			li++
			li++
			PrintOut(Li,001,IIF(nY==1,"18. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações Federais","18. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações Federais"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][9]),nCont1:=Val(aNCumVlr[nScan][9])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"19. (-) PIS/Pasep Retida na Fonte pelas Demais Entidades da Administração Pública Federal","19. (-) Cofins Retida na Fonte pelas Demais Entidades da Administração Pública Federal"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][10]),nCont1:=Val(aNCumVlr[nScan][10])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"20. (-) PIS/Pasep Retida na Fonte por Pessoas Jurídicas de Direito Privado","20. (-) Cofins Retida na Fonte por Pessoas Jurídicas de Direito Privado"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][11]),nCont1:=Val(aNCumVlr[nScan][11])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"21. (-) PIS/Pasep Retida na Fonte por Órgãos, Autarquias e Fundações dos Estados, DF e Municípios","21. (-) Cofins Retida na Fonte por Órgãos, Autarquias e Fundações dos Estados, DF e Municípios"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][12]),nCont1:=Val(aNCumVlr[nScan][12])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"22. (-) PIS/Pasep Retida na Fonte por Sociedade Cooperativa","22. (-) Cofins Retida na Fonte por Sociedade Cooperativa"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][13]),nCont1:=Val(aNCumVlr[nScan][13])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"23. (-) PIS/Pasep Retida na Fonte por Fabricantes de Veículos e Máquinas","23. (-) Cofins Retida na Fonte por Fabricantes de Veículos e Máquinas"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][14]),nCont1:=Val(aNCumVlr[nScan][14])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","24. (-) PIS/Pasep Substituição pela Não Ocorrência do Facto Gerador Presumido","24. (-) PIS/Pasep Substituição pela não ocorrência do Fato Gerador Presumido"),"24. (-) Cofins Substituição pela não Ocorrência do Fato Gerador Presumido"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][15]),nCont1:=Val(aNCumVlr[nScan][15])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"25. (-) Crédito Presumido - Medicamentos","25. (-) Crédito Presumido – Medicamentos"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][16]),nCont1:=Val(aNCumVlr[nScan][16])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"26. (-) Créditos Admitidos no Regime Cumulativo","26. (-) Créditos Admitidos no Regime Cumulativo"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][17]),nCont1:=Val(aNCumVlr[nScan][17])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"27. (-) PIS/Pasep paga pelo Substituto Tributário","27. (-) Cofins Paga pelo Substituto Tributário"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][18]),nCont1:=Val(aNCumVlr[nScan][18])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,"28. (-) Outras Deduções","28. (-) Outras Deduções"),,)
			PrintOut(Li,108,IIF(nY==1,nCont1:=Val(aNCumVlr[nScan][19]),nCont1:=Val(aNCumVlr[nScan][19])),"@E 99,999,999,999.99",)
			nVlrTot-=nCont1
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","29. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FACTURAÇÃO","29. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FATURAMENTO"),"29. COFINS A PAGAR – FATURAMENTO"),,)
			PrintOut(Li,108,nVlrTot,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,IIF(nY==1,"30. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR - FOLHA DE SALÁRIOS","30. COFINS A PAGAR DE SCP"),,)
			PrintOut(Li,108,IIF(nY==1,Val(aNCumVlr[nScan][20]),Val(aNCumVlr[nScan][20])),"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,IIF(nY==1,"31. CONTRIBUIÇÃO PARA O PIS/PASEP A PAGAR DE SCP","31. COFINS A PAGAR RETIDA DE COOPERADOS"),,)
			PrintOut(Li,108,IIF(nY==1,Val(aNCumVlr[nScan][21]),Val(aNCumVlr[nScan][21])),"@E 99,999,999,999.99",)
			li++
			IF nY == 1
				PrintOut(Li,001,"32. CONTRIBUIÇAO PARA O PIS/PASEP A PAGAR RETIDA DE COOPERADOS",,)
				PrintOut(Li,108,Val(aNCumVlr[nScan][22]),"@E 99,999,999,999.99",)
			EndIf
			li++
		Next
	Endif




	If mv_par09 == 2 .And.  Len(aMes[nI])>=3

		nTotVlMI :=0
		nTotVlMI += aMes[nI][3][3][1]+aMes[nI][3][4][1]+aMes[nI][3][6][1]+aMes[nI][3][5][1]+aMes[nI][3][20][1]+aMes[nI][3][22][1]+nBsCrdAqI+nVDeprAt





		If aMes[nI][2][17][1] <> 0 .Or.  aMes[nI][2][18][1] <> 0 .Or.  aMes[nI][2][36][1] <> 0
			nPercInt := aMes[nI][2][17][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
			nPercExt := aMes[nI][2][18][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
			nPercNTr := aMes[nI][2][36][1] / (aMes[nI][2][17][1] + aMes[nI][2][18][1] + aMes[nI][2][36][1])
		Else
	       	nPercInt := 1
	       	nPercExt := 0
	       	nPercNTr := 0
		Endif

		cCabec1:= cCabec3+" - "+Alltrim(MesExtenso(aMes[nI][1]))+Space(10)+"Vinculados à Receita"
		cCabec2:= cCabec5
		For nY:= 1 To 2
			li := cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
			li++

			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","Ficha 06B - Apuramento dos créditos de PIS/PASEP - importação - regime não cumulativo","Ficha 06B - Apuração dos Créditos de PIS/PASEP - Importação - Regime Não Cumulativo"),If(cPaisLoc$"ANG|PTG","Ficha 16B - Apuramento dos créditos da COFINS - importação - regime não cumulativo","Ficha 16B - Apuração dos Créditos da COFINS - Importação - Regime Não Cumulativo")),,)

			li++
			PrintOut(Li,000,Repli("-",Limite),,)
			li++



			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE")+" 1,65%",If(cPaisLoc$"ANG|PTG","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE","BASE DE CÁLCULO DOS CRÉDITOS À ALÍQUOTA DE")+" 7,6%"),,)
			li++
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","01.bens Para Revenda","01.Bens para Revenda"),,)
			PrintOut(Li,080,(aMes[nI][3][3][1])*nPercInt,"@E 99,999,999,999.99",)
			PrintOut(Li,097,(aMes[nI][3][3][1])*nPercNTr,"@E 99,999,999,999.99",)
			PrintOut(Li,115,(aMes[nI][3][3][1])*nPercExt,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","02.bens Utilizados Como Recursos","02.Bens Utilizados como Insumos"),,)
			PrintOut(Li,080,(aMes[nI][3][4][1])*nPercInt,"@E 99,999,999,999.99",)
			PrintOut(Li,097,(aMes[nI][3][4][1])*nPercNTr,"@E 99,999,999,999.99",)
			PrintOut(Li,115,(aMes[nI][3][4][1])*nPercExt,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","03.serviços Utilizados Como Recursos","03.Serviços Utilizados como Insumos"),,)
			PrintOut(Li,080,(aMes[nI][3][6][1])*nPercInt,"@E 99,999,999,999.99",)
			PrintOut(Li,097,(aMes[nI][3][6][1])*nPercNTr,"@E 99,999,999,999.99",)
			PrintOut(Li,115,(aMes[nI][3][6][1])*nPercExt,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","04.despesas De Energia Eléctrica","04.Despesas de Energia Elétrica"),,)
			PrintOut(Li,080,(aMes[nI][3][5][1])*nPercInt,"@E 99,999,999,999.99",)
			PrintOut(Li,097,(aMes[nI][3][5][1])*nPercNTr,"@E 99,999,999,999.99",)
			PrintOut(Li,115,(aMes[nI][3][5][1])*nPercExt,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","05.Despesas de aluguéres de prédios","05.Despesas de Alugueis de Predios"),,)
			PrintOut(Li,080,(aMes[nI][3][20][1])*nPercInt,"@E 99,999,999,999.99",)
			PrintOut(Li,097,(aMes[nI][3][20][1])*nPercNTr,"@E 99,999,999,999.99",)
			PrintOut(Li,115,(aMes[nI][3][20][1])*nPercExt,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","06.Sobre bens do activo imobilizado(com base nos encargos de depreciação)","06.Sobre Bens do Ativo Imobilizado(Com Base nos Encargos de Depreciação)"),,)
			PrintOut(Li,080,nVDeprAt*nPercInt,"@E 99,999,999,999.99",)
			PrintOut(Li,110,"----",,)
			PrintOut(Li,115,nVDeprAt*nPercExt,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","07.Sobre bens do activo Imobilizado(com base no valor de aquisição)","07.Sobre Bens do Ativo Imobilizado(Com Base no Valor de Aquisição)"),,)
			PrintOut(Li,080,nBsCrdAqI*nPercInt,"@E 99,999,999,999.99",)
			PrintOut(Li,097,nBsCrdAqI*nPercNTr,"@E 99,999,999,999.99",)
			PrintOut(Li,115,nBsCrdAqE*nPercExt,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","08.Outras operações com direito a crédito","08.Outras Operacoes com Direito a Credito"),,)
			PrintOut(Li,080,(aMes[nI][3][22][1])*nPercInt,"@E 99,999,999,999.99",)
			PrintOut(Li,097,(aMes[nI][3][22][1])*nPercNTr,"@E 99,999,999,999.99",)
			PrintOut(Li,115,(aMes[nI][3][22][1])*nPercExt,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","09.BASE DE CÁLCULO DOS CRÉDITOS","09.BASE DE CALCULO DOS CREDITOS"),,)
			PrintOut(Li,080,nTotVlMI*nPercInt,"@E 99,999,999,999.99",)
			PrintOut(Li,097,nTotVlMI*nPercNTr,"@E 99,999,999,999.99",)
			PrintOut(Li,115,nTotVlMI*nPercExt,"@E 99,999,999,999.99",)
			li++
			PrintOut(Li,001,IIF(nY==1,If(cPaisLoc$"ANG|PTG","10.Créditos a descontar","10.Creditos a Descontar")+" à Alíquota de 1,65%",If(cPaisLoc$"ANG|PTG","10.Créditos a descontar","10.Creditos a Descontar")+" à Alíquota de 7,6%"),,)
			PrintOut(Li,080,(nTotVlMI*nPercInt)*(IIF(nY==1,0.0165,0.076)),"@E 99,999,999,999.99",)
			PrintOut(Li,097,(nTotVlMI*nPercNTr)*(IIF(nY==1,0.0165,0.076)),"@E 99,999,999,999.99",)
			PrintOut(Li,115,(nTotVlMI*nPercExt)*(IIF(nY==1,0.0165,0.076)),"@E 99,999,999,999.99",)
			li++
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","Apuração De Outros Créditos","APURAÇÃO DE OUTROS CRÉDITOS"),,)
			li++
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","11.Créditos calculados alíquotas diferenciadas","11.Creditos Calculados a Aliquotas Diferenciadas"),,)
			If nY ==1
				PrintOut(Li,080,(aMes[nI][3][1][1])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][3][1][1])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][3][1][1])*nPercExt,"@E 99,999,999,999.99",)
			Else
				PrintOut(Li,080,(aMes[nI][3][2][1])*nPercInt,"@E 99,999,999,999.99",)
				PrintOut(Li,097,(aMes[nI][3][2][1])*nPercNTr,"@E 99,999,999,999.99",)
				PrintOut(Li,115,(aMes[nI][3][2][1])*nPercExt,"@E 99,999,999,999.99",)
			Endif
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","12.Créditos calculados por unidade de medida de artigo","12.Creditos Calculados por Unidade de Medida de Produto"),,)
			PrintOut(Li,093,"----",,)
			PrintOut(Li,110,"----",,)
			PrintOut(Li,128,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","13.Crédito presumido Relat. Stock de Abertura - Álcool","13.Crédito presumido Relat. Estoque de Abertura - Álcool"),,)
			PrintOut(Li,093,"----",,)
			PrintOut(Li,110,"----",,)
			PrintOut(Li,128,"----",,)
            li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","14.Créditos da Actividade Imobiliária","14.Creditos da Atividade Imobiliária"),,)
			PrintOut(Li,093,"----",,)
			PrintOut(Li,110,"----",,)
			PrintOut(Li,128,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","15.Outros Créditos a Descontar","15.Outros Creditos a Descontar"),,)
			PrintOut(Li,093,"----",,)
			PrintOut(Li,110,"----",,)
			PrintOut(Li,128,"----",,)
			li++
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","16.Ajustes Positivos de Créditos","16.Ajustes Positivos de Creditos"),,)
			PrintOut(Li,093,"----",,)
			PrintOut(Li,110,"----",,)
			PrintOut(Li,128,"----",,)
			li++
			nAjusMI	:= ((aMes[nI][3][10][1])*nPercInt)*(IIF(nY==1,0.0165,0.076))
			nAjusEX	:= ((aMes[nI][3][10][1])*nPercExt)*(IIF(nY==1,0.0165,0.076))
			nAjusNT := ((aMes[nI][3][10][1])*nPercNTr)*(IIF(nY==1,0.0165,0.076))
			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","17.(-)Ajustes Negativos de Créditos","17.(-)Ajustes Negativos de Creditos"),,)
			PrintOut(Li,080,nAjusMI,"@E 99,999,999,999.99",)
			PrintOut(Li,097,nAjusNT,"@E 99,999,999,999.99",)
			PrintOut(Li,115,nAjusEX,"@E 99,999,999,999.99",)
			li++

	        If nY ==1
				nToCreMI := ((((nTotVlMI)*nPercInt)*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][3][1][1]))-nAjusMI
				nToCreNT := ((((nTotVlMI)*nPercNTr)*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][3][1][1]))-nAjusNT
				nToCreEX := ((((nTotVlMI)*nPercExt)*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][3][1][1]))-nAjusEX
			Else
				nToCreMI := ((((nTotVlMI)*nPercInt)*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][3][2][1]))-nAjusMI
				nToCreNT := ((((nTotVlMI)*nPercNTr)*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][3][2][1]))-nAjusNT
				nToCreEX := ((((nTotVlMI)*nPercExt)*(IIF(nY==1,0.0165,0.076)))+(aMes[nI][3][2][1]))-nAjusEX
			Endif

			PrintOut(Li,001,If(cPaisLoc$"ANG|PTG","18.TOTAL DE CRÉDITOS APURADOS APÓS AJUSTES","18.TOTAL DE CREDITOS APURADOS APOS AJUSTES"),,)
			PrintOut(Li,080,nToCreMI,"@E 99,999,999,999.99",)
			PrintOut(Li,097,nToCreNT,"@E 99,999,999,999.99",)
			PrintOut(Li,115,nToCreEX,"@E 99,999,999,999.99",)
			li++

		Next
	EndIf




	If mv_par07 == 2
		Impf09(aMes[nI,1],Titulo,nPagina,NomeProg,Tamanho,cCabec1)
	Endif




	If mv_par12 == 2
		Impf10(aMes[nI,1],Titulo,nPagina,NomeProg,Tamanho,cCabec1)
	Endif

	If mv_par14 == 2
		Impf11(Titulo,nPagina,NomeProg,Tamanho,cCabec1,"PIS")
		Impf11(Titulo,nPagina,NomeProg,Tamanho,cCabec1,"COF")
		Impf12(Titulo,nPagina,NomeProg,Tamanho,cCabec1,"PIS")
		Impf12(Titulo,nPagina,NomeProg,Tamanho,cCabec1,"COF")
	EndIf

next

Return( .T. )














Static Function Gravaf09(nMes,cItem,nPPis,nPCofins,nValor)

Local aArea	:= GetArea()

If cItem == "01"
	nValor := SD2->D2_TOTAL+SD2->D2_ICMSRET+SD2->D2_VALFRE+SD2->D2_SEGURO+SD2->D2_DESPESA+SD2->D2_VALIPI
Endif

dbSelectArea("TMP")
dbSetOrder(1)
If !dbSeek(StrZero(nMes,2)+cItem+Str(nPPis,5,2)+Str(nPCofins,5,2))
	RecLock("TMP", .T. )
	TMP->MES	:= StrZero(nMes,2)
	TMP->CODIGO	:= SD2->D2_COD
	TMP->ITEM	:= cItem
	TMP->PIS	:= nPPis
	TMP->COFINS	:= nPCofins
Else
	RecLock("TMP", .F. )
Endif
TMP->VALOR	+= nValor
MsUnlock()

RestArea(aArea)

Return Nil














Static Function Gravaf10(nMes,cItem,nPPis,nPCofins,nValor)

Local aArea	:= GetArea()

If cItem == "01"
	nValor := SD2->D2_TOTAL+SD2->D2_ICMSRET+SD2->D2_VALFRE+SD2->D2_SEGURO+SD2->D2_DESPESA+SD2->D2_VALIPI
	nQuant := SD2->D2_QUANT

	If mv_par15 == 2 .AND.  SB1->B1_UM <> SB1->B1_SEGUM
		If SB1->B1_TIPCONV == "D"
			nQuant /= SB1->B1_CONV
			nValor *= SB1->B1_CONV
		Else
			nQuant *= SB1->B1_CONV
			nValor /= SB1->B1_CONV
		Endif
	Endif
Endif

dbSelectArea("T01")
dbSetOrder(1)

If !dbSeek(StrZero(nMes,2)+SD2->D2_COD+cItem)
	RecLock("T01", .T. )
	T01->MES	:= StrZero(nMes,2)
	T01->CODIGO	:= SD2->D2_COD
	T01->ITEM	:= cItem
	T01->PIS	:= nPPis
	T01->COFINS	:= nPCofins
Else
	RecLock("T01", .F. )
Endif
T01->VALOR	+= nValor
T01->QUANT  += nQuant
MsUnlock()

RestArea(aArea)

Return Nil















Static Function Impf09(nMes,Titulo,nPagina,NomeProg,Tamanho,cCabec1)

Local aArea		:= GetArea()
Local cCabec2	:= If( cPaisLoc $ "ANG|PTG", "Discriminação                                                        Receita De Vendas     Base Cálculo     Taxa%     Val.apurado", "Discriminacao                                                        Receita de Vendas     Base Cálculo     Alíquota%     Vl.Apurado" )
Local cMes		:= StrZero(nMes,2)
Local cCod		:= ""
Local nLin		:= 0
Local nPis		:= 0
Local nCof		:= 0
Local nItem1	:= 0
Local nItem2	:= 0
Local nItem3	:= 0

dbSelectArea("TMP")
If dbSeek(cMes)



	nLin := Cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
	PrintOut(++nLin,001,OemToAnsi(If(cPaisLoc$"ANG|PTG","Ficha 09a - Cálculo Da Contribuição Para O Pis/pasep - Taxas Diferenciadas","Ficha 09A - Cálculo da Contribuição para o PIS/PASEP - Alíquotas Diferenciadas")),,)
	PrintOut(++nLin,000,Replicate("-",Limite),,)
	nPis := TMP->PIS
	cCod := TMP->CODIGO
	While !Eof() .And.  TMP->MES == cMes
		While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
			Do Case
				Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
				Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
				Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
			EndCase
			dbSelectArea("TMP")
			dbSkip()
		Enddo
		PrintOut(++nLin,001,"Produto: "+Alltrim(cCod)+" - "+Alltrim(Posicione("SB1",1,xFilial("SB1")+cCod,"B1_DESC")),,)
		PrintOut(nLin,070,nItem1,"@E 99,999,999,999.99",)
		PrintOut(nLin,087,(nItem1-(nItem2+nItem3)),"@E 99,999,999,999.99",)
		PrintOut(nLin,109,nPis,"@E 99.99",)
		PrintOut(nLin,114,(((nItem1-(nItem2+nItem3))*nPis)/100),"@E 99,999,999,999.99",)
		nPis 	:= TMP->PIS
		cCod 	:= TMP->CODIGO
		nItem1	:= 0
		nItem2	:= 0
		nItem3	:= 0
	Enddo
Endif

dbSelectArea("TMP")
If dbSeek(cMes)



	nLin := Cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
	PrintOut(++nLin,001,OemToAnsi(If(cPaisLoc$"ANG|PTG","Ficha 19a - Cálculo Da Cofins - Taxas Diferenciadas","Ficha 19A - Cálculo da Cofins - Alíquotas Diferenciadas")),,)
	PrintOut(++nLin,000,Replicate("-",Limite),,)
	nCof := TMP->COFINS
	cCod := TMP->CODIGO
	While !Eof() .And.  TMP->MES == cMes
		While !Eof() .And.  TMP->MES == cMes .And.  TMP->CODIGO == cCod
			Do Case
				Case TMP->ITEM == "01"	;	nItem1 := TMP->VALOR
				Case TMP->ITEM == "02"	;	nItem2 := TMP->VALOR
				Case TMP->ITEM == "03"	;	nItem3 := TMP->VALOR
			EndCase
			dbSelectArea("TMP")
			dbSkip()
		Enddo
		PrintOut(++nLin,001,"Produto: "+Alltrim(cCod)+" - "+Alltrim(Posicione("SB1",1,xFilial("SB1")+cCod,"B1_DESC")),,)
		PrintOut(nLin,070,nItem1,"@E 99,999,999,999.99",)
		PrintOut(nLin,087,(nItem1-(nItem2+nItem3)),"@E 99,999,999,999.99",)
		PrintOut(nLin,109,nCof,"@E 99.99",)
		PrintOut(nLin,114,(((nItem1-(nItem2+nItem3))*nCof)/100),"@E 99,999,999,999.99",)
		nCof 	:= TMP->COFINS
		cCod 	:= TMP->CODIGO
		nItem1	:= 0
		nItem2	:= 0
		nItem3	:= 0
	Enddo
Endif

RestArea(aArea)

Return Nil















Static Function Impf10(nMes,Titulo,nPagina,NomeProg,Tamanho,cCabec1)

Local cCabec2	:= If( cPaisLoc $ "ANG|PTG", "Discriminação                                                        Receita De Vendas     Base Cálculo     Taxa%     Val.apurado", "Discriminacao                                                        Receita de Vendas     Base Cálculo     Alíquota%     Vl.Apurado" )
Local cMes		:= StrZero(nMes,2)
Local cCod		:= ""
Local nLin		:= 0
Local nPis		:= 0
Local nCof		:= 0
Local nItem1	:= 0
Local nQuant	:= 0
Local cDsc		:= ""

dbSelectArea("T01")
If dbSeek(cMes)



	nLin := Cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
	PrintOut(++nLin,001,OemToAnsi(If(cPaisLoc$"ANG|PTG","Ficha 10a - Cálculo da Contribuição para o Pis/Pasep - Alíquotas por Unidade de Medida","Ficha 10a - Cálculo Da Contribuição Para O Pis/pasep - Aliquotas por Unidade de Medida")),,)
	PrintOut(++nLin,000,Replicate("-",Limite),,)
	nPis := T01->PIS
	cCod := T01->CODIGO
	cDsc := Posicione("SB1",1,xFilial("SB1")+cCod,"B1_DESC")
	While !Eof() .And.  T01->MES == cMes
		While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
			nItem1 += T01->VALOR
			nQuant += T01->QUANT
			dbSelectArea("T01")
			dbSkip()
		Enddo
		PrintOut(++nLin,001,"Produto: "+Alltrim(cCod)+" - "+Alltrim(cDsc),,)
		PrintOut(nLin,070,nItem1,"@E 99,999,999,999.99",)
		PrintOut(nLin,087,nQuant,"@E 99999999.99",)
		PrintOut(nLin,109,nPis,"@E 99.9999",)
		PrintOut(nLin,114,nQuant*nPis,"@E 99,999,999,999.99",)
		nPis 	:= T01->PIS
		cCod 	:= T01->CODIGO
		nItem1	:= 0
		nQuant  := 0
	Enddo
Endif


dbSelectArea("T01")
If dbSeek(cMes)



	nLin := Cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
	PrintOut(++nLin,001,OemToAnsi("Ficha 20A - Cálculo da Cofins - Alíquotas por Unidade de Medida de Produto"),,)
	PrintOut(++nLin,000,Replicate("-",Limite),,)
	nCof := T01->COFINS
	cCod := T01->CODIGO
	While !Eof() .And.  T01->MES == cMes
		While !Eof() .And.  T01->MES == cMes .And.  T01->CODIGO == cCod
			nItem1 += T01->VALOR
			nQuant += T01->QUANT
			dbSelectArea("T01")
			dbSkip()
		Enddo
		PrintOut(++nLin,001,"Produto: "+Alltrim(cCod)+" - "+Alltrim(Posicione("SB1",1,xFilial("SB1")+cCod,"B1_DESC")),,)
		PrintOut(nLin,070,nItem1,"@E 99,999,999,999.99",)
		PrintOut(nLin,087,nQuant,"@E 99999999.99",)
		PrintOut(nLin,109,nCof,"@E 99.9999",)
		PrintOut(nLin,114,nQuant*nCof,"@E 99,999,999,999.99",)
		nCof 	:= T01->COFINS
		cCod 	:= T01->CODIGO
		nItem1	:= 0
		nQuant  := 0
	Enddo
Endif

Return Nil
















Static Function Impf11(Titulo,nPagina,NomeProg,Tamanho,cCabec1,cTpCon)

Local aArea		:= GetArea()
Local cCabec2	:= IIf(cTpCon=="PIS","Ficha 11 - Controle do Diferimento - Valores Adicionados no Mês - PIS/Pasep","Ficha 21 - Controle do Diferimento - Valores Adicionados no Mês - Cofins")
Local cDtPer	:= StrZero(Month(mv_par02), 2)+StrZero(Year(mv_par02),4)
Local cRegApur	:= ""

Do Case
	Case mv_par06 == 1 ; cRegApur := "Regime Cumulativo"
	Case mv_par06 == 2 ; cRegApur := "Regime Não-Cumulativo"
	Case mv_par06 == 3 ; cRegApur := "Regime Cumulativo e Não Cumulativo (Ambos)"
EndCase

dbSelectArea("CFB")
dbSetOrder(1)

If dbSeek(xFilial("CFB")+cDtPer+cTpCon)



	nLin := Cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
	If mv_par06 <> 1
		PrintOut(++nLin,001,OemToAnsi("Regime de Apuração da Contribuição                           Período do Diferimento     Contribuição Diferida     Crédito Diferido"),,)
	Else
		PrintOut(++nLin,001,OemToAnsi("Regime de Apuração da Contribuição                           Período do Diferimento     Contribuição Diferida"),,)
	EndIf
	PrintOut(++nLin,000,Replicate("-",Limite),,)
	PrintOut(++nLin,001,cRegApur,,)
	PrintOut(nLin,063,SubStr(cDtPer,1,2)+"/"+SubStr(cDtPer,3,4),,)
	PrintOut(nLin,078,CFB->CFB_CONREC,"@E 99,999,999,999.99",)
	If mv_par06 <> 1
		PrintOut(nLin,103,CFB->CFB_CREDES,"@E 99,999,999,999.99",)
	EndIf
Endif

RestArea(aArea)

Return Nil
















Static Function Impf12(Titulo,nPagina,NomeProg,Tamanho,cCabec1,cTpCon)

Local aArea		:= GetArea()
Local cCabec2	:= IIf(cTpCon=="PIS","Ficha 12 - Controle do Diferimento - Valores Diferidos no Mês - PIS/Pasep","Ficha 22 - Controle do Diferimento - Valores Diferidos no Mês - Cofins")
Local cDtPer	:= StrZero(Month(mv_par02), 2)+StrZero(Year(mv_par02),4)
Local cRegApur	:= ""

Do Case
	Case mv_par06 == 1 ; cRegApur := "Regime Cumulativo"
	Case mv_par06 == 2 ; cRegApur := "Regime Não-Cumulativo"
	Case mv_par06 == 3 ; cRegApur := "Regime Cumulativo e Não Cumulativo (Ambos)"
EndCase

dbSelectArea("CFA")
dbSetOrder(1)

If dbSeek(xFilial("CFA")+cDtPer+cTpCon)



	nLin := Cabec(Titulo,cCabec1,cCabec2,nomeprog,Tamanho,15)
	If mv_par06 <> 1
		PrintOut(++nLin,001,OemToAnsi("Regime de Apuração da Contribuição                           Período do Diferimento     Contribuição Diferida     Crédito Diferido"),,)
	Else
		PrintOut(++nLin,001,OemToAnsi("Regime de Apuração da Contribuição                           Período do Diferimento     Contribuição Diferida"),,)
	EndIf
	PrintOut(++nLin,000,Replicate("-",Limite),,)
	PrintOut(++nLin,001,cRegApur,,)
	PrintOut(nLin,063,SubStr(cDtPer,1,2)+"/"+SubStr(cDtPer,3,4),,)
	PrintOut(nLin,078,CFA->CFA_CONDIF,"@E 99,999,999,999.99",)
	If mv_par06 <> 1
		PrintOut(nLin,103,CFA->CFA_CREDIF,"@E 99,999,999,999.99",)
	EndIf
Endif

RestArea(aArea)

Return Nil














Static Function GeraTmp()

Local aStru	:= {}
Local cArq	:= ""

AADD(aStru,{"MES"		,"C",002,0})
AADD(aStru,{"CODIGO"	,"C",015,0})
AADD(aStru,{"ITEM"		,"C",002,0})
AADD(aStru,{"PIS"		,"N",005,2})
AADD(aStru,{"COFINS"	,"N",005,2})
AADD(aStru,{"VALOR"		,"N",015,2})

cArq := CriaTrab(aStru)
dbUseArea( .T. ,__LocalDriver,cArq,"TMP")
IndRegua("TMP",cArq,"MES+CODIGO+ITEM")

Return Nil














Static Function GeraT01()

Local aStru	:= {}
Local cArq	:= ""

AADD(aStru,{"MES"		,"C",002,0})
AADD(aStru,{"CODIGO"	,"C",TamSx3("B1_COD")[1],0})
AADD(aStru,{"ITEM"		,"C",002,0})
AADD(aStru,{"PIS"		,"N",007,4})
AADD(aStru,{"COFINS"	,"N",007,4})
AADD(aStru,{"VALOR"		,"N",015,2})
AADD(aStru,{"QUANT"     ,"N",011,2})

cArq := CriaTrab(aStru)
dbUseArea( .T. ,__LocalDriver,cArq,"T01")
IndRegua("T01",cArq,"MES+CODIGO+ITEM")

Return Nil





















Static Function AjustaSX1()

Local aHelpPor :={}
Local aHelpEng :={}
Local aHelpSpa :={}
Local nTamSx1Grp :=Len(SX1->X1_GRUPO)

dbSelectArea("SX1")
dbSetOrder(1)
If dbSeek(PadR("MTR971",nTamSx1Grp)+"08")
	If ALLTRIM(UPPER(SX1->X1_PERGUNT)) <> "APLICATIVO"
		RecLock("SX1", .F. )
		dbDelete()
		MsUnlock()
	Endif
Endif

dbSelectArea("SX1")
dbSetOrder(1)
If dbSeek(PadR("MTR971",nTamSx1Grp)+"13")
	If (SX1->X1_PERGUNT) <> "Imprime Ficha 15/25"
		RecLock("SX1", .F. )
			SX1->X1_PERGUNT := "Imprime Ficha 15/25"
		MsUnlock()
	Endif
Endif

dbSelectArea("SX1")
dbSetOrder(1)
If dbSeek(PadR("MTR971",nTamSx1Grp)+"14")
	If (SX1->X1_PERGUNT) <> "Imprime Fichas 11/12 e 21/22"
		RecLock("SX1", .F. )
			SX1->X1_PERGUNT := "Imprime Fichas 11/12 e 21/22"
		MsUnlock()
	Endif
Endif

If dbSeek(PadR("MTR971",nTamSx1Grp)+"04") .And.  SX1->(AllTrim(X1_F3)<>"XM0" .Or.  AllTrim(X1_GRPSXG)<>"033")
	RecLock("SX1", .F. )
		SX1->X1_F3		:=	"XM0"
		SX1->X1_GRPSXG	:=	"033"
	MsUnlock()
EndIf

If dbSeek(PadR("MTR971",nTamSx1Grp)+"05") .And.  SX1->(AllTrim(X1_F3)<>"XM0" .Or.  AllTrim(X1_GRPSXG)<>"033")
	RecLock("SX1", .F. )
		SX1->X1_F3		:=	"XM0"
		SX1->X1_GRPSXG	:=	"033"
	MsUnlock()
EndIf

aHelpPor :={}
aHelpEng :={}
aHelpSpa :={}

Aadd( aHelpPor, "Informe o tipo de aplicativo a ")
Aadd( aHelpPor, "ser utilizado para apresentação")
Aadd( aHelpPor, "das informações.               ")

aHelpEng := aHelpSpa := aHelpPor





PutSx1(PadR("MTR971",nTamSx1Grp),"08","Aplicativo","Aplicativo","Aplicativo","mv_ch8", "N",1,0,1,"C","","","","","mv_par08","Mensal","Mensal","Mensal","", "Semestral","Semestral","Semestral", "Mens-Semestral","Mens-Semestral","Mens-Semestral","","","","","","", aHelpPor,aHelpEng,aHelpSpa)


aHelpPor := {}
Aadd( aHelpPor, "Selecione se deseja imprimir as fichas  " )
Aadd( aHelpPor, "6B/16B.Importação-Regime Não Cumulativo." )

aHelpEng := aHelpSpa := aHelpPor



PutSx1( PadR("MTR971",nTamSx1Grp),"09","Imprime Ficha 06B/16B","Imprime Ficha 06B/16B","Imprime Ficha 06B/16B","mv_ch9", "N",1,0,1,"C","","","","","mv_par09","Nao","Nao","Nao","","Sim","Sim","Sim","","","","","","","","","", aHelpPor,aHelpEng,aHelpSpa)



If dbSeek(PadR("MTR971",nTamSx1Grp)+"06")
   RecLock("SX1", .F. )
   SX1->X1_DEF03 	:= "Ambos"
   SX1->X1_DEFSPA3 	:= "Ambas"
   SX1->X1_DEFENG3 	:= "Both"
   MsUnLock()
Endif

aHelpPor :={}
aHelpEng :={}
aHelpSpa :={}

Aadd( aHelpPor, "Informe a versão do aplicativo ")
Aadd( aHelpPor, "a ser utilizada para apresenta-")
Aadd( aHelpPor, "ção das informações.           ")

aHelpEng := aHelpSpa := aHelpPor





PutSx1(PadR("MTR971",nTamSx1Grp),"10","Versão","Versão","Versão","mv_cha", "C",3,0,0,"G","","","","","mv_par10","","","","", "","","", "","","","","","","","","", aHelpPor,aHelpEng,aHelpSpa)

aHelpPor :={}
aHelpEng :={}
aHelpSpa :={}

Aadd( aHelpPor, "Informe se deve ou não gerar o ")
Aadd( aHelpPor, "arquivo magnético da Dacon")

aHelpEng := aHelpSpa := aHelpPor




PutSx1(PadR("MTR971",nTamSx1Grp),"11","Gera Arquivo","Gera Arquivo","Gera Arquivo","mv_chb", "N",1,0,0,"C","","","","","mv_par11","Nao","Nao","Nao","","Sim","Sim","Sim", "","","","","","","","","", aHelpPor,aHelpEng,aHelpSpa)

aHelpPor :={}
aHelpEng :={}
aHelpSpa :={}


Aadd( aHelpPor, "Informe se deve ou não imprimir ")
Aadd( aHelpPor, "a Ficha 10A")

aHelpEng := aHelpSpa := aHelpPor



PutSx1(PadR("MTR971",nTamSx1Grp),"12","Imprime Ficha 10A","Imprime Ficha 10A","Imprime Ficha 10A","mv_chc", "N",1,0,1,"C","","","","","mv_par12","Nao","Nao","Nao","","Sim","Sim","Sim","","","","","","","","","", aHelpPor,aHelpEng,aHelpSpa)

aHelpPor :={}
aHelpEng :={}
aHelpSpa :={}


Aadd( aHelpPor, "Informe se deve ou não imprimir ")
Aadd( aHelpPor, "a Ficha 15 e 25")

aHelpEng := aHelpSpa := aHelpPor



PutSx1(PadR("MTR971",nTamSx1Grp),"13","Imprime Ficha 15/25","Imprime Ficha 15/25","Imprime Ficha 15/25","mv_chd", "N",1,0,1,"C","","","","","mv_par13","Nao","No","No","","Sim","Yes","Sí","","","","","","","","","", aHelpPor,aHelpEng,aHelpSpa)

aHelpPor :={}
aHelpEng :={}
aHelpSpa :={}


Aadd( aHelpPor, "Informe se deve ou não imprimir ")
Aadd( aHelpPor, "as Fichas 11/12 e 21/22")

aHelpEng := aHelpSpa := aHelpPor



PutSx1(PadR("MTR971",nTamSx1Grp),"14","Imprime Fichas 11/12 e 21/22","Imprime Fichas 11/12 e 21/22","Imprime Fichas 11/12 e 21/22","mv_che", "N",1,0,1,"C","","","","","mv_par14","Nao","No","No","","Sim","Yes","Sí","","","","","","","","","", aHelpPor,aHelpEng,aHelpSpa)

aHelpPor :={}
aHelpEng :={}
aHelpSpa :={}


Aadd( aHelpPor, "Utiliza a Segunda Unidade na geração")
Aadd( aHelpPor, "das Fichas 10A e 20A.")
Aadd( aHelpPor, "A quantidade e o valor serão calculados")
Aadd( aHelpPor, "pelo Fator de Conversão cadastrado.")

aHelpEng := aHelpSpa := aHelpPor



PutSx1(PadR("MTR971",nTamSx1Grp),"15","Utiliza a Segunda Unidade?","Utiliza a Segunda Unidade?","Utiliza a Segunda Unidade?","mv_chf", "N",1,0,1,"C","","","","","mv_par15","Nao","Nao","Nao","","Sim","Sim","Sim","","","","","","","","","", aHelpPor,aHelpEng,aHelpSpa)

aHelpPor :={}
aHelpEng :={}
aHelpSpa :={}


Return